/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
* @license SoundJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2013 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/

!function(){var t,e,i;!function(n){function s(t,e){return S.call(t,e)}function a(t,e){var i,n,s,a,r,o,l,h,u,c,p,d=e&&e.split("/"),m=_.map,f=m&&m["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),r=t.length-1,_.nodeIdCompat&&b.test(t[r])&&(t[r]=t[r].replace(b,"")),t=d.concat(t),u=0;u<t.length;u+=1)if(p=t[u],"."===p)t.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||f)&&m){for(i=t.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(c=d.length;c>0;c-=1)if(s=m[d.slice(0,c).join("/")],s&&(s=s[n])){a=s,o=u;break}if(a)break;!l&&f&&f[n]&&(l=f[n],h=u)}!a&&l&&(a=l,o=h),a&&(i.splice(0,o,a),t=i.join("/"))}return t}function r(t,e){return function(){return d.apply(n,x.call(arguments,0).concat([t,e]))}}function o(t){return function(e){return a(e,t)}}function l(t){return function(e){g[t]=e}}function h(t){if(s(y,t)){var e=y[t];delete y[t],v[t]=!0,p.apply(n,e)}if(!s(g,t)&&!s(v,t))throw new Error("No "+t);return g[t]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function c(t){return function(){return _&&_.config&&_.config[t]||{}}}var p,d,m,f,g={},y={},_={},v={},S=Object.prototype.hasOwnProperty,x=[].slice,b=/\.js$/;m=function(t,e){var i,n=u(t),s=n[0];return t=n[1],s&&(s=a(s,e),i=h(s)),s?t=i&&i.normalize?i.normalize(t,o(e)):a(t,e):(t=a(t,e),n=u(t),s=n[0],t=n[1],s&&(i=h(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},f={require:function(t){return r(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:c(t)}}},p=function(t,e,i,a){var o,u,c,p,d,_,S=[],x=typeof i;if(a=a||t,"undefined"===x||"function"===x){for(e=!e.length&&i.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(p=m(e[d],a),u=p.f,"require"===u)S[d]=f.require(t);else if("exports"===u)S[d]=f.exports(t),_=!0;else if("module"===u)o=S[d]=f.module(t);else if(s(g,u)||s(y,u)||s(v,u))S[d]=h(u);else{if(!p.p)throw new Error(t+" missing "+u);p.p.load(p.n,r(a,!0),l(u),{}),S[d]=g[u]}c=i?i.apply(g[t],S):void 0,t&&(o&&o.exports!==n&&o.exports!==g[t]?g[t]=o.exports:c===n&&_||(g[t]=c))}else t&&(g[t]=i)},t=e=d=function(t,e,i,s,a){if("string"==typeof t)return f[t]?f[t](e):h(m(t,e).f);if(!t.splice){if(_=t,_.deps&&d(_.deps,_.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=a),s?p(n,t,e,i):setTimeout(function(){p(n,t,e,i)},4),d},d.config=function(t){return d(t)},t._defined=g,i=function(t,e,i){e.splice||(i=e,e=[]),s(g,t)||s(y,t)||(y[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("Fixtures",["require","exports","module"],function(t,e,i){var n;n={results:[{camera:{height:"0",initialX:"0",initialY:"160",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"text-surface",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-05T08:12:25.853Z",device:"",editPopup:[{height:"0",initialX:"0",initialY:"160",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"text-surface",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"}],name:"plain",objectId:"5BDkJ89cKR",page:{name:"text test",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"text-surface",surfaceType:"plain",text:"hey this is a test",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-06-03T10:52:01.868Z"},{camera:{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-05T08:46:03.724Z",device:"",editPopup:[{accel:!1,accelAmount:"1",height:"2",initialX:"284",initialY:"160",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"text-surface",surfaceType:"plain",text:"hey this is a test",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],name:"plain with background",objectId:"c8rIApqevh",page:{name:"text test",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"2",initialX:"284",initialY:"160",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"text-surface",surfaceType:"plain",text:"hey this is a test",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"1",initialX:"284",initialY:"160",name:"overlay",rotateAngle:"100",rotateSpeed:"2000",scale:"0.43",scaleX:"1",scaleY:"1",surfaceClass:"overlay-transparency",surfaceType:"transparency",text:"",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-05-25T05:56:44.320Z"},{camera:{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-05T09:01:05.691Z",device:"",editPopup:[{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"}],name:"hightlighting with background",objectId:"84zIGGgmCH",page:{name:"text test",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"3",initialX:"284",initialY:"160",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"0.53",scaleX:"1",scaleY:"1",singSpeed:"2000",surfaceClass:"",surfaceType:"highlight",text:"hey this is a test,\nhighlighting as it goes",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"1",initialX:"284",initialY:"160",name:"overlay",rotateAngle:"100",rotateSpeed:"2000",scale:"0.43",scaleX:"1",scaleY:"1",surfaceClass:"overlay-transparency",surfaceType:"transparency",text:"",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-05-24T07:12:29.912Z"},{camera:{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"singalong",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-06T05:48:47.302Z",device:"",editPopup:[{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"singalong",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"}],name:"singalong text",objectId:"FybEISg2PH",page:{name:"text test",speed:"12000",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"1",initialX:"284",initialY:"275",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"",surfaceType:"singalong",text:"hey this is a test\nanother line to read\nit keeps going on\nand on and on and on...",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-05-06T06:26:40.352Z"},{camera:{height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"singalong",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-06T06:43:17.906Z",device:"",editPopup:[{accel:!1,accelAmount:"1",height:"1",initialX:"284",initialY:"275",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"",surfaceType:"singalong",text:"hey this is a test,\nsinging along",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],name:"big text on bottom",objectId:"529dy573rm",page:{name:"text test",speed:"12000",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"1",initialX:"284",initialY:"275",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"",surfaceType:"singalong",text:"hey this is a test,\nsinging along",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-05-24T06:47:40.726Z"},{camera:{height:"0",initialX:"0",initialY:"160",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",surfaceClass:"text-surface",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-06-03T10:53:46.609Z",device:"",editPopup:[{accel:!1,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"text-surface",surfaceType:"plain",text:"andadtes",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],name:"dup of plain",objectId:"PmCHzd1i56",page:{name:"text test",x:"568",y:"320"},popups:[{accel:!1,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",surfaceClass:"text-surface",surfaceType:"plain",text:"andadtes",textSurface:!0,timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],updatedAt:"2015-06-03T10:54:26.133Z"},{camera:{accel:!0,accelAmount:"0.74",height:"0",initialX:"-21",initialY:"-250",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"0.6889",timeOffset:"0",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-230",translateYSpeed:"5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-04-18T07:11:06.682Z",device:"1136x640",editPopup:[{accel:!1,accelAmount:"0.15",height:"5500",initialX:"0",initialY:"0",name:"hand5",rotateAngle:"100",rotateSpeed:"2000",scale:"0.89",timeOffset:"550",translate:!0,translateX:"5",translateXSpeed:"0.9",translateY:"4",translateYSpeed:"0.9",url:"/content/images/pages/19/hand5.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],name:"3d accelo test",objectId:"QGvfRAYuqT",page:{name:"hands",perspective:"10000",speed:"1000",x:"900",y:"1200"},popups:[{accel:!1,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"background",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1",url:"/content/images/pages/19/background.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.16",height:"5400",initialX:"0",initialY:"0",motionType:"sine",name:"hand1",rotateAngle:"100",rotateSpeed:"2000",scale:"1.11",scaleX:"1",scaleY:"1",timeOffset:"50",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.6",translateY:"3",translateYSpeed:"0.6",url:"/content/images/pages/19/hand1.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.18",height:"5100",initialX:"0",initialY:"0",name:"hand2",rotateAngle:"100",rotateSpeed:"2000",scale:"0.94",scaleX:"1",scaleY:"1",timeOffset:"200",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.8",translateY:"4",translateYSpeed:"0.8",url:"/content/images/pages/19/hand2.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.22",height:"4500",initialX:"0",initialY:"0",name:"hand3",rotateAngle:"100",rotateSpeed:"2000",scale:"1.38",timeOffset:"300",translate:!0,translateX:"4",translateXSpeed:"0.8",translateY:"3",translateYSpeed:"0.8",url:"/content/images/pages/19/hand3.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.2",height:"4900",initialX:"0",initialY:"0",name:"hand4",rotateAngle:"100",rotateSpeed:"2000",scale:"1.19",timeOffset:"450",translate:!0,translateX:"4",translateXSpeed:"1",translateY:"4",translateYSpeed:"1",url:"/content/images/pages/19/hand4.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.15",height:"5500",initialX:"0",initialY:"0",name:"hand5",rotateAngle:"100",rotateSpeed:"2000",scale:"0.89",timeOffset:"550",translate:!0,translateX:"5",translateXSpeed:"0.9",translateY:"4",translateYSpeed:"0.9",url:"/content/images/pages/19/hand5.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.6",height:"2200",initialX:"0",initialY:"0",name:"girl",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"/content/images/pages/19/girl.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"2",initialX:"0",initialY:"0",name:"front_ball",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"/content/images/pages/19/front_ball.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.25",height:"3500",initialX:"0",initialY:"0",name:"george",rotateAngle:"100",rotateSpeed:"2000",scale:"0.79",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"/content/images/pages/19/george.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"0.8",height:"1200",initialX:"0",initialY:"0",name:"boy",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"/content/images/pages/19/boy.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Music",src:"hands_soundtrack.mp3",url:""}],updatedAt:"2015-04-18T07:22:37.755Z"},{camera:{height:"0",initialX:"0",initialY:"430",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"100",perspectiveZoomCutStart:"1",perspectiveZoomSpeed:"1",perspectiveZoomType:"triangle",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-550",translateYSpeed:"1",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1},configChanged:!0,createdAt:"2015-04-01T08:18:09.601Z",device:"1136x640",editPopup:[{height:"0",initialX:"0",initialY:"430",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"100",perspectiveZoomCutStart:"1",perspectiveZoomSpeed:"1",perspectiveZoomType:"triangle",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-550",translateYSpeed:"1",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1}],name:"delete",objectId:"Du6zsqF3x0",page:{configChanged:!0,name:"delete",perspective:"500",speed:"27000",x:"900",y:"1200"},popups:[{height:"1",initialX:"0",initialY:"-303","motion-type":"triangle",motionType:"sawtooth",name:"background",rotateAngle:"100",rotateSpeed:"0.5",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"105",translateYSpeed:"0.5",url:"./content/images/pages/16/background.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomRelativeTranslate:!1,zoomSpeed:"0.5"},{height:"3302",initialX:"675",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"car",rotate:!0,rotateAngle:"-300",rotateSpeed:"0.02",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_no_tyres.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"100",initialX:"900",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road1",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-900",translateYSpeed:"1",url:"./content/images/pages/16/road1.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"900",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road2",rotateAngle:"100",rotateSpeed:"1",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-845",translateYSpeed:"1",url:"./content/images/pages/16/road2.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"1700",initialX:"966",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road3",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-820",translateYSpeed:"1",url:"./content/images/pages/16/road3.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"3300",initialX:"900",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"roadfront",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_nolines.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"2500",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"school",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-800",translateYSpeed:"1",url:"./content/images/pages/16/school.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.015",frames:[],height:"3303",initialX:"675",initialY:"-520",motionType:"sawtooth",name:"car_tyres",numFrames:"3",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_tyres_sprite.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.03",frames:[{url:"/content/images/pages/16/road_lines_1.png"},{url:"/content/images/pages/16/road_lines_2.png"},{url:"/content/images/pages/16/road_lines_3.png"},{url:"/content/images/pages/16/road_lines_4.png"},{url:"/content/images/pages/16/road_lines_5.png"}],height:"3301",initialX:"900",initialY:"-520",motionType:"sawtooth",name:"road_lines",numFrames:"5",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_lines_sprite.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",height:"3304",initialX:"900",initialY:"-520",motionType:"sawtooth",name:"smoke",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",skew:!0,skewAmount:"0.1",skewAmountX:"0",skewAmountY:"-0.1",skewSpeed:"0.037",skewSpeedX:"0.037",skewSpeedY:"0.074",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-638",translateYSpeed:"1",url:"./content/images/pages/16/smoke.png",xOrigin:"1",xyRatio:"1",yOrigin:"0.8",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"}],sounds:[{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"-1",name:"Car",src:"car_soundtrack.mp3",url:"",volume:"0.4"}],updatedAt:"2015-06-04T10:53:13.402Z"},{camera:{height:"0",initialX:"-21",initialY:"-135",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"0.48",timeOffset:"0",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-115",translateYSpeed:"5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-06T10:59:25.837Z",device:"1136x640",editPopup:[{height:"0",initialX:"-21",initialY:"-135",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"0.48",timeOffset:"0",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-115",translateYSpeed:"5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],name:"2d, splitscreen with multiline overlay",objectId:"UbTeKGsTfz",page:{name:"hands",perspective:"5000",speed:"1000",x:"900",y:"1200"},popups:[{accel:!0,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"background",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/background.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.16",height:"6",initialX:"0",initialY:"0",motionType:"sine",name:"hand1",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"50",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.6",translateY:"3",translateYSpeed:"0.6",url:"./content/images/pages/19/hand1.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.18",height:"7",initialX:"0",initialY:"0",name:"hand2",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"200",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.8",translateY:"4",translateYSpeed:"0.8",url:"./content/images/pages/19/hand2.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.22",height:"8",initialX:"0",initialY:"0",name:"hand3",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"300",translate:!0,translateX:"4",translateXSpeed:"0.8",translateY:"3",translateYSpeed:"0.8",url:"./content/images/pages/19/hand3.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.2",height:"9",initialX:"0",initialY:"0",name:"hand4",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"450",translate:!0,translateX:"4",translateXSpeed:"1",translateY:"4",translateYSpeed:"1",url:"./content/images/pages/19/hand4.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.15",height:"10",initialX:"0",initialY:"0",name:"hand5",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"550",translate:!0,translateX:"5",translateXSpeed:"0.9",translateY:"4",translateYSpeed:"0.9",url:"./content/images/pages/19/hand5.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.6",height:"3",initialX:"0",initialY:"0",name:"girl",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/girl.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"1",height:"4",initialX:"0",initialY:"0",name:"front_ball",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/front_ball.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.25",height:"3",initialX:"0",initialY:"0",name:"george",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/george.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.8",height:"2",initialX:"0",initialY:"0",name:"boy",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/boy.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"11",initialX:"900",initialY:"270",name:"overlay",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"350",sizeY:"700",surfaceClass:"overlay-transparency",surfaceType:"repeatingImage",text:"",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"240",translateYSpeed:"5",url:"./content/images/book_design.png",xOrigin:"0.5",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"12",initialX:"900",initialY:"270",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",singSpeed:"5",sizeX:"350",sizeY:"700",surfaceType:"highlight",text:"hey this is a test,\ntext on the page changing\nhighlighting as it goes",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"239.55",translateYSpeed:"5",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Music",src:"hands_soundtrack.mp3",url:""}],updatedAt:"2015-05-29T14:11:15.021Z"},{camera:{height:"0",initialX:"-21",initialY:"-250",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"0.6889",timeOffset:"0",translate:!0,translateX:"0",translateXSpeed:"1",translateY:"-230",translateYSpeed:"5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},createdAt:"2015-05-06T10:18:16.253Z",device:"1136x640",editPopup:[{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"3",initialX:"15",initialY:"215",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",singSpeed:"5",sizeX:"300",sizeY:"130",surfaceType:"plain",text:'"Look, he still has a blanky! Like a baby!" a little boy laughed and pointed at Little George. Some of the other children began to point and laugh as well.',timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"334",translateYSpeed:"5",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],name:"2d with multiline overlay",objectId:"UHGPYzstxO",page:{name:"hands",perspective:"5000",speed:"1000",x:"900",y:"1200"},popups:[{accel:!0,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"background",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/background.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.16",height:"6",initialX:"0",initialY:"0",motionType:"sine",name:"hand1",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"50",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.6",translateY:"3",translateYSpeed:"0.6",url:"./content/images/pages/19/hand1.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.18",height:"7",initialX:"0",initialY:"0",name:"hand2",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"200",timer:{initialTime:1419434956210},translate:!0,translateX:"3",translateXSpeed:"0.8",translateY:"4",translateYSpeed:"0.8",url:"./content/images/pages/19/hand2.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.22",height:"8",initialX:"0",initialY:"0",name:"hand3",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"300",translate:!0,translateX:"4",translateXSpeed:"0.8",translateY:"3",translateYSpeed:"0.8",url:"./content/images/pages/19/hand3.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.2",height:"9",initialX:"0",initialY:"0",name:"hand4",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"450",translate:!0,translateX:"4",translateXSpeed:"1",translateY:"4",translateYSpeed:"1",url:"./content/images/pages/19/hand4.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.15",height:"10",initialX:"0",initialY:"0",name:"hand5",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"550",translate:!0,translateX:"5",translateXSpeed:"0.9",translateY:"4",translateYSpeed:"0.9",url:"./content/images/pages/19/hand5.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.6",height:"3",initialX:"0",initialY:"0",name:"girl",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/girl.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"1",height:"4",initialX:"0",initialY:"0",name:"front_ball",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/front_ball.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.25",height:"5",initialX:"0",initialY:"0",name:"george",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/george.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!0,accelAmount:"0.8",height:"2",initialX:"0",initialY:"0",name:"boy",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"0",translateX:"0",translateXSpeed:"2",translateY:"0",translateYSpeed:"1",url:"./content/images/pages/19/boy.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"3",initialX:"15",initialY:"215",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",singSpeed:"5",sizeX:"300",sizeY:"130",surfaceType:"plain",text:'"Look, he still has a blanky! Like a baby!" a little boy laughed and pointed at Little George. Some of the other children began to point and laugh as well.',timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"334",translateYSpeed:"5",url:"",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,height:"1",initialX:"10",initialY:"210",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"310",sizeY:"100",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"334",translateYSpeed:"5",url:"./content/images/book_design.png",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.5",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Hands",src:"hands_soundtrack.mp3",url:"",volume:"0.8"},{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"0",name:"narration",src:"narration_hands.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T10:51:31.561Z"},{camera:{configChanged:!1,height:"0",initialX:"0",initialY:"410",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"100",perspectiveZoomCutStart:"1",perspectiveZoomSpeed:"1",perspectiveZoomType:"sawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateCutEnd:"85",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:"1",translateY:"-510",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1},createdAt:"2015-05-29T09:49:37.433Z",device:"1136x640",editPopup:[{configChanged:!1,height:"0",initialX:"0",initialY:"410",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"100",perspectiveZoomCutStart:"1",perspectiveZoomSpeed:"1",perspectiveZoomType:"sawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateCutEnd:"85",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:"1",translateY:"-510",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1}],name:"newfamous 3D layout",objectId:"mt1s3uZ90p",page:{name:"street",perspective:"500",speed:"27000",x:"900",y:"1200"},popups:[{height:"1",initialX:"0",initialY:"-303","motion-type":"triangle",motionType:"sawtooth",name:"background",rotateAngle:"100",rotateSpeed:"0.5",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"105",translateYSpeed:"0.5",url:"./content/images/pages/16/background.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomRelativeTranslate:!1,zoomSpeed:"0.5"},{height:"3302",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"car",rotate:!0,rotateAngle:"-300",rotateSpeed:"0.02",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_no_tyres.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"100",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road1",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-900",translateYSpeed:"1",url:"./content/images/pages/16/road1.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"900",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road2",rotateAngle:"100",rotateSpeed:"1",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-845",translateYSpeed:"1",url:"./content/images/pages/16/road2.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"1700",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road3",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-820",translateYSpeed:"1",url:"./content/images/pages/16/road3.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"3300",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"roadfront",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_nolines.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"2500",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"school",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-800",translateYSpeed:"1",url:"./content/images/pages/16/school.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.015",frames:[],height:"3303",initialX:"0",initialY:"-520",motionType:"sawtooth",name:"car_tyres",numFrames:"3",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_tyres_sprite.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.03",frames:[{url:"/content/images/pages/16/road_lines_1.png"},{url:"/content/images/pages/16/road_lines_2.png"},{url:"/content/images/pages/16/road_lines_3.png"},{url:"/content/images/pages/16/road_lines_4.png"},{url:"/content/images/pages/16/road_lines_5.png"}],height:"3301",initialX:"0",initialY:"-520",motionType:"sawtooth",name:"road_lines",numFrames:"5",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_lines_sprite.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",height:"3304",initialX:"0",initialY:"-520",motionType:"sawtooth",name:"smoke",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",skew:!0,skewAmount:"0.1",skewAmountX:"0",skewAmountY:"-0.1",skewSpeed:"0.037",skewSpeedX:"0.037",skewSpeedY:"0.074",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-638",translateYSpeed:"1",url:"./content/images/pages/16/smoke.png",xOrigin:"1",xyRatio:"1",yOrigin:"0.8",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"1",initialX:"10",initialY:"230",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"310",sizeY:"80",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"3",initialX:"15",initialY:"235",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"300",sizeY:"100",surfaceType:"plain",text:"Because they were in such a hurry, Little George's father did not think to ask if Little George had left Blanky at home.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"-1",name:"Car",src:"car_soundtrack.mp3",url:"",volume:"0.4"},{loop:"0",name:"narration",src:"narration_car.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T11:37:52.710Z"},{camera:{accel:!1,accelRotate:!0,accelRotateAmount:"0.0002",height:"0",initialX:"0",initialY:"0",motionType:"cos",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-30000",perspectiveZoomSpeed:"1",perspectiveZoomType:"cos",rotateAngle:"100",rotateSpeed:"2000",scale:"0.55",text:"",timeOffset:"100",translate:!0,translateX:"0",translateXSpeed:"8000",translateY:"-192",translateYSpeed:"1",url:"/content/images/pages/79/george_girl.png",xyRatio:"1",zoom:!1,zoomAmount:"0.1",zoomCutEnd:"50",zoomCutStart:"0",zoomRelativeTranslate:!1,zoomSpeed:"6.28318530718",zoomTypeCut:!0},createdAt:"2015-05-22T08:15:51.411Z",device:"iphone5",editPopup:[{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"3",initialX:"15",initialY:"215",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"260",sizeY:"130",surfaceType:"plain",text:"The next day George went to school without Blanky.\nHe and Ruth played together the whole day.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],name:"test accel rotation",objectId:"gBqF9PtfBm",page:{name:"desks",perspective:"10000",speed:"15000",x:"1039",y:"945"},popups:[{accel:!1,accelAmount:"1",height:"2500",initialX:"0",initialY:"0",name:"george_girl",rotate:!1,rotateAngle:"20",rotateSpeed:"0.4",rotateType:"triangle",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/george_girl.png",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.3",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"3000",initialX:"0",initialY:"0",name:"front_board",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/front_board.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"2500",initialX:"0",initialY:"0",motionType:"triangle",name:"left_kid",rotate:!1,rotateAngle:"-15",rotateSpeed:"0.8",rotateType:"cos",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"8",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"600",url:"./content/images/pages/79/left_kid.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"2500",initialX:"0",initialY:"0",motionType:"triangle",name:"right_kid",rotate:!1,rotateAngle:"-15",rotateSpeed:"0.8",rotateType:"cos",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"300",timer:{initialTime:1419434956210},translate:!1,translateX:"-8",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"600",url:"./content/images/pages/79/right_kid.png",xOrigin:"1",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"1500",initialX:"0",initialY:"0",name:"middle_desk",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/middle_desk.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"500",initialX:"0",initialY:"0",name:"back_desk",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/back_desk.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"5",initialX:"0",initialY:"0",name:"back_wall",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/back_wall.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"1",initialX:"10",initialY:"210",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"270",sizeY:"100",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"3",initialX:"15",initialY:"215",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"260",sizeY:"130",surfaceType:"plain",text:"The next day George went to school without Blanky.\nHe and Ruth played together the whole day.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"soundtrack",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"0",name:"narration",src:"narration_desk.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T11:05:22.036Z"},{camera:{height:"0",initialX:"-59",initialY:"-30",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"1",scale:"0.359",timeOffset:"100",translate:!0,translateX:"-40",translateXSpeed:"2.5",translateY:"0",translateYSpeed:"0.5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},configChanged:!0,createdAt:"2014-12-24T15:29:15.795Z",device:"1136x640",editPopup:[{height:"0",initialX:"-59",initialY:"-30",lolcamera:!0,name:"camera",rotateAngle:"100",rotateSpeed:"1",scale:"0.359",timeOffset:"100",translate:!0,translateX:"-40",translateXSpeed:"2.5",translateY:"0",translateYSpeed:"0.5",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"}],hiddenOverflow:!1,name:"final with text",objectId:"w9zCNnEbfC",page:{configChanged:!0,name:"ship",speed:"2000",x:"2048",y:"1040"},popups:[{configChanged:!1,height:"1",initialX:"0",initialY:"0",name:"background",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"0.5",url:"./content/images/pages/22and23/background.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"0.4",configChanged:!1,height:"2",initialX:"-200",initialY:"-350",name:"wave1",rotateAngle:"100",rotateSpeed:"1",scale:"1.5",scaleX:"1",scaleY:"1",timeOffset:"2000",timer:{initialTime:1419434956210},translate:!0,translateX:100,translateXSpeed:"1",translateY:"30",translateYSpeed:"0.5",url:"./content/images/pages/22and23/waves.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"0.6",configChanged:!1,height:"3",initialX:"-200",initialY:"-350",name:"wave2",rotateAngle:"100",rotateSpeed:"1",scale:"1.5",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:100,translateXSpeed:"1",translateY:"30",translateYSpeed:"0.5",url:"./content/images/pages/22and23/waves.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"0.9",height:"4",initialX:"0",initialY:"0",name:"ship",rotate:!0,rotateAngle:"60",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translateX:"0",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"0.5",url:"./content/images/pages/22and23/ship.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"1.3",height:"5",initialX:"0",initialY:"0",name:"main_pirate",rotate:!0,rotateAngle:"80",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:-20,translateXSpeed:"1",translateY:0,translateYSpeed:"0.5",url:"./content/images/pages/22and23/main_pirate.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"1.7",height:"6",initialX:"0",initialY:"0",name:"george",rotate:!0,rotateAngle:"80",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"2000",timer:{initialTime:1419434956210},translate:!1,translateX:20,translateXSpeed:"1",translateY:0,translateYSpeed:"0.5",url:"./content/images/pages/22and23/george.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"1"},{accel:!0,accelAmount:"2",height:"7",initialX:"0",initialY:"0",name:"front_rope",rotate:!0,rotateAngle:"60",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"2000",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"0.5",url:"./content/images/pages/22and23/front_rope.png",xyRatio:"1",zoom:!0,zoomAmount:"0",zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,height:"1",initialX:"5",initialY:"210",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"560",sizeY:"105",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,height:"3",initialX:"10",initialY:"215",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"550",sizeY:"130",surfaceType:"plain",text:"... they were sailing the high seas, crossing swords with cut-throat pirates. All of whom had horrible, rotten teeth! Little George could feel the sway of the ocean and the drops of water breaking off angry waves that smashed and crashed against the sides of the ship.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Waves",src:"light_ocean_waves_on_rocks_001.mp3",url:"",volume:"0.1"},{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"0",name:"narration",src:"narration_ship.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T09:17:25.751Z"},{camera:{configChanged:!1,height:"0",initialX:"0",initialY:"430",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"90",perspectiveZoomCutStart:"0",perspectiveZoomSpeed:"1",perspectiveZoomType:"sawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateCutEnd:"90",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:"1",translateY:"-498",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1},createdAt:"2015-06-02T09:16:51.261Z",device:"1136x640",editPopup:[{configChanged:!1,height:"0",initialX:"0",initialY:"430",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-20000",perspectiveZoomCut:!1,perspectiveZoomCutEnd:"90",perspectiveZoomCutStart:"0",perspectiveZoomSpeed:"1",perspectiveZoomType:"sawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"100",translate:!0,translateCutEnd:"90",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:"1",translateY:"-498",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1}],name:"static car newfamous 3D layout",objectId:"rZ4dWe9BGU",page:{name:"street",perspective:"500",speed:"27000",x:"900",y:"1200"},popups:[{height:"1",initialX:"0",initialY:"-303","motion-type":"triangle",motionType:"sawtooth",name:"background",rotateAngle:"100",rotateSpeed:"0.5",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"105",translateYSpeed:"0.5",url:"./content/images/pages/16/background.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomRelativeTranslate:!1,zoomSpeed:"0.5"},{cameraBound:!0,configChanged:!1,height:"3",initialX:"-210",initialY:"-240","motion-type":"triangle",motionType:"sawtooth",name:"car",rotate:!0,rotateAngle:"-300",rotateSpeed:"0.02",scale:"0.47",scaleX:"1",scaleY:"1",sizeX:"",sizeY:"",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_no_tyres.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"100",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road1",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-900",translateYSpeed:"1",url:"./content/images/pages/16/road1.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"900",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road2",rotateAngle:"100",rotateSpeed:"1",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-845",translateYSpeed:"1",url:"./content/images/pages/16/road2.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"1700",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"road3",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-820",translateYSpeed:"1",url:"./content/images/pages/16/road3.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{cameraBound:!0,configChanged:!1,height:"1",initialX:"-330",initialY:"-240","motion-type":"triangle",motionType:"sawtooth",name:"roadfront",rotateAngle:"100",rotateSpeed:"27000",scale:"0.47",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_nolines.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{height:"2500",initialX:"0",initialY:"-520","motion-type":"triangle",motionType:"sawtooth",name:"school",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-800",translateYSpeed:"1",url:"./content/images/pages/16/school.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.015",cameraBound:!0,configChanged:!1,frames:[],height:"4",initialX:"-210",initialY:"-240",motionType:"sawtooth",name:"car_tyres",numFrames:"3",rotate:!1,rotateAngle:"-300",rotateSpeed:"0.02",scale:"0.47",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_tyres_sprite.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.03",cameraBound:!0,configChanged:!1,frames:[{url:"/content/images/pages/16/road_lines_1.png"},{url:"/content/images/pages/16/road_lines_2.png"},{url:"/content/images/pages/16/road_lines_3.png"},{url:"/content/images/pages/16/road_lines_4.png"},{url:"/content/images/pages/16/road_lines_5.png"}],height:"2",initialX:"-330",initialY:"-240",motionType:"sawtooth",name:"road_lines",numFrames:"5",rotateAngle:"100",rotateSpeed:"1",scale:"0.47",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_lines_sprite.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"5",initialX:"-325",initialY:"-750",motionType:"sawtooth",name:"smoke",rotateAngle:"100",rotateSpeed:"2000",scale:"0.47",scaleX:"1",scaleY:"1",skew:!0,skewAmount:"0.1",skewAmountX:"0",skewAmountY:"-0.1",skewSpeed:"0.037",skewSpeedX:"0.037",skewSpeedY:"0.074",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-638",translateYSpeed:"1",url:"./content/images/pages/16/smoke.png",xOrigin:"1",xyRatio:"1",yOrigin:"0.8",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"7",initialX:"10",initialY:"230",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"310",sizeY:"80",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"9",initialX:"15",initialY:"235",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"300",sizeY:"100",surfaceType:"plain",text:"Because they were in such a hurry, Little George's father did not think to ask if Little George had left Blanky at home.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"-1",name:"Car",src:"car_soundtrack.mp3",url:"",volume:"0.4"},{loop:"0",name:"narration",src:"narration_car.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T11:38:12.473Z"},{camera:{configChanged:!1,height:"0",initialX:"0",initialY:"233",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"200050",perspectiveZoomCut:!0,perspectiveZoomCutEnd:"80",perspectiveZoomCutStart:"0",perspectiveZoomSpeed:"1",perspectiveZoomType:"relativeSawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"0",translate:!1,translateCutEnd:"90",translateCutStart:"0",translateTypeCut:!1,translateX:"0",translateXSpeed:"1",translateY:"-498",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1},configChanged:!0,createdAt:"2015-06-04T06:09:08.382Z",device:"1136x640",editPopup:[{configChanged:!1,height:"0",initialX:"0",initialY:"233",lolcamera:!0,motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"200050",perspectiveZoomCut:!0,perspectiveZoomCutEnd:"80",perspectiveZoomCutStart:"0",perspectiveZoomSpeed:"1",perspectiveZoomType:"relativeSawtooth",perspectivezoom:!0,rotateAngle:"100",rotateSpeed:"1",scale:"0.6320250000000001",timeOffset:"0",translate:!1,translateCutEnd:"90",translateCutStart:"0",translateTypeCut:!1,translateX:"0",translateXSpeed:"1",translateY:"-498",translateYSpeed:"1",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"-0.2",zoomCutEnd:"100",zoomCutStart:"70",zoomSpeed:"1",zoomTypeCut:!1}],name:"reverse test",objectId:"FL2phpD5tr",page:{configChanged:!0,name:"street",perspective:"200000",speed:"27000",x:"900",y:"1200"},popups:[{height:"1",initialX:"0",initialY:"-303","motion-type":"triangle",motionType:"sawtooth",name:"background",rotateAngle:"100",rotateSpeed:"0.5",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateX:"0",translateXSpeed:"1000",translateY:"105",translateYSpeed:"0.5",url:"./content/images/pages/16/background.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoomAmount:"0",zoomRelativeTranslate:!1,zoomSpeed:"0.5"},{cameraBound:!0,configChanged:!1,height:"3",initialX:"-210",initialY:"-240","motion-type":"triangle",motionType:"sawtooth",name:"car",rotate:!0,rotateAngle:"-300",rotateSpeed:"0.02",scale:"0.47",scaleX:"1",scaleY:"1",sizeX:"",sizeY:"",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:2e3,translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_no_tyres.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{configChanged:!1,height:"60000",initialX:"-233",initialY:"-300","motion-type":"triangle",motionType:"cos",name:"road1",rotateAngle:"100",rotateSpeed:"1",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!0,translateCutEnd:"40",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:2e3,translateY:"-250",translateYSpeed:"1",url:"./content/images/pages/16/road1.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{configChanged:!1,height:"15000",initialX:"0",initialY:"-200","motion-type":"triangle",motionType:"cos",name:"road2",rotateAngle:"100",rotateSpeed:"1",scale:"1",timeOffset:"0",translate:!0,translateCutEnd:"90",translateCutStart:"20",translateTypeCut:!0,translateX:"0",translateXSpeed:"2000",translateY:"-400",translateYSpeed:"1",url:"./content/images/pages/16/road2.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{configChanged:!1,height:"1000",initialX:"0",initialY:"-284","motion-type":"triangle",motionType:"cos",name:"road3",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!0,translateCutEnd:"100",translateCutStart:"55",translateTypeCut:!0,translateX:"0",translateXSpeed:"2000",translateY:"-520",translateYSpeed:"1",url:"./content/images/pages/16/road3.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{cameraBound:!0,configChanged:!1,height:"1",initialX:"-330",initialY:"-240","motion-type":"triangle",motionType:"sawtooth",name:"roadfront",rotateAngle:"100",rotateSpeed:"27000",scale:"0.47",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_nolines.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{configChanged:!1,height:"3",initialX:"0",initialY:"-100","motion-type":"triangle",motionType:"sawtooth",name:"school",rotateAngle:"100",rotateSpeed:"27000",scale:"1",timeOffset:"0",translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-800",translateYSpeed:"1",url:"./content/images/pages/16/school.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.015",cameraBound:!0,configChanged:!1,frames:[],height:"4",initialX:"-210",initialY:"-240",motionType:"sawtooth",name:"car_tyres",numFrames:"3",rotate:!1,rotateAngle:"-300",rotateSpeed:"0.02",scale:"0.47",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/car_tyres_sprite.png",xOrigin:"0.75",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",animation:!0,animationSpeed:"0.03",cameraBound:!0,configChanged:!1,frames:[{url:"/content/images/pages/16/road_lines_1.png"},{url:"/content/images/pages/16/road_lines_2.png"},{url:"/content/images/pages/16/road_lines_3.png"},{url:"/content/images/pages/16/road_lines_4.png"},{url:"/content/images/pages/16/road_lines_5.png"}],height:"2",initialX:"-330",initialY:"-240",motionType:"sawtooth",name:"road_lines",numFrames:"5",rotateAngle:"100",rotateSpeed:"1",scale:"0.47",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-740",translateYSpeed:"1",url:"./content/images/pages/16/road_lines_sprite.png",xOrigin:"1",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"5",initialX:"-325",initialY:"-750",motionType:"sawtooth",name:"smoke",rotateAngle:"100",rotateSpeed:"2000",scale:"0.47",scaleX:"1",scaleY:"1",skew:!0,skewAmount:"0.1",skewAmountX:"0",skewAmountY:"-0.1",skewSpeed:"0.037",skewSpeedX:"0.037",skewSpeedY:"0.074",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"2000",translateY:"-638",translateYSpeed:"1",url:"./content/images/pages/16/smoke.png",xOrigin:"1",xyRatio:"1",yOrigin:"0.8",zoom:!1,zoomAmount:"0",zoomRelativeMultiplier:"-77",zoomRelativeTranslate:!0,zoomSpeed:"1"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"7",initialX:"10",initialY:"230",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"310",sizeY:"80",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,configChanged:!1,height:"9",initialX:"15",initialY:"235",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"300",sizeY:"100",surfaceType:"plain",text:"Because they were in such a hurry, Little Georges father did not think to ask if Little George had left Blanky at home.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"Music",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"-1",name:"Car",src:"car_soundtrack.mp3",url:"",volume:"0.4"},{loop:"0",name:"narration",src:"narration_car.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T07:16:56.533Z"},{camera:{accel:!1,accelRotate:!0,accelRotateAmount:"0.0002",configChanged:!1,height:"0",initialRotateX:"0",initialRotateZ:"0",initialX:"40",initialY:"0",motionType:"sawtooth",name:"camera",perspectiveZoom:!0,perspectiveZoomAmount:"-1000",perspectiveZoomCut:!0,perspectiveZoomCutEnd:"70",perspectiveZoomCutStart:"0",perspectiveZoomSpeed:"1",perspectiveZoomType:"sawtooth",rotateAngle:"100",rotateSpeed:"2000",scale:"0.55",text:"",timeOffset:"100",translate:!1,translateCutEnd:"70",translateCutStart:"0",translateTypeCut:!0,translateX:"0",translateXSpeed:"8000",translateY:"-318",translateYSpeed:"1",url:"/content/images/pages/79/george_girl.png",xOrigin:"0",xyRatio:"1",yOrigin:"0",zoom:!1,zoomAmount:"0.1",zoomCutEnd:"50",zoomCutStart:"0",zoomRelativeTranslate:!1,zoomSpeed:"6.28318530718",zoomTypeCut:!0},configChanged:!0,createdAt:"2015-06-04T07:19:37.829Z",device:"iphone5",editPopup:[{accel:!1,accelAmount:"1",configChanged:!1,height:"150",initialX:"0",initialY:"0",name:"george_girl",rotate:!0,rotateAngle:"20",rotateSpeed:"0.2",rotateType:"triangle",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/george_girl.png",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.3",zoomAmount:"0",zoomSpeed:"2000"}],name:"pull back",objectId:"T4O5ZdccvI",page:{configChanged:!0,name:"desks",perspective:"100",speed:"15000",x:"1039",y:"945"},popups:[{accel:!1,accelAmount:"1",configChanged:!1,height:"150",initialX:"0",initialY:"0",name:"george_girl",rotate:!0,rotateAngle:"20",rotateSpeed:"0.2",rotateType:"triangle",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/george_girl.png",xOrigin:"0.5",xyRatio:"1",yOrigin:"0.3",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",configChanged:!1,height:"200",initialX:"0",initialY:"0",name:"front_board",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/front_board.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",configChanged:!1,height:"150",initialX:"0",initialY:"0",motionType:"triangle",name:"left_kid",rotate:!0,rotateAngle:"-15",rotateSpeed:"0.3",rotateType:"cos",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"8",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"600",url:"./content/images/pages/79/left_kid.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",configChanged:!1,height:"150",initialX:"0",initialY:"0",motionType:"triangle",name:"right_kid",rotate:!0,rotateAngle:"-15",rotateSpeed:"0.3",rotateType:"cos",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"300",timer:{initialTime:1419434956210},translate:!1,translateX:"-8",translateXSpeed:"0.5",translateY:"0",translateYSpeed:"600",url:"./content/images/pages/79/right_kid.png",xOrigin:"1",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",configChanged:!1,height:"100",initialX:"0",initialY:"0",motionType:"sawtooth",name:"middle_desk",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateCutEnd:"70",translateCutStart:"0",translateTypeCut:!1,translateX:"-0",translateXSpeed:"1",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/middle_desk.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",configChanged:!1,height:"50",initialX:"0",initialY:"0",name:"back_desk",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/back_desk.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",height:"5",initialX:"0",initialY:"0",name:"back_wall",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/pages/79/back_wall.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,height:"1",initialX:"10",initialY:"205",name:"overlay",opacity:"0.85",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"270",sizeY:"105",surfaceType:"repeatingImage",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"./content/images/book_design.png",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},{accel:!1,accelAmount:"1",cameraBound:!0,height:"3",initialX:"15",initialY:"210",name:"text",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",sizeX:"260",sizeY:"130",surfaceType:"plain",text:"The next day George went to school without Blanky.\nHe and Ruth played together the whole day.",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"}],sounds:[{loop:"-1",name:"soundtrack",src:"bgMusic.mp3",url:"",volume:"1"},{loop:"0",name:"narration",src:"narration_desk.mp3",url:"",volume:"1"}],updatedAt:"2015-06-04T08:27:27.857Z"}]},i.exports=n
}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof i&&i.amd)i("famous",[],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.famous=t()}}(function(){return function t(i,n,s){function a(o,l){if(!n[o]){if(!i[o]){var h="function"==typeof e&&e;if(!l&&h)return h(o,!0);if(r)return r(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};i[o][0].call(c.exports,function(t){var e=i[o][1][t];return a(e?e:t)},c,c.exports,t,i,n,s)}return n[o].exports}for(var r="function"==typeof e&&e,o=0;o<s.length;o++)a(s[o]);return a}({1:[function(t,e){function i(t){n.call(this,t);var e=t.getAlign();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var n=t("./Position");i.prototype.toString=function(){return"Align"},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){this._node.setAlign(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"./Position":7}],2:[function(t,e){function i(t){this._node=t,this._projectionType=i.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this._requestingUpdate=!1,this._id=t.addComponent(this),this._viewTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._viewDirty=!1,this._perspectiveDirty=!1,this.setFlat()}i.FRUSTUM_PROJECTION=0,i.PINHOLE_PROJECTION=1,i.ORTHOGRAPHIC_PROJECTION=2,i.prototype.toString=function(){return"Camera"},i.prototype.getValue=function(){return{component:this.toString(),projectionType:this._projectionType,focalDepth:this._focalDepth,near:this._near,far:this._far}},i.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.projectionType,t.focalDepth,t.near,t.far),!0):!1},i.prototype.set=function(t,e,i,n){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._projectionType=t,this._focalDepth=e,this._near=i,this._far=n},i.prototype.setDepth=function(t){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.PINHOLE_PROJECTION,this._focalDepth=t,this._near=0,this._far=0,this},i.prototype.setFrustum=function(t,e){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.FRUSTUM_PROJECTION,this._focalDepth=0,this._near=t,this._far=e,this},i.prototype.setFlat=function(){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._perspectiveDirty=!0,this._projectionType=i.ORTHOGRAPHIC_PROJECTION,this._focalDepth=0,this._near=0,this._far=0,this},i.prototype.onUpdate=function(){this._requestingUpdate=!1;var t=this._node.getLocation();if(this._node.sendDrawCommand("WITH").sendDrawCommand(t),this._perspectiveDirty)switch(this._perspectiveDirty=!1,this._projectionType){case i.FRUSTUM_PROJECTION:this._node.sendDrawCommand("FRUSTUM_PROJECTION"),this._node.sendDrawCommand(this._near),this._node.sendDrawCommand(this._far);break;case i.PINHOLE_PROJECTION:this._node.sendDrawCommand("PINHOLE_PROJECTION"),this._node.sendDrawCommand(this._focalDepth);break;case i.ORTHOGRAPHIC_PROJECTION:this._node.sendDrawCommand("ORTHOGRAPHIC_PROJECTION")}this._viewDirty&&(this._viewDirty=!1,this._node.sendDrawCommand("CHANGE_VIEW_TRANSFORM"),this._node.sendDrawCommand(this._viewTransform[0]),this._node.sendDrawCommand(this._viewTransform[1]),this._node.sendDrawCommand(this._viewTransform[2]),this._node.sendDrawCommand(this._viewTransform[3]),this._node.sendDrawCommand(this._viewTransform[4]),this._node.sendDrawCommand(this._viewTransform[5]),this._node.sendDrawCommand(this._viewTransform[6]),this._node.sendDrawCommand(this._viewTransform[7]),this._node.sendDrawCommand(this._viewTransform[8]),this._node.sendDrawCommand(this._viewTransform[9]),this._node.sendDrawCommand(this._viewTransform[10]),this._node.sendDrawCommand(this._viewTransform[11]),this._node.sendDrawCommand(this._viewTransform[12]),this._node.sendDrawCommand(this._viewTransform[13]),this._node.sendDrawCommand(this._viewTransform[14]),this._node.sendDrawCommand(this._viewTransform[15]))},i.prototype.onTransformChange=function(t){var e=t;this._viewDirty=!0,this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var i=e[0],n=e[1],s=e[2],a=e[3],r=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],p=e[10],d=e[11],m=e[12],f=e[13],g=e[14],y=e[15],_=i*o-n*r,v=i*l-s*r,S=i*h-a*r,x=n*l-s*o,b=n*h-a*o,T=s*h-a*l,A=u*f-c*m,w=u*g-p*m,C=u*y-d*m,z=c*g-p*f,E=c*y-d*f,R=p*y-d*g,O=1/(_*R-v*E+S*z+x*C-b*w+T*A);this._viewTransform[0]=(o*R-l*E+h*z)*O,this._viewTransform[1]=(s*E-n*R-a*z)*O,this._viewTransform[2]=(f*T-g*b+y*x)*O,this._viewTransform[3]=(p*b-c*T-d*x)*O,this._viewTransform[4]=(l*C-r*R-h*w)*O,this._viewTransform[5]=(i*R-s*C+a*w)*O,this._viewTransform[6]=(g*S-m*T-y*v)*O,this._viewTransform[7]=(u*T-p*S+d*v)*O,this._viewTransform[8]=(r*E-o*C+h*A)*O,this._viewTransform[9]=(n*C-i*E-a*A)*O,this._viewTransform[10]=(m*b-f*S+y*_)*O,this._viewTransform[11]=(c*S-u*b-d*_)*O,this._viewTransform[12]=(o*w-r*z-l*A)*O,this._viewTransform[13]=(i*z-n*w+s*A)*O,this._viewTransform[14]=(f*v-m*x-g*_)*O,this._viewTransform[15]=(u*x-c*v+p*_)*O},e.exports=i},{}],3:[function(t,e){function i(t,e){this.node=t,this.id=t.addComponent(this),this._events=new o,this.last1=new l,this.last2=new l,this.delta1=new l,this.delta2=new l,this.velocity1=new l,this.velocity2=new l,this.dist=0,this.diff12=new l,this.center=new l,this.centerDelta=new l,this.centerVelocity=new l,this.pointer1={position:this.last1,delta:this.delta1,velocity:this.velocity1},this.pointer2={position:this.last2,delta:this.delta2,velocity:this.velocity2},this.event={status:null,time:0,pointers:[],center:this.center,centerDelta:this.centerDelta,centerVelocity:this.centerVelocity,points:0,current:0},this.trackedPointerIDs=[-1,-1],this.timeOfPointer=0,this.multiTap=0,this.mice=[],this.gestures=[],this.options={},this.trackedGestures={};var i,n;if(e)for(i=0,n=e.length;n>i;i++)this.on(e[i],e[i].callback);t.addUIEvent("touchstart"),t.addUIEvent("mousedown"),t.addUIEvent("touchmove"),t.addUIEvent("mousemove"),t.addUIEvent("touchend"),t.addUIEvent("mouseup"),t.addUIEvent("mouseleave")}function n(t){var e;if(t.targetTouches?e=t.targetTouches:(this.mice[0]=t,e=this.mice,t.identifier=1),!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){this.event.time=Date.now();var i,n;this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedGestures.tap&&(i=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<i?this.event.taps++:this.event.taps=1,this.timeOfPointer=this.event.time,this.multiTap=1),this.event.current=1,this.event.points=1,n=e[0].identifier,this.trackedPointerIDs[0]=n,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear(),this.event.pointers.push(this.pointer1)),e[1]&&this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedGestures.tap&&(i=this.options.tap&&this.options.tap.threshold||250,this.event.time-this.timeOfPointer<i&&(this.multiTap=2)),this.event.current=2,this.event.points=2,n=e[1].identifier,this.trackedPointerIDs[1]=n,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),l.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),l.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length(),this.trackedGestures.pinch&&(this.event.scale=this.event.scale||1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=this.event.rotation||0,this.event.rotationDelta=0,this.event.rotationVelocity=0),this.event.pointers.push(this.pointer2)),this.event.status="start",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.clear(),this.centerVelocity.clear(),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function s(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice[0]=t,e=this.mice,t.identifier=1}var i=Date.now(),n=i-this.event.time;if(0!==n){var s=1e3/n;if(this.event.time=i,this.event.current=1,this.event.points=1,this.trackedPointerIDs[0]===e[0].identifier&&(h.set(e[0].pageX,e[0].pageY),l.subtract(h,this.last1,this.delta1),l.scale(this.delta1,s,this.velocity1),this.last1.copy(h)),e[1]){if(this.event.current=2,this.event.points=2,h.set(e[1].pageX,e[1].pageY),l.subtract(h,this.last2,this.delta2),l.scale(this.delta2,s,this.velocity2),this.last2.copy(h),l.add(this.last1,this.last2,h).scale(.5),l.subtract(h,this.center,this.centerDelta),l.add(this.velocity1,this.velocity2,this.centerVelocity).scale(.5),this.center.copy(h),l.subtract(this.last2,this.last1,h),this.trackedGestures.rotate){var a=h.dot(this.diff12),r=h.cross(this.diff12),o=-Math.atan2(r,a);this.event.rotation+=o,this.event.rotationDelta=o,this.event.rotationVelocity=o*s}var u=h.length(),c=u/this.dist;this.diff12.copy(h),this.dist=u,this.trackedGestures.pinch&&(this.event.scale*=c,c-=1,this.event.scaleDelta=c,this.event.scaleVelocity=c*s)}this.event.status="move",1===this.event.points&&(this.center.copy(this.last1),this.centerDelta.copy(this.delta1),this.centerVelocity.copy(this.velocity1),this.trackedGestures.pinch&&(this.event.scale=1,this.event.scaleDelta=0,this.event.scaleVelocity=0),this.trackedGestures.rotate&&(this.event.rotation=0,this.event.rotationDelta=0,this.event.rotationVelocity=0)),this.triggerGestures()}}function a(t){var e;if(t.targetTouches)e=t.targetTouches;else{if(!this.event.current)return;this.mice.pop(),e=this.mice}if(!e[0]||!e[1]||this.trackedPointerIDs[0]!==e[0].identifier||this.trackedPointerIDs[1]!==e[1].identifier){var i;if(this.event.status="end",!e[0])return this.event.current=0,this.trackedPointerIDs[0]=-1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.pointers.pop(),void this.event.pointers.pop();this.trackedPointerIDs[0]!==e[0].identifier&&(this.trackedPointerIDs[0]=-1,i=e[0].identifier,this.trackedPointerIDs[0]=i,this.last1.set(e[0].pageX,e[0].pageY),this.velocity1.clear(),this.delta1.clear()),e[1]?this.trackedPointerIDs[1]!==e[1].identifier&&(this.trackedPointerIDs[1]=-1,this.event.points=2,i=e[1].identifier,this.trackedPointerIDs[1]=i,this.last2.set(e[1].pageX,e[1].pageY),this.velocity2.clear(),this.delta2.clear(),l.add(this.last1,this.last2,this.center).scale(.5),this.centerDelta.clear(),this.centerVelocity.clear(),l.subtract(this.last2,this.last1,this.diff12),this.dist=this.diff12.length()):(this.event.current=1,this.trackedPointerIDs[1]=-1,this.triggerGestures(),this.event.points=1,this.event.pointers.pop())}}function r(){this.event.current&&(this.event.status="end",this.event.current=0,this.trackedPointerIDs[0]=-1,this.triggerGestures(),this.event.pointers.pop())}var o=t("../utilities/CallbackStore"),l=t("../math/Vec2"),h=new l,u={drag:!0,tap:!0,rotate:!0,pinch:!0};i.prototype.onReceive=function(t,e){switch(t){case"touchstart":case"mousedown":n.call(this,e);break;case"touchmove":case"mousemove":s.call(this,e);break;case"touchend":case"mouseup":a.call(this,e);break;case"mouseleave":r.call(this,e)}},i.prototype.toString=function(){return"GestureHandler"},i.prototype.on=function(t,e){var i=t.event||t;u[i]&&(this.trackedGestures[i]=!0,this.gestures.push(i),t.event&&(this.options[i]=t),this._events.on(i,e))},i.prototype.triggerGestures=function(){for(var t=this.event,e=0,i=this.gestures.length;i>e;e++){var n=this.gestures[e];switch(n){case"rotate":case"pinch":2===t.points&&this.trigger(n,t);break;case"tap":if("start"===t.status)if(this.options.tap){var s=this.options.tap.points||1;this.multiTap>=s&&t.points>=s&&this.trigger(n,t)}else this.trigger(n,t);break;default:this.trigger(n,t)}}},i.prototype.trigger=function(t,e){this._events.trigger(t,e)},e.exports=i},{"../math/Vec2":43,"../utilities/CallbackStore":90}],4:[function(t,e){function i(t){n.call(this,t);var e=t.getMountPoint();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var n=t("./Position");i.prototype.toString=function(){return"MountPoint"},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){this._node.setMountPoint(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"./Position":7}],5:[function(t,e){function i(t){this._node=t,this._id=t.addComponent(this),this._value=new n(1),this._requestingUpdate=!1}var n=t("../transitions/Transitionable");i.prototype.toString=function(){return"Opacity"},i.prototype.getValue=function(){return{component:this.toString(),value:this._value.get()}},i.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.value),!0):!1},i.prototype.set=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._value.set(t,e,i),this},i.prototype.get=function(){return this._value.get()},i.prototype.halt=function(){return this._value.halt(),this},i.prototype.isActive=function(){return this._value.isActive()},i.prototype.update=function(){this._node.setOpacity(this._value.get()),this._value.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"../transitions/Transitionable":88}],6:[function(t,e){function i(t){n.call(this,t);var e=t.getOrigin();this._x.set(e[0]),this._y.set(e[1]),this._z.set(e[2])}var n=t("./Position");i.prototype.toString=function(){return"Origin"},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){this._node.setOrigin(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"./Position":7}],7:[function(t,e){function i(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1;var e=t.getPosition();this._x=new n(e[0]),this._y=new n(e[1]),this._z=new n(e[2])}var n=t("../transitions/Transitionable");i.prototype.toString=function(){return"Position"},i.prototype.getValue=function(){return{component:this.toString(),x:this._x.get(),y:this._y.get(),z:this._z.get()}},i.prototype.setValue=function(t){return this.toString()===t.component?(this.set(t.x,t.y,t.z),!0):!1},i.prototype.getX=function(){return this._x.get()},i.prototype.getY=function(){return this._y.get()},i.prototype.getZ=function(){return this._z.get()},i.prototype.isActive=function(){return this._x.isActive()||this._y.isActive()||this._z.isActive()},i.prototype._checkUpdate=function(){this.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},i.prototype.update=function(){this._node.setPosition(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,i.prototype.setX=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._x.set(t,e,i),this},i.prototype.setY=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._y.set(t,e,i),this},i.prototype.setZ=function(t,e,i){return this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._z.set(t,e,i),this},i.prototype.set=function(t,e,i,n,s){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var a,r,o;return null!=i?o=s:null!=e?r=s:null!=t&&(a=s),null!=t&&this._x.set(t,n,a),null!=e&&this._y.set(e,n,r),null!=i&&this._z.set(i,n,o),this},i.prototype.halt=function(){return this._x.halt(),this._y.halt(),this._z.halt(),this},e.exports=i},{"../transitions/Transitionable":88}],8:[function(t,e){function i(t){n.call(this,t);var e=t.getRotation(),i=e[0],s=e[1],a=e[2],r=e[3],o=i*i,l=s*s,h=a*a,u=2*(i*a+s*r);u=-1>u?-1:u>1?1:u;var c=Math.atan2(2*(i*r-s*a),1-2*(o+l)),p=Math.asin(u),d=Math.atan2(2*(a*r-i*s),1-2*(l+h));this._x.set(c),this._y.set(p),this._z.set(d)}var n=t("./Position");i.prototype.toString=function(){return"Rotation"},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){this._node.setRotation(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"./Position":7}],9:[function(t,e){function i(t){n.call(this,t),this._x.set(1),this._y.set(1),this._z.set(1)}var n=t("./Position");i.prototype.toString=function(){return"Scale"},i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.update=function(){this._node.setScale(this._x.get(),this._y.get(),this._z.get()),this._checkUpdate()},i.prototype.onUpdate=i.prototype.update,e.exports=i},{"./Position":7}],10:[function(t,e){function i(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1;var e=t.getProportionalSize(),i=t.getDifferentialSize(),s=t.getAbsoluteSize();this._proportional={x:new n(e[0]),y:new n(e[1]),z:new n(e[2])},this._differential={x:new n(i[0]),y:new n(i[1]),z:new n(i[2])},this._absolute={x:new n(s[0]),y:new n(s[1]),z:new n(s[2])}}var n=t("../transitions/Transitionable");i.RELATIVE=0,i.ABSOLUTE=1,i.RENDER=2,i.DEFAULT=i.RELATIVE,i.prototype.setMode=function(t,e,i){return this._node.setSizeMode(t,e,i),this},i.prototype.toString=function(){return"Size"},i.prototype.getValue=function(){return{sizeMode:this._node.value.sizeMode,absolute:{x:this._absolute.x.get(),y:this._absolute.y.get(),z:this._absolute.z.get()},differential:{x:this._differential.x.get(),y:this._differential.y.get(),z:this._differential.z.get()},proportional:{x:this._proportional.x.get(),y:this._proportional.y.get(),z:this._proportional.z.get()}}},i.prototype.setValue=function(t){return this.toString()===t.component&&(this.setMode.apply(this,t.sizeMode),t.absolute&&this.setAbsolute(t.absolute.x,t.absolute.y,t.absolute.z),t.differential&&this.setAbsolute(t.differential.x,t.differential.y,t.differential.z),t.proportional&&this.setAbsolute(t.proportional.x,t.proportional.y,t.proportional.z)),!1},i.prototype._isActive=function(t){return t.x.isActive()||t.y.isActive()||t.z.isActive()},i.prototype.isActive=function(){return this._isActive(this._absolute)||this._isActive(this._proportional)||this._isActive(this._differential)},i.prototype.onUpdate=function(){var t=this._absolute;this._node.setAbsoluteSize(t.x.get(),t.y.get(),t.z.get());var e=this._proportional,i=this._differential;this._node.setProportionalSize(e.x.get(),e.y.get(),e.z.get()),this._node.setDifferentialSize(i.x.get(),i.y.get(),i.z.get()),this.isActive()?this._node.requestUpdateOnNextTick(this._id):this._requestingUpdate=!1},i.prototype.setAbsolute=function(t,e,i,n,s){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var a,r,o;null!=i?o=s:null!=e?r=s:null!=t&&(a=s);var l=this._absolute;null!=t&&l.x.set(t,n,a),null!=e&&l.y.set(e,n,r),null!=i&&l.z.set(i,n,o)},i.prototype.setProportional=function(t,e,i,n,s){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var a,r,o;null!=i?o=s:null!=e?r=s:null!=t&&(a=s);var l=this._proportional;return null!=t&&l.x.set(t,n,a),null!=e&&l.y.set(e,n,r),null!=i&&l.z.set(i,n,o),this},i.prototype.setDifferential=function(t,e,i,n,s){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0);var a,r,o;null!=i?o=s:null!=e?r=s:null!=t&&(a=s);var l=this._differential;return null!=t&&l.x.set(t,n,a),null!=e&&l.y.set(e,n,r),null!=i&&l.z.set(i,n,o),this},i.prototype.get=function(){return this._node.getSize()},i.prototype.halt=function(){return this._proportional.x.halt(),this._proportional.y.halt(),this._proportional.z.halt(),this._differential.x.halt(),this._differential.y.halt(),this._differential.z.halt(),this._absolute.x.halt(),this._absolute.y.halt(),this._absolute.z.halt(),this},e.exports=i},{"../transitions/Transitionable":88}],11:[function(t,e){function i(t,e,i,n){this._transform=n,this._dirty=!1,this.x=new a(t),this.y=new a(e),this.z=new a(i),this._values={x:t,y:e,z:i}}function n(t,e,i,n,s){this._transform=s,this._dirty=!1,this._t=new a([t,e,i,n])}function s(t){this._node=t,this._id=t.addComponent(this),this.origin=null,this.mountPoint=null,this.align=null,this.scale=null,this.position=null,this.rotation=null,this._dirty=!1}var a=t("../transitions/Transitionable"),r=t("../math/Quaternion"),o=new r,l=new r;i.prototype.get=function(){return this._values.x=this.x.get(),this._values.y=this.y.get(),this._values.z=this.z.get(),this._values},i.prototype.set=function(t,e,i,n,s){this._transform._dirty||(this._transform._node.requestUpdate(this._transform._id),this._transform._dirty=!0),this._dirty=!0;var a=null,r=null,o=null;return null!=i?o=s:null!=e?r=s:null!=t&&(a=s),null!=t&&this.x.set(t,n,a),null!=e&&this.y.set(e,n,r),null!=i&&this.z.set(i,n,o),this},i.prototype.isActive=function(){return this.x.isActive()||this.y.isActive()||this.z.isActive()},i.prototype.pause=function(){return this.x.pause(),this.y.pause(),this.z.pause(),this},i.prototype.resume=function(){return this.x.resume(),this.y.resume(),this.z.resume(),this},i.prototype.halt=function(){return this.x.halt(),this.y.halt(),this.z.halt(),this},n.prototype.get=function(){return this._t.get()},n.prototype.set=function(t,e,i,n,s,a){this._transform._dirty||(this._transform._node.requestUpdate(this._transform._id),this._transform._dirty=!0),this._dirty=!0,s.method="slerp",this._t.set([t,e,i,n],s,a)},n.prototype.isActive=function(){return this._t.isActive()},n.prototype.pause=function(){return this._t.pause(),this},n.prototype.resume=function(){return this._t.resume(),this},n.prototype.halt=function(){return this._dirty=!1,this._t.halt(),this},s.prototype.toString=function(){return"Transform"},s.prototype.getValue=function(){return{component:this.toString(),origin:this.origin&&this.origin.get(),mountPoint:this.mountPoint&&this.mountPoint.get(),align:this.align&&this.align.get(),scale:this.scale&&this.scale.get(),position:this.position&&this.position.get(),rotation:this.rotation&&this.rotation.get()}},s.prototype.setState=function(t){return this.toString()===t.component?(t.origin&&this.setOrigin(t.origin.x,t.origin.y,t.origin.z),t.mountPoint&&this.setMountPoint(t.mountPoint.x,t.mountPoint.y,t.mountPoint.z),t.align&&this.setAlign(t.align.x,t.align.y,t.align.z),t.scale&&this.setScale(t.scale.x,t.scale.y,t.scale.z),t.position&&this.setPosition(t.position.x,t.position.y,t.position.z),t.rotation&&this.setRotation(t.rotation.x,t.rotation.y,t.rotation.z,t.rotation.w),!0):!1},s.prototype.setOrigin=function(t,e,n,s,a){if(!this.origin){var r=this._node.getOrigin();this.origin=new i(r[0],r[1],r[2],this)}return this.origin.set(t,e,n,s,a),this},s.prototype.setMountPoint=function(t,e,n,s,a){if(!this.mountPoint){var r=this._node.getMountPoint();this.mountPoint=new i(r[0],r[1],r[2],this)}return this.mountPoint.set(t,e,n,s,a),this},s.prototype.setAlign=function(t,e,n,s,a){if(!this.align){var r=this._node.getAlign();this.align=new i(r[0],r[1],r[2],this)}return this.align.set(t,e,n,s,a),this},s.prototype.setScale=function(t,e,n,s,a){if(!this.scale){var r=this._node.getScale();this.scale=new i(r[0],r[1],r[2],this)}return this.scale.set(t,e,n,s,a),this},s.prototype.setPosition=function(t,e,n,s,a){if(!this.position){var r=this._node.getPosition();this.position=new i(r[0],r[1],r[2],this)}return this.position.set(t,e,n,s,a),this},s.prototype.translate=function(t,e,n,s,a){if(!this.position){var r=this._node.getPosition();this.position=new i(r[0],r[1],r[2],this)}var o=this.position,l=o.x._queue,h=o.y._queue,u=o.z._queue,c=null==t?null:t+(l.length>0?l[l.length-5]:o.x._state),p=null==e?null:e+(h.length>0?h[h.length-5]:o.y._state),d=null==n?null:n+(u.length>0?u[u.length-5]:o.z._state);return this.position.set(c,p,d,s,a),this},s.prototype.setRotation=function(t,e,i,s,a,r){if(!this.rotation){var l=this._node.getRotation();this.rotation=new n(l[0],l[1],l[2],l[3],this)}var h=o;return"number"==typeof s?h.set(s,t,e,i):(h.fromEuler(t,e,i),r=a,a=s),this.rotation.set(h.x,h.y,h.z,h.w,a,r),this},s.prototype.rotate=function(t,e,i,s,a,r){if(!this.rotation){var h=this._node.getRotation();this.rotation=new n(h[0],h[1],h[2],h[3],this)}var u,c,p=this.rotation._t._queue,d=p.length;c=0!==d?p[d-5]:this.rotation._t._state,u=l.set(c[3],c[0],c[1],c[2]);var m=o;"number"==typeof s?m.set(s,t,e,i):(m.fromEuler(t,e,i),r=a,a=s);var f=u.multiply(m);return this.rotation.set(f.x,f.y,f.z,f.w,a,r),this},s.prototype.clean=function(){var t,e=this._node,i=!1;if((t=this.origin)&&t._dirty&&(e.setOrigin(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),i=i||t._dirty),(t=this.mountPoint)&&t._dirty&&(e.setMountPoint(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),i=i||t._dirty),(t=this.align)&&t._dirty&&(e.setAlign(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),i=i||t._dirty),(t=this.scale)&&t._dirty&&(e.setScale(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),i=i||t._dirty),(t=this.position)&&t._dirty&&(e.setPosition(t.x.get(),t.y.get(),t.z.get()),t._dirty=t.isActive(),i=i||t._dirty),(t=this.rotation)&&t._dirty){var n=t.get();e.setRotation(n[0],n[1],n[2],n[3]),t._dirty=t.isActive(),i=i||t._dirty}i?this._node.requestUpdateOnNextTick(this._id):this._dirty=!1},s.prototype.onUpdate=s.prototype.clean,e.exports=s},{"../math/Quaternion":42,"../transitions/Transitionable":88}],12:[function(t,e){e.exports={Align:t("./Align"),Camera:t("./Camera"),GestureHandler:t("./GestureHandler"),MountPoint:t("./MountPoint"),Opacity:t("./Opacity"),Origin:t("./Origin"),Position:t("./Position"),Rotation:t("./Rotation"),Scale:t("./Scale"),Size:t("./Size"),Transform:t("./Transform")}},{"./Align":1,"./Camera":2,"./GestureHandler":3,"./MountPoint":4,"./Opacity":5,"./Origin":6,"./Position":7,"./Rotation":8,"./Scale":9,"./Size":10,"./Transform":11}],13:[function(t,e){function i(){"undefined"!=typeof self&&self.window!==self&&this._enterWorkerMode()}i.prototype._enterWorkerMode=function(){this._workerMode=!0;var t=this;self.addEventListener("message",function(e){t.onMessage(e.data)})},i.prototype.onMessage=null,i.prototype.sendMessage=function(t){this._workerMode?self.postMessage(t):this.onmessage(t)},i.prototype.onmessage=null,i.prototype.postMessage=function(t){return this.onMessage(t)},e.exports=i},{}],14:[function(t,e){function i(){this._time=0,this._frame=0,this._timerQueue=[],this._updatingIndex=0,this._scale=1,this._scaledTime=this._time}i.prototype.setScale=function(t){return this._scale=t,this},i.prototype.getScale=function(){return this._scale},i.prototype.step=function(t){this._frame++,this._scaledTime=this._scaledTime+(t-this._time)*this._scale,this._time=t;for(var e=0;e<this._timerQueue.length;e++)this._timerQueue[e](this._scaledTime)&&this._timerQueue.splice(e,1);return this},i.prototype.now=function(){return this._scaledTime},i.prototype.getTime=i.prototype.now,i.prototype.getFrame=function(){return this._frame},i.prototype.setTimeout=function(t,e){var i=Array.prototype.slice.call(arguments,2),n=this._time,s=function(s){return s-n>=e?(t.apply(null,i),!0):!1};return this._timerQueue.push(s),s},i.prototype.setInterval=function(t,e){var i=Array.prototype.slice.call(arguments,2),n=this._time,s=function(s){return s-n>=e&&(t.apply(null,i),n=s),!1};return this._timerQueue.push(s),s},i.prototype.clearTimer=function(t){var e=this._timerQueue.indexOf(t);return-1!==e&&this._timerQueue.splice(e,1),this},e.exports=i},{}],15:[function(t,e){function i(t){if(!t)throw new Error("Dispatch needs to be instantiated on a node");this._context=t,this._queue=[]}function n(t,e){e.length=0;var i,n=0,s=t.length;for(i=0;s>i;i++)"/"===t[i]&&(e.push(t.substring(n,i)),n=i+1);return i-n>0&&e.push(t.substring(n,i)),e}var s=t("./Event");i.prototype.lookupNode=function(t){if(!t)throw new Error("lookupNode must be called with a path");var e=this._queue;if(n(t,e),e[0]!==this._context.getSelector())return void 0;var i,s=this._context.getChildren(),a=1;for(e[0]=this._context;a<e.length;){if(i=s[e[a]],e[a]=i,!i)return void 0;s=i.getChildren(),a++}return i},i.prototype.dispatch=function(t,e){if(!t)throw new Error("dispatch requires an event name as it's first argument");var i,n,s,a,r=this._queue;for(r.length=0,r.push(this._context);r.length;)for(i=r.shift(),i.onReceive&&i.onReceive(t,e),a=i.getChildren(),n=0,s=a.length;s>n;n++)r.push(a[n])},i.prototype.dispatchUIEvent=function(t,e,i){if(!t)throw new Error("dispatchUIEvent needs a valid path to dispatch to");if(!e)throw new Error("dispatchUIEvent needs an event name as its second argument");var n,a=this._queue;for(s.call(i),i.node=this.lookupNode(t);a.length&&(n=a.pop(),n.onReceive&&n.onReceive(e,i),!i.propagationStopped););},e.exports=i},{"./Event":16}],16:[function(t,e){function i(){this.propagationStopped=!1,this.stopPropagation=n}function n(){this.propagationStopped=!0}e.exports=i},{}],17:[function(t,e){function i(){this._updateQueue=[],this._nextUpdateQueue=[],this._scenes={},this._messages=c,this._inUpdate=!1,this._clock=new n,this._channel=new a,this._channel.onMessage=this.handleMessage.bind(this)}var n=t("./Clock"),s=t("./Scene"),a=t("./Channel"),r=t("../renderers/UIManager"),o=t("../renderers/Compositor"),l=t("../render-loops/RequestAnimationFrameLoop"),h=["ENGINE","START"],u=["ENGINE","STOP"],c=["TIME",null];i.prototype.init=function(t){return this.compositor=t&&t.compositor||new o,this.renderLoop=t&&t.renderLoop||new l,this.uiManager=new r(this.getChannel(),this.compositor,this.renderLoop),this},i.prototype.setChannel=function(t){return this._channel=t,this},i.prototype.getChannel=function(){return this._channel},i.prototype._update=function(){this._inUpdate=!0;var t,e=this._clock.now(),i=this._nextUpdateQueue,n=this._updateQueue;for(this._messages[1]=e;i.length;)n.unshift(i.pop());for(;n.length;)t=n.shift(),t&&t.onUpdate&&t.onUpdate(e);this._inUpdate=!1},i.prototype.requestUpdate=function(t){if(!t)throw new Error("requestUpdate must be called with a class to be updated");this._inUpdate?this.requestUpdateOnNextTick(t):this._updateQueue.push(t)},i.prototype.requestUpdateOnNextTick=function(t){this._nextUpdateQueue.push(t)},i.prototype.handleMessage=function(t){if(!t)throw new Error("onMessage must be called with an array of messages");for(var e;t.length>0;)switch(e=t.shift()){case"WITH":this.handleWith(t);break;case"FRAME":this.handleFrame(t);break;default:throw new Error("received unknown command: "+e)}return this},i.prototype.handleWith=function(t){var e=t.shift(),i=t.shift();switch(i){case"TRIGGER":var n=t.shift(),s=t.shift();this.getContext(e).getDispatch().dispatchUIEvent(e,n,s);break;default:throw new Error("received unknown command: "+i)}return this},i.prototype.handleFrame=function(t){if(!t)throw new Error("handleFrame must be called with an array of messages");if(!t.length)throw new Error("FRAME must be sent with a time");return this.step(t.shift()),this},i.prototype.step=function(t){if(null==t)throw new Error("step must be called with a time");return this._clock.step(t),this._update(),this._messages.length&&(this._channel.sendMessage(this._messages),this._messages.length=2),this},i.prototype.getContext=function(t){if(!t)throw new Error("getContext must be called with a selector");var e=t.indexOf("/");return t=-1===e?t:t.substring(0,e),this._scenes[t]},i.prototype.getClock=function(){return this._clock},i.prototype.message=function(t){return this._messages.push(t),this},i.prototype.createScene=function(t){return t=t||"body",this._scenes[t]&&this._scenes[t].dismount(),this._scenes[t]=new s(t,this),this._scenes[t]},i.prototype.startEngine=function(){return this._channel.sendMessage(h),this},i.prototype.stopEngine=function(){return this._channel.sendMessage(u),this},e.exports=new i},{"../render-loops/RequestAnimationFrameLoop":79,"../renderers/Compositor":82,"../renderers/UIManager":84,"./Channel":13,"./Clock":14,"./Scene":19}],18:[function(t,e){function i(){this._calculatedValues={transform:new Float32Array(o),size:new Float32Array(3)},this._requestingUpdate=!1,this._inUpdate=!1,this._updateQueue=[],this._nextUpdateQueue=[],this._freedComponentIndicies=[],this._components=[],this._freedChildIndicies=[],this._children=[],this._parent=null,this._globalUpdater=null,this._lastEulerX=0,this._lastEulerY=0,this._lastEulerZ=0,this._lastEuler=!1,this.value=new i.Spec
}var n=t("./Transform"),s=t("./Size"),a=new n,r=new s,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[1,1,1],h=[0,0,0,1];i.RELATIVE_SIZE=s.RELATIVE,i.ABSOLUTE_SIZE=s.ABSOLUTE,i.RENDER_SIZE=s.RENDER,i.DEFAULT_SIZE=s.DEFAULT,i.Spec=function(){this.location=null,this.showState={mounted:!1,shown:!1,opacity:1},this.offsets={mountPoint:new Float32Array(3),align:new Float32Array(3),origin:new Float32Array(3)},this.vectors={position:new Float32Array(3),rotation:new Float32Array(h),scale:new Float32Array(l)},this.size={sizeMode:new Float32Array([s.RELATIVE,s.RELATIVE,s.RELATIVE]),proportional:new Float32Array(l),differential:new Float32Array(3),absolute:new Float32Array(3),render:new Float32Array(3)},this.UIEvents=[]},i.prototype.getLocation=function(){return this.value.location},i.prototype.getId=i.prototype.getLocation,i.prototype.emit=function(t,e){for(var i=this;i!==i.getParent();)i=i.getParent();return i.getDispatch().dispatch(t,e),this},i.prototype.sendDrawCommand=function(t){return this._globalUpdater.message(t),this},i.prototype.getValue=function(){for(var t=this._children.length,e=this._components.length,i=0,n={location:this.value.location,spec:this.value,components:new Array(e),children:new Array(t)};t>i;i++)this._children[i]&&this._children[i].getValue&&(n.children[i]=this._children[i].getValue());for(i=0;e>i;i++)this._components[i]&&this._components[i].getValue&&(n.components[i]=this._components[i].getValue());return n},i.prototype.getComputedValue=function(){for(var t=this._children.length,e={location:this.value.location,computedValues:this._calculatedValues,children:new Array(t)},i=0;t>i;i++)e.children[i]=this._children[i].getComputedValue();return e},i.prototype.getChildren=function(){return this._children},i.prototype.getParent=function(){return this._parent},i.prototype.requestUpdate=function(t){return this._inUpdate||!this.isMounted()?this.requestUpdateOnNextTick(t):(this._updateQueue.push(t),this._requestingUpdate||this._requestUpdate(),this)},i.prototype.requestUpdateOnNextTick=function(t){return this._nextUpdateQueue.push(t),this},i.prototype.getUpdater=function(){return this._globalUpdater},i.prototype.isMounted=function(){return this.value.showState.mounted},i.prototype.isShown=function(){return this.value.showState.shown},i.prototype.getOpacity=function(){return this.value.showState.opacity},i.prototype.getMountPoint=function(){return this.value.offsets.mountPoint},i.prototype.getAlign=function(){return this.value.offsets.align},i.prototype.getOrigin=function(){return this.value.offsets.origin},i.prototype.getPosition=function(){return this.value.vectors.position},i.prototype.getRotation=function(){return this.value.vectors.rotation},i.prototype.getScale=function(){return this.value.vectors.scale},i.prototype.getSizeMode=function(){return this.value.size.sizeMode},i.prototype.getProportionalSize=function(){return this.value.size.proportional},i.prototype.getDifferentialSize=function(){return this.value.size.differential},i.prototype.getAbsoluteSize=function(){return this.value.size.absolute},i.prototype.getRenderSize=function(){return this.value.size.render},i.prototype.getSize=function(){return this._calculatedValues.size},i.prototype.getTransform=function(){return this._calculatedValues.transform},i.prototype.getUIEvents=function(){return this.value.UIEvents},i.prototype.addChild=function(t){var e=t?this._children.indexOf(t):-1;if(t=t?t:new i,-1===e&&(e=this._freedChildIndicies.length?this._freedChildIndicies.pop():this._children.length,this._children[e]=t,this.isMounted()&&t.onMount)){var n=this.getId(),s=n+"/"+e;t.onMount(this,s)}return t},i.prototype.removeChild=function(t){var e=this._children.indexOf(t),i=-1!==e;return i&&(this._freedChildIndicies.push(e),this._children[e]=null,this.isMounted()&&t.onDismount&&t.onDismount()),i},i.prototype.addComponent=function(t){var e=this._components.indexOf(t);return-1===e&&(e=this._freedComponentIndicies.length?this._freedComponentIndicies.pop():this._components.length,this._components[e]=t,this.isMounted()&&t.onMount&&t.onMount(this,e),this.isShown()&&t.onShow&&t.onShow()),e},i.prototype.getComponent=function(t){return this._components[t]},i.prototype.removeComponent=function(t){var e=this._components.indexOf(t);return-1!==e&&(this._freedComponentIndicies.push(e),this.isShown()&&t.onHide&&t.onHide(),this.isMounted()&&t.onDismount&&t.onDismount(),this._components[e]=null),t},i.prototype.addUIEvent=function(t){var e,i=this.getUIEvents(),n=this._components,s=-1!==i.indexOf(t);if(!s){i.push(t);for(var a=0,r=n.length;r>a;a++)e=n[a],e&&e.onAddUIEvent&&e.onAddUIEvent(t)}},i.prototype._requestUpdate=function(t){(t||!this._requestingUpdate&&this._globalUpdater)&&(this._globalUpdater.requestUpdate(this),this._requestingUpdate=!0)},i.prototype._vecOptionalSet=function(t,e,i){return null!=i&&t[e]!==i?(t[e]=i,this._requestingUpdate||this._requestUpdate(),!0):!1},i.prototype.show=function(){var t,e=0,i=this._components,n=i.length;for(this.value.showState.shown=!0;n>e;e++)t=i[e],t&&t.onShow&&t.onShow();for(e=0,i=this._children,n=i.length;n>e;e++)t=i[e],t&&t.onParentShow&&t.onParentShow();return this},i.prototype.hide=function(){var t,e=0,i=this._components,n=i.length;for(this.value.showState.shown=!1;n>e;e++)t=i[e],t&&t.onHide&&t.onHide();for(e=0,i=this._children,n=i.length;n>e;e++)t=i[e],t&&t.onParentHide&&t.onParentHide();return this},i.prototype.setAlign=function(t,e,i){var n=this.value.offsets.align,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,null!=i&&(s=this._vecOptionalSet(n,2,i-.5)||s),s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onAlignChange&&a.onAlignChange(t,e,i)}return this},i.prototype.setMountPoint=function(t,e,i){var n=this.value.offsets.mountPoint,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,null!=i&&(s=this._vecOptionalSet(n,2,i-.5)||s),s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onMountPointChange&&a.onMountPointChange(t,e,i)}return this},i.prototype.setOrigin=function(t,e,i){var n=this.value.offsets.origin,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,null!=i&&(s=this._vecOptionalSet(n,2,i-.5)||s),s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onOriginChange&&a.onOriginChange(t,e,i)}return this},i.prototype.setPosition=function(t,e,i){var n=this.value.vectors.position,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,s=this._vecOptionalSet(n,2,i)||s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onPositionChange&&a.onPositionChange(t,e,i)}return this},i.prototype.setRotation=function(t,e,i,n){var s,a,r,o,l=this.value.vectors.rotation,h=!1;if(null!=n)s=t,a=e,r=i,o=n,this._lastEulerX=null,this._lastEulerY=null,this._lastEulerZ=null,this._lastEuler=!1;else{if(null==t||null==e||null==i)if(this._lastEuler)t=null==t?this._lastEulerX:t,e=null==e?this._lastEulerY:e,i=null==i?this._lastEulerZ:i;else{var u=-2*(l[1]*l[2]-l[3]*l[0]);Math.abs(u)>.99999?(e=null==e?.5*Math.PI*u:e,t=null==t?Math.atan2(-l[0]*l[2]+l[3]*l[1],.5-l[1]*l[1]-l[2]*l[2]):t,i=null==i?0:i):(e=null==e?Math.asin(u):e,t=null==t?Math.atan2(l[0]*l[2]+l[3]*l[1],.5-l[0]*l[0]-l[1]*l[1]):t,i=null==i?Math.atan2(l[0]*l[1]+l[3]*l[2],.5-l[0]*l[0]-l[2]*l[2]):i)}var c=.5*t,p=.5*e,d=.5*i,m=Math.sin(c),f=Math.sin(p),g=Math.sin(d),y=Math.cos(c),_=Math.cos(p),v=Math.cos(d),S=f*g,x=_*g,b=f*v,T=_*v;s=m*T+y*S,a=y*b-m*x,r=y*x+m*b,o=y*T-m*S,this._lastEuler=!0,this._lastEulerX=t,this._lastEulerY=e,this._lastEulerZ=i}if(h=this._vecOptionalSet(l,0,s)||h,h=this._vecOptionalSet(l,1,a)||h,h=this._vecOptionalSet(l,2,r)||h,h=this._vecOptionalSet(l,3,o)||h){var A,w=0,C=this._components,z=C.length;for(t=l[0],e=l[1],i=l[2],n=l[3];z>w;w++)A=C[w],A&&A.onRotationChange&&A.onRotationChange(t,e,i,n)}return this},i.prototype.setScale=function(t,e,i){var n=this.value.vectors.scale,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,s=this._vecOptionalSet(n,2,i)||s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onScaleChange&&a.onScaleChange(t,e,i)}return this},i.prototype.setOpacity=function(t){if(t!==this.value.showState.opacity){this.value.showState.opacity=t,this._requestingUpdate||this._requestUpdate();for(var e,i=0,n=this._components,s=n.length;s>i;i++)e=n[i],e&&e.onOpacityChange&&e.onOpacityChange(t)}return this},i.prototype.setSizeMode=function(t,e,i){var n=this.value.size.sizeMode,s=!1;if(null!=t&&(s=this._resolveSizeMode(n,0,t)||s),null!=e&&(s=this._resolveSizeMode(n,1,e)||s),null!=i&&(s=this._resolveSizeMode(n,2,i)||s),s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onSizeModeChange&&a.onSizeModeChange(t,e,i)}return this},i.prototype._resolveSizeMode=function(t,e,i){if(i.constructor!==String)return this._vecOptionalSet(t,e,i);switch(i.toLowerCase()){case"relative":case"default":return this._vecOptionalSet(t,e,0);case"absolute":return this._vecOptionalSet(t,e,1);case"render":return this._vecOptionalSet(t,e,2);default:throw new Error("unknown size mode: "+i)}},i.prototype.setProportionalSize=function(t,e,i){var n=this.value.size.proportional,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,s=this._vecOptionalSet(n,2,i)||s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onProportionalSizeChange&&a.onProportionalSizeChange(t,e,i)}return this},i.prototype.setDifferentialSize=function(t,e,i){var n=this.value.size.differential,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,s=this._vecOptionalSet(n,2,i)||s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onDifferentialSizeChange&&a.onDifferentialSizeChange(t,e,i)}return this},i.prototype.setAbsoluteSize=function(t,e,i){var n=this.value.size.absolute,s=!1;if(s=this._vecOptionalSet(n,0,t)||s,s=this._vecOptionalSet(n,1,e)||s,s=this._vecOptionalSet(n,2,i)||s){var a,r=0,o=this._components,l=o.length;for(t=n[0],e=n[1],i=n[2];l>r;r++)a=o[r],a&&a.onAbsoluteSizeChange&&a.onAbsoluteSizeChange(t,e,i)}return this},i.prototype._transformChanged=function(t){for(var e,i=0,n=this._components,s=n.length;s>i;i++)e=n[i],e&&e.onTransformChange&&e.onTransformChange(t);for(i=0,n=this._children,s=n.length;s>i;i++)e=n[i],e&&e.onParentTransformChange&&e.onParentTransformChange(t)},i.prototype._sizeChanged=function(t){for(var e,i=0,n=this._components,s=n.length;s>i;i++)e=n[i],e&&e.onSizeChange&&e.onSizeChange(t);for(i=0,n=this._children,s=n.length;s>i;i++)e=n[i],e&&e.onParentSizeChange&&e.onParentSizeChange(t)},i.prototype.getFrame=function(){return this._globalUpdater.getFrame()},i.prototype.getComponents=function(){return this._components},i.prototype.update=function(t){this._inUpdate=!0;for(var e,i=this._nextUpdateQueue,n=this._updateQueue;i.length;)n.unshift(i.pop());for(;n.length;)e=this._components[n.shift()],e&&e.onUpdate&&e.onUpdate(t);var s=this.getSize(),o=this.getTransform(),l=this.getParent(),h=l.getSize(),u=l.getTransform(),c=r.fromSpecWithParent(h,this,s),p=a.fromSpecWithParent(u,this.value,s,h,o);return p&&this._transformChanged(o),c&&this._sizeChanged(s),this._inUpdate=!1,this._requestingUpdate=!1,this.isMounted()?this._nextUpdateQueue.length&&(this._globalUpdater.requestUpdateOnNextTick(this),this._requestingUpdate=!0):(this._parent=null,this.value.location=null,this._globalUpdater=null),this},i.prototype.mount=function(t,e){if(this.isMounted())return this;var i,n=0,s=this._components,a=s.length;for(this._parent=t,this._globalUpdater=t.getUpdater(),this.value.location=e,this.value.showState.mounted=!0;a>n;n++)i=s[n],i&&i.onMount&&i.onMount(this,n);for(n=0,s=this._children,a=s.length;a>n;n++)i=s[n],i&&i.onParentMount&&i.onParentMount(this,e,n);return this._requestingUpdate||this._requestUpdate(!0),this},i.prototype.dismount=function(){if(!this.isMounted())return this;var t,e=0,i=this._components,n=i.length;for(this.value.showState.mounted=!1,this._parent.removeChild(this);n>e;e++)t=i[e],t&&t.onDismount&&t.onDismount();for(e=0,i=this._children,n=i.length;n>e;e++)t=i[e],t&&t.onParentDismount&&t.onParentDismount();return this._requestingUpdate||this._requestUpdate(),this},i.prototype.onParentMount=function(t,e,i){return this.mount(t,e+"/"+i)},i.prototype.onParentDismount=function(){return this.dismount()},i.prototype.receive=function(t,e){for(var i,n=0,s=this._components,a=s.length;a>n;n++)i=s[n],i&&i.onReceive&&i.onReceive(t,e);return this},i.prototype._requestUpdateWithoutArgs=function(){this._requestingUpdate||this._requestUpdate()},i.prototype.onUpdate=i.prototype.update,i.prototype.onParentShow=i.prototype.show,i.prototype.onParentHide=i.prototype.hide,i.prototype.onParentTransformChange=i.prototype._requestUpdateWithoutArgs,i.prototype.onParentSizeChange=i.prototype._requestUpdateWithoutArgs,i.prototype.onShow=i.prototype.show,i.prototype.onHide=i.prototype.hide,i.prototype.onMount=i.prototype.mount,i.prototype.onDismount=i.prototype.dismount,i.prototype.onReceive=i.prototype.receive,e.exports=i},{"./Size":20,"./Transform":21}],19:[function(t,e){function i(t,e){if(!t)throw new Error("Scene needs to be created with a DOM selector");if(!e)throw new Error("Scene needs to be created with a class like Famous");s.call(this),this._updater=e,this._dispatch=new n(this),this._selector=t,this.onMount(this,t),this._updater.message("NEED_SIZE_FOR").message(t),this.show()}var n=t("./Dispatch"),s=t("./Node"),a=t("./Size");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.getUpdater=function(){return this._updater},i.prototype.getSelector=function(){return this._selector},i.prototype.getDispatch=function(){return this._dispatch},i.prototype.onReceive=function(t,e){if("CONTEXT_RESIZE"===t){if(e.length<2)throw new Error("CONTEXT_RESIZE's payload needs to be at least a pair of pixel sizes");this.setSizeMode(a.ABSOLUTE,a.ABSOLUTE,a.ABSOLUTE),this.setAbsoluteSize(e[0],e[1],e[2]?e[2]:0)}},e.exports=i},{"./Dispatch":15,"./Node":18,"./Size":20}],20:[function(t,e){function i(){this._size=new Float32Array(3)}i.RELATIVE=0,i.ABSOLUTE=1,i.RENDER=2,i.DEFAULT=i.RELATIVE,i.prototype.fromSpecWithParent=function(t,e,n){for(var s,a,r=e.getValue().spec,o=e.getComponents(),l=r.size.sizeMode,h=!1,u=o.length,c=0;3>c;c++){switch(l[c]){case i.RELATIVE:s=n[c],n[c]=t[c]*r.size.proportional[c]+r.size.differential[c];break;case i.ABSOLUTE:s=n[c],n[c]=r.size.absolute[c];break;case i.RENDER:var p;for(a=0;u>a;a++)o[a].getRenderSize&&(p=o[a].getRenderSize()[c],s=n[c],n[c]=n[c]<p||0===n[c]?p:n[c])}h=h||s!==n[c]}return h},e.exports=i},{}],21:[function(t,e){function i(){this._matrix=new Float32Array(16)}i.prototype.get=function(){return this._matrix},i.prototype.fromSpecWithParent=function(t,e,i,n,s){s=s?s:this._matrix;var a=s[0],r=s[1],o=s[2],l=s[4],h=s[5],u=s[6],c=s[8],p=s[9],d=s[10],m=s[12],f=s[13],g=s[14],y=t[0],_=t[1],v=t[2],S=t[4],x=t[5],b=t[6],T=t[8],A=t[9],w=t[10],C=t[12],z=t[13],E=t[14],R=e.vectors.position[0],O=e.vectors.position[1],P=e.vectors.position[2],I=e.vectors.rotation[0],M=e.vectors.rotation[1],L=e.vectors.rotation[2],X=e.vectors.rotation[3],D=e.vectors.scale[0],Y=e.vectors.scale[1],k=e.vectors.scale[2],F=e.offsets.align[0]*n[0],U=e.offsets.align[1]*n[1],j=e.offsets.align[2]*n[2],N=e.offsets.mountPoint[0]*i[0],q=e.offsets.mountPoint[1]*i[1],V=e.offsets.mountPoint[2]*i[2],B=e.offsets.origin[0]*i[0],G=e.offsets.origin[1]*i[1],H=e.offsets.origin[2]*i[2],W=X*I,Z=X*M,Q=X*L,K=I*I,J=M*M,$=L*L,te=I*M,ee=I*L,ie=M*L,ne=(1-2*(J+$))*D,se=2*(te+Q)*D,ae=2*(ee-Z)*D,re=2*(te-Q)*Y,oe=(1-2*(K+$))*Y,le=2*(ie+W)*Y,he=2*(ee+Z)*k,ue=2*(ie-W)*k,ce=(1-2*(K+J))*k,pe=F+R-N+B-(ne*B+re*G+he*H),de=U+O-q+G-(se*B+oe*G+ue*H),me=j+P-V+H-(ae*B+le*G+ce*H);return s[0]=y*ne+S*se+T*ae,s[1]=_*ne+x*se+A*ae,s[2]=v*ne+b*se+w*ae,s[3]=0,s[4]=y*re+S*oe+T*le,s[5]=_*re+x*oe+A*le,s[6]=v*re+b*oe+w*le,s[7]=0,s[8]=y*he+S*ue+T*ce,s[9]=_*he+x*ue+A*ce,s[10]=v*he+b*ue+w*ce,s[11]=0,s[12]=y*pe+S*de+T*me+C,s[13]=_*pe+x*de+A*me+z,s[14]=v*pe+b*de+w*me+E,s[15]=1,a!==s[0]||r!==s[1]||o!==s[2]||l!==s[4]||h!==s[5]||u!==s[6]||c!==s[8]||p!==s[9]||d!==s[10]||m!==s[12]||f!==s[13]||g!==s[14]},e.exports=i},{}],22:[function(t,e){e.exports={Clock:t("./Clock"),Event:t("./Event"),Scene:t("./Scene"),FamousEngine:t("./FamousEngine"),Dispatch:t("./Dispatch"),Node:t("./Node"),Size:t("./Size"),Transform:t("./Transform")}},{"./Clock":14,"./Dispatch":15,"./Event":16,"./FamousEngine":17,"./Node":18,"./Scene":19,"./Size":20,"./Transform":21}],23:[function(t,e){function i(t,e){if(!t)throw new Error("DOMElement must be instantiated on a node");if(this._node=t,this._parent=null,this._children=[],this._requestingUpdate=!1,this._renderSized=!1,this._requestRenderSize=!1,this._changeQueue=[],this._UIEvents=t.getUIEvents().slice(0),this._classes=["famous-dom-element"],this._requestingEventListeners=[],this._styles={},this.setProperty("display",t.isShown()?"none":"block"),this.onOpacityChange(t.getOpacity()),this._attributes={},this._content="",this._tagName=e&&e.tagName?e.tagName:"div",this._id=t?t.addComponent(this):null,this._renderSize=[0,0,0],this._callbacks=new n,e){var i,s;if(e.classes)for(i=0;i<e.classes.length;i++)this.addClass(e.classes[i]);if(e.attributes)for(s in e.attributes)this.setAttribute(s,e.attributes[s]);if(e.properties)for(s in e.properties)this.setProperty(s,e.properties[s]);e.id&&this.setId(e.id),e.content&&this.setContent(e.content),e.cutout===!1&&this.setCutoutState(e.cutout)}}var n=t("../utilities/CallbackStore"),s=2;i.prototype.getValue=function(){return{classes:this._classes,styles:this._styles,attributes:this._attributes,content:this._content,id:this._attributes.id,tagName:this._tagName}},i.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue,i=e.length;if(i&&t){for(t.sendDrawCommand("WITH"),t.sendDrawCommand(t.getLocation());i--;)t.sendDrawCommand(e.shift());this._requestRenderSize&&(t.sendDrawCommand("DOM_RENDER_SIZE"),t.sendDrawCommand(t.getLocation()),this._requestRenderSize=!1)}this._requestingUpdate=!1},i.prototype._setParent=function(t){if(!this._node)throw new Error("_setParent called on an Element that isn't in the scene graph");var e=this._node.getLocation();if(e===t||-1===e.indexOf(t))throw new Error("The given path isn't an ancestor");this._parent=t},i.prototype._addChild=function(t){if(!this._node)throw new Error("_addChild called on an Element that isn't in the scene graph");var e=this._node.getLocation();if(t===e||-1===t.indexOf(e))throw new Error("The given path isn't a descendent");if(-1!==this._children.indexOf(t))throw new Error("The given path is already a child of this element");this._children.push(t)},i.prototype._getParent=function(){return this._parent},i.prototype._getChildren=function(){return this._children},i.prototype.onMount=function(t,e){this._node=t,this._id=e,this._UIEvents=t.getUIEvents().slice(0),this.draw(),this.setAttribute("data-fa-path",t.getLocation())},i.prototype.onDismount=function(){this.setProperty("display","none"),this.setAttribute("data-fa-path",""),this._initialized=!1},i.prototype.onShow=function(){this.setProperty("display","block")},i.prototype.onHide=function(){this.setProperty("display","none")},i.prototype.setCutoutState=function(t){this._changeQueue.push("GL_CUTOUT_STATE",t),this._initialized&&this._requestUpdate()},i.prototype.onTransformChange=function(t){this._changeQueue.push("CHANGE_TRANSFORM");for(var e=0,i=t.length;i>e;e++)this._changeQueue.push(t[e]);this.onUpdate()},i.prototype.onSizeChange=function(t){var e=this._node.getSizeMode(),i=e[0]!==s,n=e[1]!==s;return this._initialized&&this._changeQueue.push("CHANGE_SIZE",i?t[0]:i,n?t[1]:n),this._requestingUpdate||this._requestUpdate(),this},i.prototype.onOpacityChange=function(t){return this.setProperty("opacity",t)},i.prototype.onAddUIEvent=function(t){return-1===this._UIEvents.indexOf(t)?(this._subscribe(t),this._UIEvents.push(t)):this._inDraw&&this._subscribe(t),this},i.prototype._subscribe=function(t){this._initialized&&this._changeQueue.push("SUBSCRIBE",t,!0),this._requestingUpdate||this._requestUpdate(),this._requestingUpdate||this._requestUpdate()},i.prototype.onSizeModeChange=function(t,e,i){(t===s||e===s||i===s)&&(this._renderSized=!0,this._requestRenderSize=!0),this.onSizeChange(this._node.getSize())},i.prototype.getRenderSize=function(){return this._renderSize},i.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},i.prototype.init=function(){this._changeQueue.push("INIT_DOM",this._tagName),this._initialized=!0,this.onTransformChange(this._node.getTransform()),this.onSizeChange(this._node.getSize()),this._requestingUpdate||this._requestUpdate()},i.prototype.setId=function(t){return this.setAttribute("id",t),this},i.prototype.addClass=function(t){return this._classes.indexOf(t)<0?(this._initialized&&this._changeQueue.push("ADD_CLASS",t),this._classes.push(t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0),this):(this._inDraw&&(this._initialized&&this._changeQueue.push("ADD_CLASS",t),this._requestingUpdate||this._requestUpdate()),this)},i.prototype.removeClass=function(t){var e=this._classes.indexOf(t);return 0>e?this:(this._changeQueue.push("REMOVE_CLASS",t),this._classes.splice(e,1),this._requestingUpdate||this._requestUpdate(),this)},i.prototype.hasClass=function(t){return-1!==this._classes.indexOf(t)},i.prototype.setAttribute=function(t,e){return(this._attributes[t]!==e||this._inDraw)&&(this._attributes[t]=e,this._initialized&&this._changeQueue.push("CHANGE_ATTRIBUTE",t,e),this._requestUpdate||this._requestUpdate()),this},i.prototype.setProperty=function(t,e){return(this._styles[t]!==e||this._inDraw)&&(this._styles[t]=e,this._initialized&&this._changeQueue.push("CHANGE_PROPERTY",t,e),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},i.prototype.setContent=function(t){return(this._content!==t||this._inDraw)&&(this._content=t,this._initialized&&this._changeQueue.push("CHANGE_CONTENT",t),this._requestingUpdate||this._requestUpdate(),this._renderSized&&(this._requestRenderSize=!0)),this},i.prototype.on=function(t,e){return this._callbacks.on(t,e)},i.prototype.onReceive=function(t,e){"resize"===t&&(this._renderSize[0]=e.val[0],this._renderSize[1]=e.val[1],this._requestingUpdate||this._requestUpdate()),this._callbacks.trigger(t,e)},i.prototype.draw=function(){var t,e,i;for(this._inDraw=!0,this.init(),e=0,i=this._classes.length;i>e;e++)this.addClass(this._classes[e]);this._content&&this.setContent(this._content);for(t in this._styles)this._styles[t]&&this.setProperty(t,this._styles[t]);for(t in this._attributes)this._attributes[t]&&this.setAttribute(t,this._attributes[t]);for(e=0,i=this._UIEvents.length;i>e;e++)this.onAddUIEvent(this._UIEvents[e]);this._inDraw=!1},e.exports=i},{"../utilities/CallbackStore":90}],24:[function(t,e){e.exports={DOMElement:t("./DOMElement")}},{"./DOMElement":23}],25:[function(t,e){function i(t,e,i){t.classList.add("famous-dom-renderer"),l=l||r("transform"),this._compositor=i,this._target=null,this._parent=null,this._path=null,this._children=[],this._root=new s(t,e),this._boundTriggerEvent=this._triggerEvent.bind(this),this._selector=e,this._elements={},this._elements[e]=this._root,this.perspectiveTransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._VPtransform=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this._size=[null,null]}function n(t){for(var e=[],i=t.target;i!==document.body;)e.push(i),i=i.parentNode;return e}var s=t("./ElementCache"),a=t("./Math"),r=t("../utilities/vendorPrefix"),o=t("./events/EventMap"),l=null;i.prototype.subscribe=function(t,e){if(this._assertTargetLoaded(),this._target.preventDefault[t]=e,this._target.subscribe[t]=!0,!this._target.listeners[t]&&!this._root.listeners[t]){var i=o[t][1]?this._root:this._target;i.listeners[t]=this._boundTriggerEvent,i.element.addEventListener(t,this._boundTriggerEvent)}},i.prototype._triggerEvent=function(t){for(var e=t.path?t.path:n(t),i=0;i<e.length;i++)if(e[i].dataset){var s=e[i].dataset.faPath;if(s&&this._elements[s].subscribe[t.type]){t.stopPropagation(),this._elements[s].preventDefault[t.type]&&t.preventDefault();var a=o[t.type][0];this._compositor.sendEvent(s,t.type,new a(t));break}}},i.prototype.getSizeOf=function(t){var e=this._elements[t];if(!e)return null;var i={val:e.size};return this._compositor.sendEvent(t,"resize",i),i},i.prototype.getSize=function(){return this._size[0]=this._root.element.offsetWidth,this._size[1]=this._root.element.offsetHeight,this._size},i.prototype._getSize=i.prototype.getSize,i.prototype.draw=function(t){t.perspectiveDirty&&(this.perspectiveDirty=!0,this.perspectiveTransform[0]=t.perspectiveTransform[0],this.perspectiveTransform[1]=t.perspectiveTransform[1],this.perspectiveTransform[2]=t.perspectiveTransform[2],this.perspectiveTransform[3]=t.perspectiveTransform[3],this.perspectiveTransform[4]=t.perspectiveTransform[4],this.perspectiveTransform[5]=t.perspectiveTransform[5],this.perspectiveTransform[6]=t.perspectiveTransform[6],this.perspectiveTransform[7]=t.perspectiveTransform[7],this.perspectiveTransform[8]=t.perspectiveTransform[8],this.perspectiveTransform[9]=t.perspectiveTransform[9],this.perspectiveTransform[10]=t.perspectiveTransform[10],this.perspectiveTransform[11]=t.perspectiveTransform[11],this.perspectiveTransform[12]=t.perspectiveTransform[12],this.perspectiveTransform[13]=t.perspectiveTransform[13],this.perspectiveTransform[14]=t.perspectiveTransform[14],this.perspectiveTransform[15]=t.perspectiveTransform[15]),(t.viewDirty||t.perspectiveDirty)&&(a.multiply(this._VPtransform,this.perspectiveTransform,t.viewTransform),this._root.element.style[l]=this._stringifyMatrix(this._VPtransform))},i.prototype._assertPathLoaded=function(){if(!this._path)throw new Error("path not loaded")},i.prototype._assertParentLoaded=function(){if(!this._parent)throw new Error("parent not loaded")},i.prototype._assertChildrenLoaded=function(){if(!this._children)throw new Error("children not loaded")},i.prototype._assertTargetLoaded=function(){if(!this._target)throw new Error("No target loaded")},i.prototype.findParent=function(){this._assertPathLoaded();for(var t,e=this._path;!t&&e.length;)e=e.substring(0,e.lastIndexOf("/")),t=this._elements[e];return this._parent=t,t},i.prototype.findChildren=function(t){this._assertPathLoaded();var e,i=this._path+"/",n=Object.keys(this._elements),s=0;for(t=t?t:this._children,this._children.length=0;s<n.length;)-1===n[s].indexOf(i)||n[s]===i?n.splice(s,1):s++;var a,r=0;for(s=0;s<n.length;s++)for(a=n[s],r=0;r<n.length;r++)s!==r&&-1!==n[r].indexOf(a)&&(n.splice(r,1),s--);for(s=0,e=n.length;e>s;s++)t[s]=this._elements[n[s]];return t},i.prototype.findTarget=function(){return this._target=this._elements[this._path],this._target},i.prototype.loadPath=function(t){return this._path=t,this._path},i.prototype.insertEl=function(t){if(!this._target||this._target.element.tagName.toLowerCase()===t.toLowerCase()){this.findParent(),this.findChildren(),this._assertParentLoaded(),this._assertChildrenLoaded(),this._target&&this._parent.element.removeChild(this._target.element),this._target=new s(document.createElement(t),this._path),this._parent.element.appendChild(this._target.element),this._elements[this._path]=this._target;for(var e=0,i=this._children.length;i>e;e++)this._target.element.appendChild(this._children[e].element)}},i.prototype.setProperty=function(t,e){this._assertTargetLoaded(),this._target.element.style[t]=e},i.prototype.setSize=function(t,e){this._assertTargetLoaded(),this.setWidth(t),this.setHeight(e)},i.prototype.setWidth=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitWidth=!0,e&&(e.style.width=""),t=e?e.offsetWidth:0,this._target.element.style.width=t+"px"):(this._target.explicitWidth=!1,e&&(e.style.width=t+"px"),this._target.element.style.width=t+"px"),this._target.size[0]=t},i.prototype.setHeight=function(t){this._assertTargetLoaded();var e=this._target.content;t===!1?(this._target.explicitHeight=!0,e&&(e.style.height=""),t=e?e.offsetHeight:0,this._target.element.style.height=t+"px"):(this._target.explicitHeight=!1,e&&(e.style.height=t+"px"),this._target.element.style.height=t+"px"),this._target.size[1]=t},i.prototype.setAttribute=function(t,e){this._assertTargetLoaded(),this._target.element.setAttribute(t,e)},i.prototype.setContent=function(t){this._assertTargetLoaded(),this.findChildren(),this._target.content||(this._target.content=document.createElement("div"),this._target.content.classList.add("famous-dom-element-content"),this._target.element.insertBefore(this._target.content,this._target.element.firstChild)),this._target.content.innerHTML=t,this.setSize(this._target.explicitWidth?!1:this._target.size[0],this._target.explicitHeight?!1:this._target.size[1])},i.prototype.setMatrix=function(t){this._assertTargetLoaded(),this.findParent();var e,i,n=this._target.worldTransform,s=!1;if(t)for(e=0,i=16;i>e;e++)s=s?s:n[e]===t[e],n[e]=t[e];else s=!0;if(s){a.invert(this._target.invertedParent,this._parent.worldTransform),a.multiply(this._target.finalTransform,this._target.invertedParent,n);var r=this.findChildren([]),o=this._path,h=this._target;for(e=0,i=r.length;i>e;e++)this._target=r[e],this._path=this._target.path,this.setMatrix();this._path=o,this._target=h}this._target.element.style[l]=this._stringifyMatrix(this._target.finalTransform)},i.prototype.addClass=function(t){this._assertTargetLoaded(),this._target.element.classList.add(t)},i.prototype.removeClass=function(t){this._assertTargetLoaded(),this._target.element.classList.remove(t)},i.prototype._stringifyMatrix=function(t){var e="matrix3d(";return e+=t[0]<1e-6&&t[0]>-1e-6?"0,":t[0]+",",e+=t[1]<1e-6&&t[1]>-1e-6?"0,":t[1]+",",e+=t[2]<1e-6&&t[2]>-1e-6?"0,":t[2]+",",e+=t[3]<1e-6&&t[3]>-1e-6?"0,":t[3]+",",e+=t[4]<1e-6&&t[4]>-1e-6?"0,":t[4]+",",e+=t[5]<1e-6&&t[5]>-1e-6?"0,":t[5]+",",e+=t[6]<1e-6&&t[6]>-1e-6?"0,":t[6]+",",e+=t[7]<1e-6&&t[7]>-1e-6?"0,":t[7]+",",e+=t[8]<1e-6&&t[8]>-1e-6?"0,":t[8]+",",e+=t[9]<1e-6&&t[9]>-1e-6?"0,":t[9]+",",e+=t[10]<1e-6&&t[10]>-1e-6?"0,":t[10]+",",e+=t[11]<1e-6&&t[11]>-1e-6?"0,":t[11]+",",e+=t[12]<1e-6&&t[12]>-1e-6?"0,":t[12]+",",e+=t[13]<1e-6&&t[13]>-1e-6?"0,":t[13]+",",e+=t[14]<1e-6&&t[14]>-1e-6?"0,":t[14]+",",e+=t[15]+")"},e.exports=i},{"../utilities/vendorPrefix":100,"./ElementCache":26,"./Math":27,"./events/EventMap":30}],26:[function(t,e){function i(t,e){this.element=t,this.path=e,this.content=null,this.size=new Int16Array(3),this.explicitHeight=!1,this.explicitWidth=!1,this.worldTransform=new Float32Array(n),this.invertedParent=new Float32Array(n),this.finalTransform=new Float32Array(n),this.postRenderSize=new Float32Array(2),this.listeners={},this.preventDefault={},this.subscribe={}}var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];e.exports=i},{}],27:[function(t,e){function i(t,e){var i=e[0],n=e[1],s=e[2],a=e[3],r=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],p=e[10],d=e[11],m=e[12],f=e[13],g=e[14],y=e[15],_=i*o-n*r,v=i*l-s*r,S=i*h-a*r,x=n*l-s*o,b=n*h-a*o,T=s*h-a*l,A=u*f-c*m,w=u*g-p*m,C=u*y-d*m,z=c*g-p*f,E=c*y-d*f,R=p*y-d*g,O=_*R-v*E+S*z+x*C-b*w+T*A;return O?(O=1/O,t[0]=(o*R-l*E+h*z)*O,t[1]=(s*E-n*R-a*z)*O,t[2]=(f*T-g*b+y*x)*O,t[3]=(p*b-c*T-d*x)*O,t[4]=(l*C-r*R-h*w)*O,t[5]=(i*R-s*C+a*w)*O,t[6]=(g*S-m*T-y*v)*O,t[7]=(u*T-p*S+d*v)*O,t[8]=(r*E-o*C+h*A)*O,t[9]=(n*C-i*E-a*A)*O,t[10]=(m*b-f*S+y*_)*O,t[11]=(c*S-u*b-d*_)*O,t[12]=(o*w-r*z-l*A)*O,t[13]=(i*z-n*w+s*A)*O,t[14]=(f*v-m*x-g*_)*O,t[15]=(u*x-c*v+p*_)*O,t):null}function n(t,e,i){var n,s,a,r,o=e[0],l=e[1],h=e[2],u=e[3],c=e[4],p=e[5],d=e[6],m=e[7],f=e[8],g=e[9],y=e[10],_=e[11],v=e[12],S=e[13],x=e[14],b=e[15],T=i[0],A=i[1],w=i[2],C=i[3],z=i[4],E=i[5],R=i[6],O=i[7],P=i[8],I=i[9],M=i[10],L=i[11],X=i[12],D=i[13],Y=i[14],k=i[15],F=!1;return n=T*o+A*c+w*f+C*v,s=T*l+A*p+w*g+C*S,a=T*h+A*d+w*y+C*x,r=T*u+A*m+w*_+C*b,F=F?F:n===t[0]||s===t[1]||a===t[2]||r===t[3],t[0]=n,t[1]=s,t[2]=a,t[3]=r,T=z,A=E,w=R,C=O,n=T*o+A*c+w*f+C*v,s=T*l+A*p+w*g+C*S,a=T*h+A*d+w*y+C*x,r=T*u+A*m+w*_+C*b,F=F?F:n===t[4]||s===t[5]||a===t[6]||r===t[7],t[4]=n,t[5]=s,t[6]=a,t[7]=r,T=P,A=I,w=M,C=L,n=T*o+A*c+w*f+C*v,s=T*l+A*p+w*g+C*S,a=T*h+A*d+w*y+C*x,r=T*u+A*m+w*_+C*b,F=F?F:n===t[8]||s===t[9]||a===t[10]||r===t[11],t[8]=n,t[9]=s,t[10]=a,t[11]=r,T=X,A=D,w=Y,C=k,n=T*o+A*c+w*f+C*v,s=T*l+A*p+w*g+C*S,a=T*h+A*d+w*y+C*x,r=T*u+A*m+w*_+C*b,F=F?F:n===t[12]||s===t[13]||a===t[14]||r===t[15],t[12]=n,t[13]=s,t[14]=a,t[15]=r,t
}e.exports={multiply:n,invert:i}},{}],28:[function(t,e){function i(t){n.call(this,t),this.data=t.data}var n=t("./UIEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"CompositionEvent"},e.exports=i},{"./UIEvent":36}],29:[function(t,e){function i(t){this.type=t.type,this.defaultPrevented=t.defaultPrevented,this.timeStamp=t.timeStamp;var e=t.target.constructor;(e===HTMLInputElement||e===HTMLTextAreaElement||e===HTMLSelectElement)&&(this.value=t.target.value)}i.prototype.toString=function(){return"Event"},e.exports=i},{}],30:[function(t,e){var i=t("./CompositionEvent"),n=t("./Event"),s=t("./FocusEvent"),a=t("./InputEvent"),r=t("./KeyboardEvent"),o=t("./MouseEvent"),l=t("./TouchEvent"),h=t("./UIEvent"),u=t("./WheelEvent"),c={change:[n,!0],submit:[n,!0],abort:[n,!1],beforeinput:[a,!0],blur:[s,!1],click:[o,!0],compositionend:[i,!0],compositionstart:[i,!0],compositionupdate:[i,!0],dblclick:[o,!0],focus:[s,!1],focusin:[s,!0],focusout:[s,!0],input:[a,!0],keydown:[r,!0],keyup:[r,!0],load:[n,!1],mousedown:[o,!0],mouseenter:[o,!1],mouseleave:[o,!1],mousemove:[o,!1],mouseout:[o,!0],mouseover:[o,!0],mouseup:[o,!0],resize:[h,!1],scroll:[h,!1],select:[n,!0],unload:[n,!1],wheel:[u,!0],touchcancel:[l,!0],touchend:[l,!0],touchmove:[l,!0],touchstart:[l,!0]};e.exports=c},{"./CompositionEvent":28,"./Event":29,"./FocusEvent":31,"./InputEvent":32,"./KeyboardEvent":33,"./MouseEvent":34,"./TouchEvent":35,"./UIEvent":36,"./WheelEvent":37}],31:[function(t,e){function i(t){n.call(this,t)}var n=t("./UIEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"FocusEvent"},e.exports=i},{"./UIEvent":36}],32:[function(t,e){function i(t){n.call(this,t),this.inputType=t.inputType,this.data=t.data,this.isComposing=t.isComposing,this.targetRange=t.targetRange}var n=t("./UIEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"InputEvent"},e.exports=i},{"./UIEvent":36}],33:[function(t,e){function i(t){n.call(this,t),this.DOM_KEY_LOCATION_STANDARD=0,this.DOM_KEY_LOCATION_LEFT=1,this.DOM_KEY_LOCATION_RIGHT=2,this.DOM_KEY_LOCATION_NUMPAD=3,this.key=t.key,this.code=t.code,this.location=t.location,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.repeat=t.repeat,this.isComposing=t.isComposing,this.keyCode=t.keyCode}var n=t("./UIEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"KeyboardEvent"},e.exports=i},{"./UIEvent":36}],34:[function(t,e){function i(t){n.call(this,t),this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.button=t.button,this.buttons=t.buttons,this.pageX=t.pageX,this.pageY=t.pageY,this.x=t.x,this.y=t.y,this.offsetX=t.offsetX,this.offsetY=t.offsetY}var n=t("./UIEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"MouseEvent"},e.exports=i},{"./UIEvent":36}],35:[function(t,e){function i(t){this.identifier=t.identifier,this.screenX=t.screenX,this.screenY=t.screenY,this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY}function n(t){if(!t)return r;for(var e=[],n=0;n<t.length;n++)e[n]=new i(t[n]);return e}function s(t){a.call(this,t),this.touches=n(t.touches),this.targetTouches=n(t.targetTouches),this.changedTouches=n(t.changedTouches),this.altKey=t.altKey,this.metaKey=t.metaKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey}var a=t("./UIEvent"),r=[];s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return"TouchEvent"},e.exports=s},{"./UIEvent":36}],36:[function(t,e){function i(t){n.call(this,t),this.detail=t.detail}var n=t("./Event");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"UIEvent"},e.exports=i},{"./Event":29}],37:[function(t,e){function i(t){n.call(this,t),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2,this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.deltaMode=t.deltaMode}var n=t("./MouseEvent");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return"WheelEvent"},e.exports=i},{"./MouseEvent":34}],38:[function(t,e){e.exports={CompositionEvent:t("./CompositionEvent"),Event:t("./Event"),EventMap:t("./EventMap"),FocusEvent:t("./FocusEvent"),InputEvent:t("./InputEvent"),KeyboardEvent:t("./KeyboardEvent"),MouseEvent:t("./MouseEvent"),TouchEvent:t("./TouchEvent"),UIEvent:t("./UIEvent"),WheelEvent:t("./WheelEvent")}},{"./CompositionEvent":28,"./Event":29,"./EventMap":30,"./FocusEvent":31,"./InputEvent":32,"./KeyboardEvent":33,"./MouseEvent":34,"./TouchEvent":35,"./UIEvent":36,"./WheelEvent":37}],39:[function(t,e){e.exports={DOMRenderer:t("./DOMRenderer"),ElementCache:t("./ElementCache"),Events:t("./events"),Math:t("./Math")}},{"./DOMRenderer":25,"./ElementCache":26,"./Math":27,"./events":38}],40:[function(t,e){e.exports={components:t("./components"),core:t("./core"),renderLoops:t("./render-loops"),domRenderables:t("./dom-renderables"),domRenderers:t("./dom-renderers"),math:t("./math"),physics:t("./physics"),renderers:t("./renderers"),transitions:t("./transitions"),utilities:t("./utilities"),webglRenderables:t("./webgl-renderables"),webglRenderers:t("./webgl-renderers"),webglGeometries:t("./webgl-geometries"),webglMaterials:t("./webgl-materials"),webglShaders:t("./webgl-shaders"),polyfills:t("./polyfills")}},{"./components":12,"./core":22,"./dom-renderables":24,"./dom-renderers":39,"./math":45,"./physics":75,"./polyfills":77,"./render-loops":80,"./renderers":85,"./transitions":89,"./utilities":96,"./webgl-geometries":105,"./webgl-materials":119,"./webgl-renderables":121,"./webgl-renderers":134,"./webgl-shaders":136}],41:[function(t,e){function i(t){this.values=t||[1,0,0,0,1,0,0,0,1]}i.prototype.get=function(){return this.values},i.prototype.set=function(t){return this.values=t,this},i.prototype.copy=function(t){var e=this.values,i=t.values;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},i.prototype.vectorMultiply=function(t,e){var i=this.values,n=t.x,s=t.y,a=t.z;return e.x=i[0]*n+i[1]*s+i[2]*a,e.y=i[3]*n+i[4]*s+i[5]*a,e.z=i[6]*n+i[7]*s+i[8]*a,e},i.prototype.multiply=function(t){var e=this.values,i=t.values,n=e[0],s=e[1],a=e[2],r=e[3],o=e[4],l=e[5],h=e[6],u=e[7],c=e[8],p=i[0],d=i[1],m=i[2],f=i[3],g=i[4],y=i[5],_=i[6],v=i[7],S=i[8];return e[0]=n*p+s*f+a*_,e[1]=n*d+s*g+a*v,e[2]=n*m+s*y+a*S,e[3]=r*p+o*f+l*_,e[4]=r*d+o*g+l*v,e[5]=r*m+o*y+l*S,e[6]=h*p+u*f+c*_,e[7]=h*d+u*g+c*v,e[8]=h*m+u*y+c*S,this},i.prototype.transpose=function(){var t=this.values,e=t[1],i=t[2],n=t[3],s=t[5],a=t[6],r=t[7];return t[1]=n,t[2]=a,t[3]=e,t[5]=r,t[6]=i,t[7]=s,this},i.prototype.getDeterminant=function(){var t=this.values,e=t[3],i=t[4],n=t[5],s=t[6],a=t[7],r=t[8],o=t[0]*(i*r-n*a)-t[1]*(e*r-n*s)+t[2]*(e*a-i*s);return o},i.prototype.inverse=function(){var t=this.values,e=t[0],i=t[1],n=t[2],s=t[3],a=t[4],r=t[5],o=t[6],l=t[7],h=t[8],u=e*(a*h-r*l)-i*(s*h-r*o)+n*(s*l-a*o);return Math.abs(u)<1e-40?null:(u=1/u,t[0]=(a*h-r*l)*u,t[3]=(-s*h+r*o)*u,t[6]=(s*l-a*o)*u,t[1]=(-i*h+n*l)*u,t[4]=(e*h-n*o)*u,t[7]=(-e*l+i*o)*u,t[2]=(i*r-n*a)*u,t[5]=(-e*r+n*s)*u,t[8]=(e*a-i*s)*u,this)},i.clone=function(t){return new i(t.values.slice())},i.inverse=function(t,e){var i=t.values,n=e.values,s=i[0],a=i[1],r=i[2],o=i[3],l=i[4],h=i[5],u=i[6],c=i[7],p=i[8],d=s*(l*p-h*c)-a*(o*p-h*u)+r*(o*c-l*u);return Math.abs(d)<1e-40?null:(d=1/d,n[0]=(l*p-h*c)*d,n[3]=(-o*p+h*u)*d,n[6]=(o*c-l*u)*d,n[1]=(-a*p+r*c)*d,n[4]=(s*p-r*u)*d,n[7]=(-s*c+a*u)*d,n[2]=(a*h-r*l)*d,n[5]=(-s*h+r*o)*d,n[8]=(s*l-a*o)*d,e)},i.transpose=function(t,e){var i=t.values,n=e.values,s=i[0],a=i[1],r=i[2],o=i[3],l=i[4],h=i[5],u=i[6],c=i[7],p=i[8];return n[0]=s,n[1]=o,n[2]=u,n[3]=a,n[4]=l,n[5]=c,n[6]=r,n[7]=h,n[8]=p,e},i.add=function(t,e,i){var n=t.values,s=e.values,a=i.values,r=n[0],o=n[1],l=n[2],h=n[3],u=n[4],c=n[5],p=n[6],d=n[7],m=n[8],f=s[0],g=s[1],y=s[2],_=s[3],v=s[4],S=s[5],x=s[6],b=s[7],T=s[8];return a[0]=r+f,a[1]=o+g,a[2]=l+y,a[3]=h+_,a[4]=u+v,a[5]=c+S,a[6]=p+x,a[7]=d+b,a[8]=m+T,i},i.subtract=function(t,e,i){var n=t.values,s=e.values,a=i.values,r=n[0],o=n[1],l=n[2],h=n[3],u=n[4],c=n[5],p=n[6],d=n[7],m=n[8],f=s[0],g=s[1],y=s[2],_=s[3],v=s[4],S=s[5],x=s[6],b=s[7],T=s[8];return a[0]=r-f,a[1]=o-g,a[2]=l-y,a[3]=h-_,a[4]=u-v,a[5]=c-S,a[6]=p-x,a[7]=d-b,a[8]=m-T,i},i.multiply=function(t,e,i){var n=t.values,s=e.values,a=i.values,r=n[0],o=n[1],l=n[2],h=n[3],u=n[4],c=n[5],p=n[6],d=n[7],m=n[8],f=s[0],g=s[1],y=s[2],_=s[3],v=s[4],S=s[5],x=s[6],b=s[7],T=s[8];return a[0]=r*f+o*_+l*x,a[1]=r*g+o*v+l*b,a[2]=r*y+o*S+l*T,a[3]=h*f+u*_+c*x,a[4]=h*g+u*v+c*b,a[5]=h*y+u*S+c*T,a[6]=p*f+d*_+m*x,a[7]=p*g+d*v+m*b,a[8]=p*y+d*S+m*T,i},e.exports=i},{}],42:[function(t,e){function i(t,e,i,n){this.w=t||1,this.x=e||0,this.y=i||0,this.z=n||0}var n=Math.sin,s=Math.cos,a=Math.asin,r=Math.acos,o=Math.atan2,l=Math.sqrt;i.prototype.multiply=function(t){var e=this.x,i=this.y,n=this.z,s=this.w,a=t.x,r=t.y,o=t.z,l=t.w||0;return this.w=s*l-e*a-i*r-n*o,this.x=e*l+a*s+r*n-i*o,this.y=i*l+r*s+e*o-a*n,this.z=n*l+o*s+a*i-e*r,this},i.prototype.leftMultiply=function(t){var e=t.x,i=t.y,n=t.z,s=t.w||0,a=this.x,r=this.y,o=this.z,l=this.w;return this.w=s*l-e*a-i*r-n*o,this.x=e*l+a*s+r*n-i*o,this.y=i*l+r*s+e*o-a*n,this.z=n*l+o*s+a*i-e*r,this},i.prototype.rotateVector=function(t,e){var i=this.w,n=-this.x,s=-this.y,a=-this.z,r=t.x,o=t.y,l=t.z,h=-n*r-s*o-a*l,u=r*i+o*a-s*l,c=o*i+n*l-r*a,p=l*i+r*s-n*o,d=i,m=-n,f=-s,g=-a;return e.x=u*d+m*h+f*p-c*g,e.y=c*d+f*h+u*g-m*p,e.z=p*d+g*h+m*c-u*f,e},i.prototype.invert=function(){return this.w=-this.w,this.x=-this.x,this.y=-this.y,this.z=-this.z,this},i.prototype.conjugate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},i.prototype.length=function(){var t=this.w,e=this.x,i=this.y,n=this.z;return l(t*t+e*e+i*i+n*n)},i.prototype.normalize=function(){var t=this.w,e=this.x,i=this.y,n=this.z,s=l(t*t+e*e+i*i+n*n);return 0===s?this:(s=1/s,this.w*=s,this.x*=s,this.y*=s,this.z*=s,this)},i.prototype.set=function(t,e,i,n){return null!=t&&(this.w=t),null!=e&&(this.x=e),null!=i&&(this.y=i),null!=n&&(this.z=n),this},i.prototype.copy=function(t){return this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z,this},i.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},i.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.slerp=function(t,e,i){var s,a,o,l,h,u=this.w,c=this.x,p=this.y,d=this.z,m=t.w,f=t.x,g=t.y,y=t.z;return a=u*m+c*f+p*g+d*y,1-a>1e-5?(s=r(a),o=n(s),l=n((1-e)*s)/o,h=n(e*s)/o):(l=1-e,h=e),i.w=u*l+m*h,i.x=c*l+f*h,i.y=p*l+g*h,i.z=d*l+y*h,i},i.prototype.toMatrix=function(t){var e=this.w,i=this.x,n=this.y,s=this.z,a=i*i,r=n*n,o=s*s,l=i*n,h=i*s,u=n*s;return t.set([1-2*(r+o),2*(l-e*s),2*(h+e*n),2*(l+e*s),1-2*(a+o),2*(u-e*i),2*(h-e*n),2*(u+e*i),1-2*(a+r)])},i.prototype.toEuler=function(t){var e=this.w,i=this.x,n=this.y,s=this.z,r=i*i,l=n*n,h=s*s,u=2*(i*s+n*e);return u=-1>u?-1:u>1?1:u,t.x=o(2*(i*e-n*s),1-2*(r+l)),t.y=a(u),t.z=o(2*(s*e-i*n),1-2*(l+h)),t},i.prototype.fromEuler=function(t,e,i){var a=.5*t,r=.5*e,o=.5*i,l=n(a),h=n(r),u=n(o),c=s(a),p=s(r),d=s(o);return this.w=c*p*d-l*h*u,this.x=l*p*d+c*h*u,this.y=c*h*d-l*p*u,this.z=c*p*u+l*h*d,this},i.prototype.fromAngleAxis=function(t,e,i,a){var r=l(e*e+i*i+a*a);if(0===r)this.w=1,this.x=this.y=this.z=0;else{r=1/r;var o=.5*t,h=n(o);this.w=s(o),this.x=h*e*r,this.y=h*i*r,this.z=h*a*r}return this},i.multiply=function(t,e,i){var n=t.w||0,s=t.x,a=t.y,r=t.z,o=e.w||0,l=e.x,h=e.y,u=e.z;return i.w=n*o-s*l-a*h-r*u,i.x=s*o+l*n+h*r-a*u,i.y=a*o+h*n+s*u-l*r,i.z=r*o+u*n+l*a-s*h,i},i.normalize=function(t,e){var i=t.w,n=t.x,s=t.y,a=t.z,r=l(i*i+n*n+s*s+a*a);return 0===r?this:(r=1/r,e.w*=r,e.x*=r,e.y*=r,e.z*=r,e)},i.conjugate=function(t,e){return e.w=t.w,e.x=-t.x,e.y=-t.y,e.z=-t.z,e},i.clone=function(t){return new i(t.w,t.x,t.y,t.z)},i.dot=function(t,e){return t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z},e.exports=i},{}],43:[function(t,e){var i=function(t,e){t instanceof Array||t instanceof Float32Array?(this.x=t[0]||0,this.y=t[1]||0):(this.x=t||0,this.y=e||0)};i.prototype.set=function(t,e){return null!=t&&(this.x=t),null!=e&&(this.y=e),this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.scale=function(t){return t instanceof i?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this},i.prototype.rotate=function(t){var e=this.x,i=this.y,n=Math.cos(t),s=Math.sin(t);return this.x=e*n-i*s,this.y=e*s+i*n,this},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.invert=function(){return this.x*=-1,this.y*=-1,this},i.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this},i.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},i.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},i.prototype.clear=function(){return this.x=0,this.y=0,this},i.prototype.isZero=function(){return 0!==this.x||0!==this.y?!1:!0},i.prototype.toArray=function(){return[this.x,this.y]},i.normalize=function(t,e){var i=t.x,n=t.y,s=Math.sqrt(i*i+n*n)||1;return s=1/s,e.x=t.x*s,e.y=t.y*s,e},i.clone=function(t){return new i(t.x,t.y)},i.add=function(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i},i.subtract=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i},i.scale=function(t,e,i){return i.x=t.x*e,i.y=t.y*e,i},i.dot=function(t,e){return t.x*e.x+t.y*e.y},i.cross=function(t,e){return t.x*e.y-t.y*e.x},e.exports=i},{}],44:[function(t,e){var i=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};i.prototype.set=function(t,e,i){return null!=t&&(this.x=t),null!=e&&(this.y=e),null!=i&&(this.z=i),this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},i.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},i.prototype.rotateX=function(t){var e=this.y,i=this.z,n=Math.cos(t),s=Math.sin(t);return this.y=e*n-i*s,this.z=e*s+i*n,this},i.prototype.rotateY=function(t){var e=this.x,i=this.z,n=Math.cos(t),s=Math.sin(t);return this.x=i*s+e*n,this.z=i*n-e*s,this},i.prototype.rotateZ=function(t){var e=this.x,i=this.y,n=Math.cos(t),s=Math.sin(t);return this.x=e*n-i*s,this.y=e*s+i*n,this},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.cross=function(t){var e=this.x,i=this.y,n=this.z,s=t.x,a=t.y,r=t.z;return this.x=i*r-n*a,this.y=n*s-e*r,this.z=e*a-i*s,this},i.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},i.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},i.prototype.map=function(t){return this.x=t(this.x),this.y=t(this.y),this.z=t(this.z),this},i.prototype.length=function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},i.prototype.lengthSq=function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},i.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.prototype.clear=function(){return this.x=0,this.y=0,this.z=0,this},i.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},i.prototype.toArray=function(){return[this.x,this.y,this.z]},i.prototype.normalize=function(){var t=this.x,e=this.y,i=this.z,n=Math.sqrt(t*t+e*e+i*i)||1;return n=1/n,this.x*=n,this.y*=n,this.z*=n,this},i.prototype.applyRotation=function(t){var e=t.w,i=-t.x,n=-t.y,s=-t.z,a=this.x,r=this.y,o=this.z,l=-i*a-n*r-s*o,h=a*e+r*s-n*o,u=r*e+i*o-a*s,c=o*e+a*n-i*r,p=e,d=-i,m=-n,f=-s;return this.x=h*p+d*l+m*c-u*f,this.y=u*p+m*l+h*f-d*c,this.z=c*p+f*l+d*u-h*m,this},i.prototype.applyMatrix=function(t){var e=t.get(),i=this.x,n=this.y,s=this.z;return this.x=e[0]*i+e[1]*n+e[2]*s,this.y=e[3]*i+e[4]*n+e[5]*s,this.z=e[6]*i+e[7]*n+e[8]*s,this},i.normalize=function(t,e){var i=t.x,n=t.y,s=t.z,a=Math.sqrt(i*i+n*n+s*s)||1;return a=1/a,e.x=i*a,e.y=n*a,e.z=s*a,e},i.applyRotation=function(t,e,i){var n=e.w,s=-e.x,a=-e.y,r=-e.z,o=t.x,l=t.y,h=t.z,u=-s*o-a*l-r*h,c=o*n+l*r-a*h,p=l*n+s*h-o*r,d=h*n+o*a-s*l,m=n,f=-s,g=-a,y=-r;return i.x=c*m+f*u+g*d-p*y,i.y=p*m+g*u+c*y-f*d,i.z=d*m+y*u+f*p-c*g,i},i.clone=function(t){return new i(t.x,t.y,t.z)},i.add=function(t,e,i){return i.x=t.x+e.x,i.y=t.y+e.y,i.z=t.z+e.z,i},i.subtract=function(t,e,i){return i.x=t.x-e.x,i.y=t.y-e.y,i.z=t.z-e.z,i},i.scale=function(t,e,i){return i.x=t.x*e,i.y=t.y*e,i.z=t.z*e,i},i.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},i.cross=function(t,e,i){var n=t.x,s=t.y,a=t.z,r=e.x,o=e.y,l=e.z;return i.x=s*l-a*o,i.y=a*r-n*l,i.z=n*o-s*r,i},i.project=function(t,e,i){var n=t.x,s=t.y,a=t.z,r=e.x,o=e.y,l=e.z,h=n*r+s*o+a*l;return h/=r*r+o*o+l*l,i.x=r*h,i.y=o*h,i.z=l*h,i},e.exports=i},{}],45:[function(t,e){e.exports={Mat33:t("./Mat33"),Quaternion:t("./Quaternion"),Vec2:t("./Vec2"),Vec3:t("./Vec3")}},{"./Mat33":41,"./Quaternion":42,"./Vec2":43,"./Vec3":44}],46:[function(t,e){function i(){throw new Error("You should bundle your code using `glslify` as a transform.")}e.exports=i},{}],47:[function(t,e){function i(t,e,i,n){return{vertex:t,fragment:e,uniforms:i,attributes:n}}e.exports=i},{}],48:[function(t,e){function i(t,e,i){var n=g;return c.cross(t,e,n),c.cross(n,i,n),n}function n(t,e){for(var i,n,s,a,r=-(1/0),o=0;o<t.length;o++)s=t[o],n=c.dot(s,e),n>r&&(i=s,r=n,a=o);return{vertex:i,index:a}}function s(t,e,i){this.distance=t,this.normal=e,this.vertexIndices=i}function a(){this.vertices=[],this.numVertices=0,this.features=[],this.numFeatures=0,this.lastVertexIndex=0,this._IDPool={vertices:[],features:[]}}function r(t,e,i,n){for(var s=t[i].vertex,a=t[n].vertex,r=0,o=e.length;o>r;r++){var l=e[r];if(l){var h=t[l[0]].vertex,u=t[l[1]].vertex;if(s===h&&a===u||s===u&&a===h)return void(e[r]=null)}}e.push([i,n])}function o(t,e){e=e||1e3;var i,n,s=l(t,e),a=[];for(i=0,n=s.features.length;n>i;i++){var r=s.features[i];r&&a.push(r.vertexIndices)}var o=u(s.vertices,a),h=o.centroid,p=[];for(i=0,n=s.vertices.length;n>i;i++)p.push(c.subtract(s.vertices[i].vertex,h,new c));var d=[];for(i=0,n=p.length;n>i;i++)d.push(c.normalize(p[i],new c));var m={},f={};for(i=0;i<a.length;i++){var g=a[i][0],y=a[i][1],_=a[i][2];f[g]=f[g]||{},f[y]=f[y]||{},f[_]=f[_]||{},m[g]=m[g]||[],m[y]=m[y]||[],m[_]=m[_]||[],f[g][y]||(f[g][y]=1,m[g].push(y)),f[g][_]||(f[g][_]=1,m[g].push(_)),f[y][g]||(f[y][g]=1,m[y].push(g)),f[y][_]||(f[y][_]=1,m[y].push(_)),f[_][g]||(f[_][g]=1,m[_].push(g)),f[_][y]||(f[_][y]=1,m[_].push(y))}this.indices=a,this.vertices=p,this.normals=d,this.polyhedralProperties=o,this.graph=m}function l(t,e){var s=new a;s.addVertex(n(t,new c(1,0,0))),s.addVertex(n(t,new c(-1,0,0)));var r,o,l,h,u,p,d=s.vertices[0].vertex,m=s.vertices[1].vertex,f=c.subtract(m,d,S),g=-(1/0);for(u=0;u<t.length;u++)if(o=t[u],o!==d&&o!==m){var _=c.subtract(o,d,y);r=c.dot(_,i(f,_,f)),r=0>r?-1*r:r,r>g&&(g=r,l=o,h=u)}s.addVertex({vertex:l,index:h});var v=l,w=c.subtract(v,d,x),C=c.cross(f,w,new c);for(C.normalize(),g=-(1/0),u=0;u<t.length;u++)o=t[u],o!==d&&o!==m&&o!==v&&(r=c.dot(c.subtract(o,d,y),C),r=0>r?-1*r:r,r>g&&(g=r,l=o,h=u));s.addVertex({vertex:l,index:h});var z=l,E=c.subtract(z,d,b),R=c.subtract(v,m,T),O=c.subtract(z,m,A),P=c.cross(w,E,new c),I=c.cross(f,E,new c),M=c.cross(R,O,new c);P.normalize(),I.normalize(),M.normalize(),c.dot(C,E)>0&&C.invert(),c.dot(P,f)>0&&P.invert(),c.dot(I,w)>0&&I.invert(),c.dot(M,f)<0&&M.invert();var L=0,X=1,D=2,Y=3;s.addFeature(null,C,[L,X,D]),s.addFeature(null,P,[L,D,Y]),s.addFeature(null,I,[L,X,Y]),s.addFeature(null,M,[X,D,Y]);var k={};for(u=0,p=s.vertices.length;p>u;u++)k[s.vertices[u].index]=!0;var F=d.x+m.x+v.x+z.x,U=d.y+m.y+v.y+z.y,j=d.z+m.z+v.z+z.z,N=new c(F,U,j);N.scale(.25);for(var q=s.features,V=0;V++<e;){var B=null;for(u=0,p=q.length;p>u;u++)if(q[u]&&!q[u].done){B=q[u],l=null,h=null,d=s.vertices[B.vertexIndices[0]].vertex;var G=n(t,B.normal);l=G.vertex,h=G.index;var H=c.dot(c.subtract(l,d,y),B.normal);.001>H||k[h]?B.done=!0:(k[h]=!0,s.addVertex(G),s.reshape(N))}if(null===B)break}return s}function h(t,e,i,n,s){var a=t+e;n[0]=a+i;var r=t*t,o=r+e*a;n[1]=o+i*n[0],n[2]=t*r+e*o+i*n[1],s[0]=n[1]+t*(n[0]+t),s[1]=n[1]+e*(n[0]+e),s[2]=n[1]+i*(n[0]+i)}function u(t,e){var i,n,s=[0,0,0,0,0,0,0,0,0,0],a=[],r=[],o=[],l=[],u=[],d=[];for(i=0,n=e.length;n>i;i++){var m=t[e[i][0]].vertex,f=t[e[i][1]].vertex,g=t[e[i][2]].vertex,y=c.subtract(f,m,S),_=c.subtract(g,m,x),v=y.cross(_);c.dot(m,v)<0&&v.invert();var b=v.x,T=v.y,A=v.z,w=m.x,C=m.y,z=m.z,E=f.x,R=f.y,O=f.z,P=g.x,I=g.y,M=g.z;h(w,E,P,a,l),h(C,R,I,r,u),h(z,O,M,o,d),s[0]+=b*a[0],s[1]+=b*a[1],s[2]+=T*r[1],s[3]+=A*o[1],s[4]+=b*a[2],s[5]+=T*r[2],s[6]+=A*o[2],s[7]+=b*(C*l[0]+R*l[1]+I*l[2]),s[8]+=T*(z*u[0]+O*u[1]+M*u[2]),s[9]+=A*(w*d[0]+E*d[1]+P*d[2])}s[0]/=6,s[1]/=24,s[2]/=24,s[3]/=24,s[4]/=60,s[5]/=60,s[6]/=60,s[7]/=120,s[8]/=120,s[9]/=120;var L=1/0,X=-(1/0),D=1/0,Y=-(1/0),k=1/0,F=-(1/0);for(i=0,n=t.length;n>i;i++){var U=t[i].vertex;U.x<L&&(L=U.x),U.x>X&&(X=U.x),U.y<D&&(D=U.y),U.y>Y&&(Y=U.y),U.z<k&&(k=U.z),U.z>F&&(F=U.z)}var j=[X-L,Y-D,F-k],N=s[0],q=new c(s[1],s[2],s[3]);q.scale(1/N);var V=new p([s[4],s[7],s[9],s[7],s[5],s[8],s[9],s[8],s[6]]);return{size:j,volume:N,centroid:q,eulerTensor:V}}var c=t("../math/Vec3"),p=t("../math/Mat33"),d=t("../utilities/ObjectManager");d.register("DynamicGeometry",a),d.register("DynamicGeometryFeature",s);var m=d.requestDynamicGeometryFeature,f=d.freeDynamicGeometryFeature,g=new c,y=new c,_=new c,v=new c,S=new c,x=new c,b=new c,T=new c,A=new c;s.prototype.reset=function(t,e,i){return this.distance=t,this.normal=e,this.vertexIndices=i,this},a.prototype.reset=function(){return this.vertices=[],this.numVertices=0,this.features=[],this.numFeatures=0,this.lastVertexIndex=0,this._IDPool={vertices:[],features:[]},this},a.prototype.addVertex=function(t){var e=this._IDPool.vertices.length?this._IDPool.vertices.pop():this.vertices.length;this.vertices[e]=t,this.lastVertexIndex=e,this.numVertices++},a.prototype.removeVertex=function(t){var e=this.vertices[t];return this.vertices[t]=null,this._IDPool.vertices.push(t),this.numVertices--,e},a.prototype.addFeature=function(t,e,i){var n=this._IDPool.features.length?this._IDPool.features.pop():this.features.length;this.features[n]=m().reset(t,e,i),this.numFeatures++},a.prototype.removeFeature=function(t){var e=this.features[t];this.features[t]=null,this._IDPool.features.push(t),this.numFeatures--,f(e)},a.prototype.getLastVertex=function(){return this.vertices[this.lastVertexIndex]},a.prototype.getFeatureClosestToOrigin=function(){for(var t=1/0,e=null,i=this.features,n=0,s=i.length;s>n;n++){var a=i[n];a&&a.distance<t&&(t=a.distance,e=a)}return e},a.prototype.reshape=function(t){var e,i,n,s,a,o=this.vertices,l=this.getLastVertex().vertex,h=this.features,u=[];for(n=0,a=h.length;a>n;n++)h[n]&&(i=h[n].vertexIndices,e=o[i[0]].vertex,c.dot(h[n].normal,c.subtract(l,e,_))>-.001&&(r(o,u,i[0],i[1]),r(o,u,i[1],i[2]),r(o,u,i[2],i[0]),this.removeFeature(n)));var p=l,d=this.lastVertexIndex;for(s=0,a=u.length;a>s;s++)if(u[s]){var m=u[s][0],f=u[s][1],g=o[m].vertex,v=o[f].vertex,b=c.subtract(g,p,S),T=c.subtract(v,p,x),A=c.cross(b,T,new c);if(A.normalize(),t){var w=c.subtract(t,p,y);c.dot(A,w)>-.001&&A.invert(),this.addFeature(null,A,[d,m,f])}else{var C=c.dot(A,p);0>C&&(A.invert(),C*=-1),this.addFeature(C,A,[d,m,f])}}},a.prototype.simplexContainsOrigin=function(t,e){var n=this.vertices.length,s=this.lastVertexIndex,a=s-1,r=s-2,o=s-3;a=0>a?a+n:a,r=0>r?r+n:r,o=0>o?o+n:o;var l,h,u,p,d,m,f,g,y,_,w,C,z,E=this.vertices[s].vertex,R=this.vertices[a].vertex,O=this.vertices[r].vertex,P=this.vertices[o].vertex,I=c.scale(E,-1,v),M=c.subtract(R,E,S);if(4===n){if(l=c.subtract(O,E,x),h=c.subtract(P,E,b),d=c.cross(M,l,new c),m=c.cross(l,h,new c),f=c.cross(M,h,new c),d.normalize(),m.normalize(),f.normalize(),c.dot(d,h)>0&&d.invert(),c.dot(m,M)>0&&m.invert(),c.dot(f,l)>0&&f.invert(),y=c.dot(d,I),_=c.dot(m,I),w=c.dot(f,I),.001>y&&.001>w&&.001>_)return u=c.subtract(O,R,T),p=c.subtract(P,R,A),g=c.cross(u,p,new c),g.normalize(),c.dot(g,M)<=0&&g.invert(),C=-1*c.dot(g,R),this.addFeature(-y,d,[s,a,r]),this.addFeature(-_,m,[s,r,o]),this.addFeature(-w,f,[s,o,a]),this.addFeature(-C,g,[a,r,o]),!0;y>=.001?(z=this.removeVertex(o),t.copy(d)):_>=.001?(z=this.removeVertex(a),t.copy(m)):(z=this.removeVertex(r),t.copy(f))}else 3===n?(l=c.subtract(O,E,x),c.cross(M,l,t),c.dot(t,I)<=0&&t.invert()):t.copy(i(M,I,M));return z&&e&&e(z),!1},e.exports={DynamicGeometry:a,ConvexHull:o}},{"../math/Mat33":41,"../math/Vec3":44,"../utilities/ObjectManager":93}],49:[function(t,e){function i(t){this.events=new u,t=t||{},this.bodies=[],this.forces=[],this.constraints=[],this.step=t.step||1e3/60,this.iterations=t.iterations||10,this._indexPools={bodies:[],forces:[],constraints:[]},this._entityMaps={bodies:{},forces:{},constraints:{}},this.speed=t.speed||1,this.time=0,this.delta=0,this.origin=t.origin||new c,this.orientation=t.orientation?t.orientation.normalize():new p,this.frameDependent=t.frameDependent||!1,this.transformBuffers={position:[0,0,0],rotation:[0,0,0,1]}}function n(t,e,i){var n=t._entityMaps[i];if(null==n[e._ID]){var s=t[i],a=t._indexPools[i];n[e._ID]=a.length?a.pop():s.length,s[n[e._ID]]=e}}function s(t,e,i){var n=t._entityMaps[i],s=n[e._ID];null!=s&&(t._indexPools[i].push(s),t[i][s]=null,n[e._ID]=null)}function a(t,e){t.momentum.add(c.scale(t.force,e,f)),t.angularMomentum.add(c.scale(t.torque,e,f)),c.scale(t.momentum,t.inverseMass,t.velocity),t.inverseInertia.vectorMultiply(t.angularMomentum,t.angularVelocity),t.force.clear(),t.torque.clear()}function r(t,e){if(0!==t.restrictions){var i=t.restrictions,n=null,s=null,a=null,r=null,o=null,l=null;32&i&&(n=0),16&i&&(s=0),8&i&&(a=0),4&i&&(r=0),2&i&&(o=0),1&i&&(l=0),(null!==n||null!==s||null!==a)&&t.setVelocity(n,s,a),(null!==r||null!==o||null!==l)&&t.setAngularVelocity(r,o,l)}t.position.add(c.scale(t.velocity,e,f));var h=t.angularVelocity,u=t.orientation,p=h.x,d=h.y,m=h.z,g=u.w,y=u.x,_=u.y,v=u.z,S=.5*e;u.w+=(-p*y-d*_-m*v)*S,u.x+=(p*g+d*v-m*_)*S,u.y+=(d*g+m*y-p*v)*S,u.z+=(m*g+p*_-d*y)*S,u.normalize(),t.updateInertia()}var o=t("./bodies/Particle"),l=t("./constraints/Constraint"),h=t("./forces/Force"),u=t("../utilities/CallbackStore"),c=t("../math/Vec3"),p=t("../math/Quaternion"),d=new c,m=new p,f=new c;i.prototype.on=function(t,e){return this.events.on(t,e),this},i.prototype.off=function(t,e){return this.events.off(t,e),this},i.prototype.trigger=function(t,e){return this.events.trigger(t,e),this},i.prototype.setOrigin=function(t,e,i){return this.origin.set(t,e,i),this},i.prototype.setOrientation=function(t,e,i,n){return this.orientation.set(t,e,i,n).normalize(),this},i.prototype.add=function(){for(var t=0,e=arguments.length;e>t;t++){var i=arguments[t];if(i instanceof Array)for(var n=0,s=i.length;s>n;n++){var a=i[n];this.add(a)}else i instanceof o?this.addBody(i):i instanceof l?this.addConstraint(i):i instanceof h&&this.addForce(i)}return this},i.prototype.remove=function(){for(var t=0,e=arguments.length;e>t;t++){var i=arguments[t];if(i instanceof Array)for(var n=0,s=i.length;s>n;n++){var a=i[n];this.add(a)}else i instanceof o?this.removeBody(i):i instanceof l?this.removeConstraint(i):i instanceof h&&this.removeForce(i)}return this},i.prototype.addBody=function(t){n(this,t,"bodies")},i.prototype.addForce=function(t){n(this,t,"forces")},i.prototype.addConstraint=function(t){n(this,t,"constraints")},i.prototype.removeBody=function(t){s(this,t,"bodies")},i.prototype.removeForce=function(t){s(this,t,"forces")},i.prototype.removeConstraint=function(t){s(this,t,"constraints")},i.prototype.update=function(t){0===this.time&&(this.time=t);var e=this.bodies,i=this.forces,n=this.constraints,s=this.frameDependent,o=this.step,l=.001*o,h=this.speed,u=this.delta;u+=(t-this.time)*h,this.time=t;for(var c,p,d,m,f;u>o;){for(this.events.trigger("prestep",t),c=0,p=i.length;p>c;c++)d=i[c],null!==d&&d.update(t,l);for(c=0,p=e.length;p>c;c++)m=e[c],null!==m&&a(m,l);for(c=0,p=n.length;p>c;c++)f=n[c],null!==f&&f.update(t,l);for(var g=0,y=this.iterations;y>g;g++)for(c=0,p=n.length;p>c;c++)f=n[c],null!==f&&f.resolve(t,l);for(c=0,p=e.length;p>c;c++)m=e[c],null!==m&&r(m,l);this.events.trigger("poststep",t),s?u=0:u-=o}this.delta=u},i.prototype.getTransform=function(t){var e=this.origin,i=this.orientation,n=this.transformBuffers,s=t.position,a=t.orientation,r=a,o=s;return 1!==i.w&&(r=p.multiply(a,i,m),o=i.rotateVector(s,d)),n.position[0]=e.x+o.x,n.position[1]=e.y+o.y,n.position[2]=e.z+o.z,n.rotation[0]=r.x,n.rotation[1]=r.y,n.rotation[2]=r.z,n.rotation[3]=r.w,n},e.exports=i},{"../math/Quaternion":42,"../math/Vec3":44,"../utilities/CallbackStore":90,"./bodies/Particle":51,"./constraints/Constraint":58,"./forces/Force":69}],50:[function(t,e){function i(t){a.call(this,t),this.normals=[new n(0,1,0),new n(1,0,0),new n(0,0,1)],this.type=2}var n=t("../../math/Vec3"),s=t("./convexBodyFactory"),a=s([new n(-100,-100,-100),new n(100,-100,-100),new n(-100,-100,100),new n(100,-100,100),new n(-100,100,-100),new n(100,100,-100),new n(-100,100,100),new n(100,100,100)]);i.prototype=Object.create(a.prototype),i.prototype.constructor=i,e.exports=i},{"../../math/Vec3":44,"./convexBodyFactory":54}],51:[function(t,e){function i(t){this.events=new r,t=t||{},this.position=t.position||new n,this.orientation=t.orientation||new s,this.velocity=new n,this.momentum=new n,this.angularVelocity=new n,this.angularMomentum=new n,this.mass=t.mass||1,this.inverseMass=1/this.mass,this.force=new n,this.torque=new n,this.restitution=null!=t.restitution?t.restitution:.4,this.friction=null!=t.friction?t.friction:.2,this.inverseInertia=new a([0,0,0,0,0,0,0,0,0]),this.localInertia=new a([0,0,0,0,0,0,0,0,0]),this.localInverseInertia=new a([0,0,0,0,0,0,0,0,0]),this.size=t.size||[0,0,0];var e=t.velocity;e&&this.setVelocity(e.x,e.y,e.z),this.restrictions=0,this.setRestrictions.apply(this,t.restrictions||[]),this.collisionMask=t.collisionMask||1,this.collisionGroup=t.collisionGroup||1,this.type=1,this._ID=h++}var n=t("../../math/Vec3"),s=t("../../math/Quaternion"),a=t("../../math/Mat33"),r=t("../../utilities/CallbackStore"),o=new n,l=new a,h=0;i.prototype.on=function(t,e){return this.events.on(t,e),this},i.prototype.off=function(t,e){return this.events.off(t,e),this},i.prototype.trigger=function(t,e){return this.events.trigger(t,e),this},i.prototype.getRestrictions=function(){var t="",e="",i=this.restrictions;return 32&i&&(t+="x"),16&i&&(t+="y"),8&i&&(t+="z"),4&i&&(e+="x"),2&i&&(e+="y"),1&i&&(e+="z"),[t,e]},i.prototype.setRestrictions=function(t,e){return t=t||"",e=e||"",this.restrictions=0,t.indexOf("x")>-1&&(this.restrictions|=32),t.indexOf("y")>-1&&(this.restrictions|=16),t.indexOf("z")>-1&&(this.restrictions|=8),e.indexOf("x")>-1&&(this.restrictions|=4),e.indexOf("y")>-1&&(this.restrictions|=2),e.indexOf("z")>-1&&(this.restrictions|=1),this},i.prototype.getMass=function(){return this.mass},i.prototype.setMass=function(t){return this.mass=t,this.inverseMass=1/t,this},i.prototype.getInverseMass=function(){return this.inverseMass},i.prototype.updateLocalInertia=function(){return this.localInertia.set([0,0,0,0,0,0,0,0,0]),this.localInverseInertia.set([0,0,0,0,0,0,0,0,0]),this},i.prototype.updateInertia=function(){var t=this.localInverseInertia,e=this.orientation;if(t[0]===t[4]&&t[4]===t[8]||1===e.w)return this;var i=e.toMatrix(l);return a.multiply(i,this.inverseInertia,this.inverseInertia),a.multiply(this.localInverseInertia,i.transpose(),this.inverseInertia),this},i.prototype.getPosition=function(){return this.position},i.prototype.setPosition=function(t,e,i){return this.position.set(t,e,i),this},i.prototype.getVelocity=function(){return this.velocity},i.prototype.setVelocity=function(t,e,i){return this.velocity.set(t,e,i),n.scale(this.velocity,this.mass,this.momentum),this},i.prototype.getMomentum=function(){return this.momentum},i.prototype.setMomentum=function(t,e,i){return this.momentum.set(t,e,i),n.scale(this.momentum,this.inverseMass,this.velocity),this
},i.prototype.getOrientation=function(){return this.orientation},i.prototype.setOrientation=function(t,e,i,n){return this.orientation.set(t,e,i,n).normalize(),this.updateInertia(),this},i.prototype.getAngularVelocity=function(){return this.angularVelocity},i.prototype.setAngularVelocity=function(t,e,i){this.angularVelocity.set(t,e,i);var n=a.inverse(this.inverseInertia,l);return n?n.vectorMultiply(this.angularVelocity,this.angularMomentum):this.angularMomentum.clear(),this},i.prototype.getAngularMomentum=function(){return this.angularMomentum},i.prototype.setAngularMomentum=function(t,e,i){return this.angularMomentum.set(t,e,i),this.inverseInertia.vectorMultiply(this.angularMomentum,this.angularVelocity),this},i.prototype.getForce=function(){return this.force},i.prototype.setForce=function(t,e,i){return this.force.set(t,e,i),this},i.prototype.getTorque=function(){return this.torque},i.prototype.setTorque=function(t,e,i){return this.torque.set(t,e,i),this},i.prototype.applyForce=function(t){return this.force.add(t),this},i.prototype.applyTorque=function(t){return this.torque.add(t),this},i.prototype.applyImpulse=function(t){return this.momentum.add(t),n.scale(this.momentum,this.inverseMass,this.velocity),this},i.prototype.applyAngularImpulse=function(t){return this.angularMomentum.add(t),this.inverseInertia.vectorMultiply(this.angularMomentum,this.angularVelocity),this},i.prototype.support=function(){return o},i.prototype.updateShape=function(){},e.exports=i},{"../../math/Mat33":41,"../../math/Quaternion":42,"../../math/Vec3":44,"../../utilities/CallbackStore":90}],52:[function(t,e){function i(t){n.call(this,t);var e=t.radius||1;this.radius=e,this.size=[2*e,2*e,2*e],this.updateLocalInertia(),this.inverseInertia.copy(this.localInverseInertia);var i=t.angularVelocity;i&&this.setAngularVelocity(i.x,i.y,i.z),this.type=4}var n=t("./Particle"),s=t("../../math/Vec3"),a=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.getRadius=function(){return this.radius},i.prototype.setRadius=function(t){return this.radius=t,this.size=[2*this.radius,2*this.radius,2*this.radius],this},i.prototype.updateLocalInertia=function(){var t=this.mass,e=this.radius,i=t*e*e;this.localInertia.set([.4*i,0,0,0,.4*i,0,0,0,.4*i]),this.localInverseInertia.set([2.5/i,0,0,0,2.5/i,0,0,0,2.5/i])},i.prototype.support=function(t){return s.scale(t,this.radius,a)},e.exports=i},{"../../math/Vec3":44,"./Particle":51}],53:[function(t,e){function i(t){n.call(this,t);var e=this.normal=new s,a=this.direction=t.direction;switch(a){case i.DOWN:e.set(0,1,0);break;case i.UP:e.set(0,-1,0);break;case i.LEFT:e.set(-1,0,0);break;case i.RIGHT:e.set(1,0,0);break;case i.FORWARD:e.set(0,0,-1);break;case i.BACKWARD:e.set(0,0,1)}this.invNormal=s.clone(e,new s).invert(),this.mass=1/0,this.inverseMass=0,this.type=8}var n=t("./Particle"),s=t("../../math/Vec3");i.DOWN=0,i.UP=1,i.LEFT=2,i.RIGHT=3,i.FORWARD=4,i.BACKWARD=5,i.prototype=Object.create(n.prototype),i.prototype.constructor=i,e.exports=i},{"../../math/Vec3":44,"./Particle":51}],54:[function(t,e){function i(t){function e(e){s.call(this,e);var i=t.polyhedralProperties.size,o=e.size||i,l=o[0]/i[0],h=o[1]/i[1],u=o[2]/i[2];this._scale=[l,h,u];var c=new a([l,0,0,0,h,0,0,0,u]);this.hull=t,this.vertices=[];for(var p=0,d=t.vertices.length;d>p;p++)this.vertices.push(c.vectorMultiply(t.vertices[p],new r));n.call(this,c),this.inverseInertia.copy(this.localInverseInertia),this.updateInertia();var m=e.angularVelocity;m&&this.setAngularVelocity(m.x,m.y,m.z)}if(!(t instanceof l)){if(!(t instanceof Array))throw new Error("convexBodyFactory requires a ConvexHull object or an array of Vec3's as input.");t=new l(t)}return e.prototype=Object.create(s.prototype),e.prototype.constructor=e,e.prototype.setSize=function(e,i,n){var s=t.polyhedralProperties.size;this.size[0]=e,this.size[1]=i,this.size[2]=n;var r=e/s[0],o=i/s[1],l=n/s[2];this._scale=[r,o,l];for(var h=new a([r,0,0,0,o,0,0,0,l]),u=this.vertices,c=0,p=t.vertices.length;p>c;c++)h.vectorMultiply(t.vertices[c],u[c]);return this},e.prototype.updateLocalInertia=function(){var t=this._scale[0],e=this._scale[1],i=this._scale[2],s=new a([t,0,0,0,e,0,0,0,i]);return n.call(this,s),this},e.prototype.support=function(t){for(var e,i,n,s=this.vertices,a=-(1/0),o=0,l=s.length;l>o;o++)e=s[o],i=r.dot(e,t),i>a&&(n=e,a=i);return n},e.prototype.updateShape=function(){for(var t=this.vertices,e=this.orientation,i=this.hull.vertices,n=this._scale[0],s=this._scale[1],a=this._scale[2],o=h,l=0,u=t.length;u>l;l++)o.copy(i[l]),o.x*=n,o.y*=s,o.z*=a,r.applyRotation(o,e,t[l]);return this},e}function n(t){var e=this.hull.polyhedralProperties,i=t.get(),n=i[0]*i[4]*i[8],s=e.eulerTensor,r=new a;a.multiply(t,s,r),a.multiply(r,t,r);var o=r.get(),l=o[0],h=o[4],u=o[8],c=o[1],p=o[7],d=o[2],m=e.volume*n,f=this.mass,g=f/m,y=h+u,_=l+u,v=l+h,S=-c,x=-p,b=-d,T=e.centroid;y-=m*(T.y*T.y+T.z*T.z),_-=m*(T.z*T.z+T.x*T.x),v-=m*(T.x*T.x+T.y*T.y),S+=m*T.x*T.y,x+=m*T.y*T.z,b+=m*T.z*T.x,y*=g*n,_*=g*n,v*=g*n,S*=g*n,x*=g*n,b*=g*n;var A=[y,S,b,S,_,x,b,x,v];this.localInertia.set(A),a.inverse(this.localInertia,this.localInverseInertia)}var s=t("./Particle"),a=t("../../math/Mat33"),r=t("../../math/Vec3"),o=t("../Geometry"),l=o.ConvexHull,h=new r;e.exports=i},{"../../math/Mat33":41,"../../math/Vec3":44,"../Geometry":48,"./Particle":51}],55:[function(t,e){function i(t,e,i){this.a=t,this.b=e,n.call(this,i),this.effectiveInertia=new a,this.angularImpulse=new s,this.error=0}var n=t("./Constraint"),s=t("../../math/Vec3"),a=t("../../math/Mat33"),r=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){this.cosAngle=this.cosAngle||this.a.orientation.dot(this.b.orientation)},i.prototype.update=function(){var t=this.a,e=this.b,i=t.orientation,n=e.orientation,s=i.dot(n),r=2*(s-this.cosAngle);this.error=r;var o=this.angularImpulse;e.applyAngularImpulse(o),t.applyAngularImpulse(o.invert()),a.add(t.inverseInertia,e.inverseInertia,this.effectiveInertia),this.effectiveInertia.inverse(),o.clear()},i.prototype.resolve=function(){var t=this.a,e=this.b,i=r,n=t.angularVelocity,a=e.angularVelocity;s.subtract(n,a,i),i.scale(1+this.error);var o=i.applyMatrix(this.effectiveInertia);e.applyAngularImpulse(o),t.applyAngularImpulse(o.invert()),o.invert(),this.angularImpulse.add(o)},e.exports=i},{"../../math/Mat33":41,"../../math/Vec3":44,"./Constraint":58}],56:[function(t,e){function i(t,e,i){this.a=t,this.b=e,n.call(this,i),this.impulse=new s,this.angImpulseA=new s,this.angImpulseB=new s,this.error=new s,this.effMassMatrix=new a}var n=t("./Constraint"),s=t("../../math/Vec3"),a=t("../../math/Mat33"),r=t("../../math/Quaternion"),o=new s,l=new s,h=new s,u=new s,c=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){var t=this.anchor,e=this.a,i=this.b,n=r.conjugate(e.orientation,new r),a=r.conjugate(i.orientation,new r);this.rA=s.subtract(t,e.position,new s),this.rB=s.subtract(t,i.position,new s),this.bodyRA=n.rotateVector(this.rA,new s),this.bodyRB=a.rotateVector(this.rB,new s)},i.prototype.update=function(t,e){var i=this.a,n=this.b,r=i.orientation.rotateVector(this.bodyRA,this.rA),o=n.orientation.rotateVector(this.bodyRB,this.rB),h=new a([0,r.z,-r.y,-r.z,0,r.x,r.y,-r.x,0]),u=new a([0,o.z,-o.y,-o.z,0,o.x,o.y,-o.x,0]),c=a.multiply(h,i.inverseInertia,new a).multiply(h.transpose()),p=a.multiply(u,n.inverseInertia,new a).multiply(u.transpose()),d=a.add(c,p,c),m=s.add(i.position,this.rA,this.anchor),f=s.add(n.position,this.rB,l);s.subtract(f,m,this.error),this.error.scale(.2/e);var g=i.inverseMass,y=n.inverseMass,_=new a([g+y,0,0,0,g+y,0,0,0,g+y]);a.add(d,_,this.effMassMatrix),this.effMassMatrix.inverse();var v=this.impulse,S=this.angImpulseA,x=this.angImpulseB;n.applyImpulse(v),n.applyAngularImpulse(x),v.invert(),i.applyImpulse(v),i.applyAngularImpulse(S),v.clear(),S.clear(),x.clear()},i.prototype.resolve=function(){var t=this.a,e=this.b,i=this.rA,n=this.rB,a=s.add(t.velocity,s.cross(t.angularVelocity,i,c),h),r=s.add(e.velocity,s.cross(e.angularVelocity,n,c),u),p=a.subtract(r).subtract(this.error).applyMatrix(this.effMassMatrix),d=s.cross(n,p,o),m=s.cross(i,p,l).invert();e.applyImpulse(p),e.applyAngularImpulse(d),p.invert(),t.applyImpulse(p),t.applyAngularImpulse(m),p.invert(),this.impulse.add(p),this.angImpulseA.add(m),this.angImpulseB.add(d)},e.exports=i},{"../../math/Mat33":41,"../../math/Quaternion":42,"../../math/Vec3":44,"./Constraint":58}],57:[function(t,e){function i(t,e,i){return e>t?e:t>i?i:t}function n(t,e,i,n,s,a){this.penetration=t,this.normal=e,this.worldContactA=i,this.worldContactB=n,this.localContactA=s,this.localContactB=a}function s(t,e){this.targets=[],t&&(this.targets=this.targets.concat(t)),u.call(this,e)}function a(t,e,i){var n=e.position,s=i.position,a=h.subtract(s,n,new h),r=a.length(),o=e.radius+i.radius,l=a.scale(1/r),u=o-r;if(!(0>u)){var c=h.scale(l,e.radius,new h),p=h.scale(l,-i.radius,new h),d=h.add(n,c,new h),m=h.add(s,p,new h),f=_().reset(u,l,d,m,c,p);t.contactManifoldTable.registerContact(e,i,f)}}function r(t,e,n){if(e.type===b){var s=n;n=e,e=s}var a=e.position,r=n.position,o=h.subtract(r,a,v),l=e.orientation,u=n.radius,c=e.size,p=.5*c[0],d=.5*c[1],m=.5*c[2],f=e.normals,g=l.rotateVector(f[1],new h),y=l.rotateVector(f[0],new h),S=l.rotateVector(f[2],new h),x=new h;x.x=i(h.dot(o,g),-p,p),x.y=i(h.dot(o,y),-d,d),x.z=i(h.dot(o,S),-m,m),x.applyRotation(l);var T=h.add(a,x,new h),A=h.subtract(T,r,T),w=A.length(),C=u-w;if(!(0>C)){var z=h.scale(A,-1/w,new h),E=x,R=A,O=h.add(a,E,new h),P=h.add(r,R,new h),I=_().reset(C,z,O,P,E,R);t.contactManifoldTable.registerContact(e,n,I)}}function o(t,e,i){var n=m(e,i);if(n){var s=f(e,i,n);null!==s&&t.contactManifoldTable.registerContact(e,i,s)}}function l(t,e,i){if(e.type===T){var n=i;i=e,e=n}var s=e.position,a=i.position,r=i.normal,o=i.invNormal,l=e.support(o),u=h.add(s,l,new h),c=h.subtract(u,a,v),p=h.dot(c,o);if(!(0>p)){var d=h.scale(r,p,new h).add(u),m=h.subtract(d,i.position,new h),f=_().reset(p,o,u,d,l,m);t.contactManifoldTable.registerContact(e,i,f)}}var h=t("../../math/Vec3"),u=t("./Constraint"),c=t("./collision/SweepAndPrune"),p=t("./collision/BruteForce"),d=t("./collision/ConvexCollisionDetection"),m=d.gjk,f=d.epa,g=t("./collision/ContactManifold"),y=t("../../utilities/ObjectManager");y.register("CollisionData",n);var _=y.requestCollisionData,v=new h;n.prototype.reset=function(t,e,i,n,s,a){return this.penetration=t,this.normal=e,this.worldContactA=i,this.worldContactB=n,this.localContactA=s,this.localContactB=a,this},s.prototype=Object.create(u.prototype),s.prototype.constructor=s,s.prototype.init=function(){if(this.broadPhase){var t=this.broadphase;t instanceof Function&&(this.broadPhase=new t(this.targets))}else this.broadPhase=new c(this.targets);this.contactManifoldTable=this.contactManifoldTable||new g},s.prototype.update=function(t,e){if(this.contactManifoldTable.update(e),0!==this.targets.length){var i,n;for(i=0,n=this.targets.length;n>i;i++)this.targets[i].updateShape();var s,a=this.broadPhase.update();for(i=0,n=a.length;n>i;i++)s=a[i],s&&this.applyNarrowPhase(s);this.contactManifoldTable.prepContacts(e)}},s.prototype.resolve=function(t,e){this.contactManifoldTable.resolveManifolds(e)},s.prototype.addTarget=function(t){this.targets.push(t),this.broadPhase.add(t)},s.prototype.removeTarget=function(t){var e=this.targets.indexOf(t);0>e||(this.targets.splice(e,1),this.broadPhase.remove(t))};var S=1,x=2,b=4,T=8,A=S|S,w=x|x,C=x|S,z=b|b,E=x|b,R=S|b,O=S|T,P=x|T,I=b|T,M={};M[A]=o,M[w]=o,M[C]=o,M[R]=o,M[z]=a,M[E]=r,M[O]=l,M[P]=l,M[I]=l,s.prototype.applyNarrowPhase=function(t){for(var e=0,i=t.length;i>e;e++)for(var n=e+1;i>n;n++){var s=t[e],a=t[n];if(0!==(s.collisionMask&a.collisionGroup&&s.collisionGroup&a.collisionMask)){var r=s.type|a.type;M[r]&&M[r](this,s,a)}}},s.SweepAndPrune=c,s.BruteForce=p.BruteForce,s.BruteForceAABB=p.BruteForceAABB,e.exports=s},{"../../math/Vec3":44,"../../utilities/ObjectManager":93,"./Constraint":58,"./collision/BruteForce":64,"./collision/ContactManifold":65,"./collision/ConvexCollisionDetection":66,"./collision/SweepAndPrune":67}],58:[function(t,e){function i(t){t=t||{},this.setOptions(t),this._ID=n++}var n=0;i.prototype.setOptions=function(t){for(var e in t)this[e]=t[e];this.init(t)},i.prototype.init=function(){},i.prototype.update=function(){},i.prototype.resolve=function(){},e.exports=i},{}],59:[function(t,e){function i(t,e){this.targets=t?t instanceof Array?t:[t]:[],n.call(this,e),this.impulses={},this.normals={},this.velocityBiases={},this.divisors={}}var n=t("./Constraint"),s=t("../../math/Vec3"),a=new s,r=new s,o=1e-7,l=Math.PI;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){this.equation1=this.equation1||function(){return 0},this.equation2=this.equation2||function(t,e,i){return i},this.period=this.period||1,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*l*l/(this.period*this.period),this.damping=4*l*this.dampingRatio/this.period},i.prototype.update=function(t,e){for(var i=this.targets,n=this.normals,l=this.velocityBiases,h=this.divisors,u=this.impulses,c=a,p=r,d=this.equation1,m=this.equation2,f=this.damping,g=this.stiffness,y=0,_=i.length;_>y;y++){var v=i[y],S=v._ID;if(!v.immune){var x,b,T=v.position,A=v.mass;if(0===this.period)x=0,b=1;else{var w=f*A,C=g*A;x=1/(e*(w+e*C)),b=e*C/(w+e*C)}var z=T.x,E=T.y,R=T.z,O=d(z,E,R),P=(d(z+o,E,R)-O)/o,I=(d(z,E+o,R)-O)/o,M=(d(z,E,R+o)-O)/o,L=m(z,E,R),X=(m(z+o,E,R)-L)/o,D=(m(z,E+o,R)-L)/o,Y=(m(z,E,R+o)-L)/o;p.set(P+X,I+D,M+Y),p.normalize();var k=b*(O+L)/e,F=x+1/A,U=u[S]||0;s.scale(p,U,c),v.applyImpulse(c),n[S]=n[S]||new s,n[S].copy(p),l[S]=k,h[S]=F,u[S]=0}}},i.prototype.resolve=function(){for(var t=this.targets,e=this.normals,i=this.velocityBiases,n=this.divisors,r=this.impulses,o=a,l=0,h=t.length;h>l;l++){var u=t[l],c=u._ID;if(!u.immune){var p=u.velocity,d=e[c],m=-(s.dot(d,p)+i[c])/n[c];s.scale(d,m,o),u.applyImpulse(o),r[c]+=m}}},e.exports=i},{"../../math/Vec3":44,"./Constraint":58}],60:[function(t,e){function i(t,e,i){this.a=t,this.b=e,n.call(this,i),this.impulse=0,this.distance=0,this.normal=new s,this.velocityBias=0,this.divisor=0}var n=t("./Constraint"),s=t("../../math/Vec3"),a=new s,r=new s,o=new s,l=new s,h=new s,u=Math.PI;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){this.direction=this.direction||s.subtract(this.b.position,this.a.position,new s),this.direction.normalize(),this.minLength=this.minLength||0,this.period=this.period||.2,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*u*u/(this.period*this.period),this.damping=4*u*this.dampingRatio/this.period},i.prototype.update=function(t,e){var i=this.a,n=this.b,o=a,u=l,c=r,p=h,d=i.position,m=i.inverseMass,f=n.position,g=n.inverseMass,y=this.direction;s.subtract(f,d,u),s.scale(y,s.dot(y,u),p);var _=p.add(d);s.subtract(f,_,o);var v=o.length();o.normalize();var S,x,b=m+g,T=1/b;if(0===this.period)S=0,x=1;else{var A=this.damping*T,w=this.stiffness*T;S=1/(e*(A+e*w)),x=e*w/(A+e*w)}var C=x*v/e,z=S+b,E=this.impulse;s.scale(o,E,c),n.applyImpulse(c),i.applyImpulse(c.invert()),this.normal.copy(o),this.distance=v,this.velocityBias=C,this.divisor=z,this.impulse=0},i.prototype.resolve=function(){var t=this.a,e=this.b,i=r,n=o,a=this.minLength,l=this.distance;if(!(Math.abs(l)<a)){var h=t.velocity,u=e.velocity,c=this.normal;s.subtract(u,h,n);var p=-(s.dot(c,n)+this.velocityBias)/this.divisor;s.scale(c,p,i),e.applyImpulse(i),t.applyImpulse(i.invert()),this.impulse+=p}},e.exports=i},{"../../math/Vec3":44,"./Constraint":58}],61:[function(t,e){function i(t,e,i){this.a=t,this.b=e,n.call(this,i),this.impulse=0,this.distance=0,this.normal=new s,this.velocityBias=0,this.divisor=0}var n=t("./Constraint"),s=t("../../math/Vec3"),a=new s,r=new s,o=new s,l=new s,h=Math.PI;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){this.length=this.length||s.subtract(this.b.position,this.a.position,l).length(),this.minLength=this.minLength||0,this.period=this.period||.2,this.dampingRatio=this.dampingRatio||.5,this.stiffness=4*h*h/(this.period*this.period),this.damping=4*h*this.dampingRatio/this.period},i.prototype.update=function(t,e){var i=this.a,n=this.b,o=a,h=l,u=r,c=this.length,p=i.position,d=i.inverseMass,m=n.position,f=n.inverseMass;s.subtract(m,p,h);var g=h.length();s.scale(h,1/g,o);var y,_,v=g-c,S=d+f,x=1/S;if(0===this.period)y=0,_=1;else{var b=this.damping*x,T=this.stiffness*x;y=1/(e*(b+e*T)),_=e*T/(b+e*T)}var A=_*v/e,w=y+S,C=this.impulse;s.scale(o,C,u),n.applyImpulse(u),i.applyImpulse(u.invert()),this.normal.copy(o),this.distance=v,this.velocityBias=A,this.divisor=w,this.impulse=0},i.prototype.resolve=function(){var t=this.a,e=this.b,i=r,n=o,a=this.minLength,l=this.distance;if(!(Math.abs(l)<a)){var h=t.getVelocity(),u=e.getVelocity(),c=this.normal;s.subtract(u,h,n);var p=-(s.dot(c,n)+this.velocityBias)/this.divisor;s.scale(c,p,i),e.applyImpulse(i),t.applyImpulse(i.invert()),this.impulse+=p}},e.exports=i},{"../../math/Vec3":44,"./Constraint":58}],62:[function(t,e){function i(t,e,i){this.a=t,this.b=e,n.call(this,i),this.impulse=new s,this.angImpulseA=new s,this.angImpulseB=new s,this.error=new s,this.errorRot=[0,0],this.effMassMatrix=new a,this.effMassMatrixRot=[]}var n=t("./Constraint"),s=t("../../math/Vec3"),a=t("../../math/Mat33"),r=t("../../math/Quaternion"),o=new s,l=new s,h=new s,u=new s,c=new s,p=new s,d=new s,m=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){var t=this.anchor,e=this.axis.normalize(),i=this.a,n=this.b,a=r.conjugate(i.orientation,new r),o=r.conjugate(n.orientation,new r);this.rA=s.subtract(t,i.position,new s),this.rB=s.subtract(t,n.position,new s),this.bodyRA=a.rotateVector(this.rA,new s),this.bodyRB=o.rotateVector(this.rB,new s),this.axisA=s.clone(e),this.axisB=s.clone(e),this.axisBTangent1=new s,this.axisBTangent2=new s,this.t1xA=new s,this.t2xA=new s,this.bodyAxisA=a.rotateVector(e,new s),this.bodyAxisB=o.rotateVector(e,new s)},i.prototype.update=function(t,e){var i=this.a,n=this.b,r=i.orientation.rotateVector(this.bodyAxisA,this.axisA),c=n.orientation.rotateVector(this.bodyAxisB,this.axisB);this.axis.copy(c);var p=c,d=this.axisBTangent1,m=this.axisBTangent2;p.x>=.57735?d.set(p.y,-p.x,0):d.set(0,p.z,-p.y),d.normalize(),s.cross(p,d,m);var f=s.cross(d,r,this.t1xA),g=s.cross(m,r,this.t2xA),y=i.orientation.rotateVector(this.bodyRA,this.rA),_=n.orientation.rotateVector(this.bodyRB,this.rB),v=new a([0,y.z,-y.y,-y.z,0,y.x,y.y,-y.x,0]),S=new a([0,_.z,-_.y,-_.z,0,_.x,_.y,-_.x,0]),x=a.multiply(v,i.inverseInertia,new a).multiply(v.transpose()),b=a.multiply(S,n.inverseInertia,new a).multiply(S.transpose()),T=a.add(x,b,x),A=s.add(i.position,this.rA,this.anchor),w=s.add(n.position,this.rB,o),C=1/e;s.subtract(w,A,this.error),this.error.scale(.2*C);var z=i.inverseMass,E=n.inverseMass,R=new a([z+E,0,0,0,z+E,0,0,0,z+E]);a.add(T,R,this.effMassMatrix),this.effMassMatrix.inverse();var O=i.inverseInertia.vectorMultiply(f,o),P=i.inverseInertia.vectorMultiply(g,l),I=n.inverseInertia.vectorMultiply(f,h),M=n.inverseInertia.vectorMultiply(g,u),L=s.dot(f,O)+s.dot(f,I),X=s.dot(f,P)+s.dot(f,M),D=s.dot(g,O)+s.dot(g,I),Y=s.dot(g,P)+s.dot(g,M),k=1/(L*Y-X*D);this.effMassMatrixRot[0]=Y*k,this.effMassMatrixRot[1]=-D*k,this.effMassMatrixRot[2]=-X*k,this.effMassMatrixRot[3]=L*k,this.errorRot[0]=.2*s.dot(r,d)*C,this.errorRot[1]=.2*s.dot(r,m)*C;var F=this.impulse.scale(.5),U=this.angImpulseA.scale(.5),j=this.angImpulseB.scale(.5);n.applyImpulse(F),n.applyAngularImpulse(j),F.invert(),i.applyImpulse(F),i.applyAngularImpulse(U),F.clear(),U.clear(),j.clear()},i.prototype.resolve=function(){var t=this.a,e=this.b,i=this.rA,n=this.rB,a=this.t1xA,r=this.t2xA,f=t.angularVelocity,g=e.angularVelocity,y=s.add(t.velocity,s.cross(f,i,d),c),_=s.add(e.velocity,s.cross(g,n,d),p),v=y.subtract(_).subtract(this.error).applyMatrix(this.effMassMatrix),S=s.subtract(g,f,m),x=this.errorRot,b=s.dot(a,S)+x[0],T=s.dot(r,S)+x[1],A=this.effMassMatrixRot,w=-(A[0]*b+A[1]*T),C=-(A[2]*b+A[3]*T),z=s.scale(a,w,l).add(s.scale(r,C,h)),E=s.cross(n,v,o).add(z),R=s.cross(i,v,u).invert().subtract(z);e.applyImpulse(v),e.applyAngularImpulse(E),v.invert(),t.applyImpulse(v),t.applyAngularImpulse(R),v.invert(),this.impulse.add(v),this.angImpulseA.add(R),this.angImpulseB.add(E)},e.exports=i},{"../../math/Mat33":41,"../../math/Quaternion":42,"../../math/Vec3":44,"./Constraint":58}],63:[function(t,e){function i(t){this._body=t,this._ID=t._ID,this.position=null,this.vertices={x:[],y:[],z:[]},this.update()}var n=4,s=8,a=0,r=1,o=2,l=3,h=4,u=5;i.prototype.update=function(){var t=this._body,e=this.position=t.position,i=1/0,c=-(1/0),p=1/0,d=-(1/0),m=1/0,f=-(1/0),g=t.type;if(g===n)c=d=f=t.radius,i=p=m=-t.radius;else if(g===s){var y=t.direction;switch(c=d=f=1e6,i=p=m=-1e6,y){case a:d=25,p=-1e3;break;case r:d=1e3,p=-25;break;case o:c=25,i=-1e3;break;case l:c=1e3,i=-25;break;case h:f=25,m=-1e3;break;case u:f=1e3,m=-25}}else if(t.vertices)for(var _=t.vertices,v=0,S=_.length;S>v;v++){var x=_[v];x.x<i&&(i=x.x),x.x>c&&(c=x.x),x.y<p&&(p=x.y),x.y>d&&(d=x.y),x.z<m&&(m=x.z),x.z>f&&(f=x.z)}else c=d=f=25,i=p=m=-25;var b=this.vertices;b.x[0]=i+e.x,b.x[1]=c+e.x,b.y[0]=p+e.y,b.y[1]=d+e.y,b.z[0]=m+e.z,b.z[1]=f+e.z},i.checkOverlap=function(t,e){var i=t.vertices,n=e.vertices,s=i.x[0],a=i.x[1],r=n.x[0],o=n.x[1];if(s>=r&&o>=s||r>=s&&a>=r){var l=i.y[0],h=i.y[1],u=n.y[0],c=n.y[1];if(l>=u&&c>=l||u>=l&&h>=u){var p=i.z[0],d=i.z[1],m=n.z[0],f=n.z[1];if(p>=m&&f>=p||m>=p&&d>=m)return!0}}return!1},i.vertexThreshold=100,e.exports=i},{}],64:[function(t,e){function i(t){this._volumes=[],this._entityRegistry={};for(var e=0;e<t.length;e++)this.add(t[e])}function n(t){this.targets=t}var s=t("./AABB");i.prototype.add=function(t){var e=new s(t);this._entityRegistry[t._ID]=t,this._volumes.push(e)},i.prototype.update=function(){for(var t=this._volumes,e=this._entityRegistry,i=0,n=t.length;n>i;i++)t[i].update();for(var a=[],r=0,o=t.length;o>r;r++)for(var l=r+1;o>l;l++)s.checkOverlap(t[r],t[l])&&a.push([e[r],e[l]]);return a},n.prototype.add=function(t){this.targets.push(t)},n.prototype.update=function(){return[this.targets]},e.exports.BruteForceAABB=i,e.exports.BruteForce=n},{"./AABB":63}],65:[function(t,e){function i(t,e,i){return e>t?e:t>i?i:t}function n(){this.manifolds=[],this.collisionMatrix={},this._IDPool=[]}function s(t,e,i,n){this.lowID=t,this.highID=e,this.contacts=[],this.numContacts=0,this.bodyA=i,this.bodyB=n,this.lru=0}function a(t,e,i){this.bodyA=t,this.bodyB=e,this.data=i,this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,this.impulse=new r,this.angImpulseA=new r,this.angImpulseB=new r,i&&this.init()}var r=t("../../../math/Vec3"),o=t("../../../utilities/ObjectManager");o.register("Manifold",s),o.register("Contact",a);var l=o.requestManifold,h=o.requestContact,u=o.freeManifold,c=o.freeContact,p=new r,d=new r,m=new r,f=new r,g=new r,y=new r,_=new r,v=new r,S=new r,x=new r,b=new r,T=new r,A=new r,w=new r,C=new r;n.prototype.addManifold=function(t,e,i,n){var s=this.collisionMatrix;s[t]=s[t]||{};var a=this._IDPool.length?this._IDPool.pop():this.manifolds.length;this.collisionMatrix[t][e]=a;var r=l().reset(t,e,i,n);return this.manifolds[a]=r,r},n.prototype.removeManifold=function(t,e){var i=this.collisionMatrix;this.manifolds[e]=null,i[t.lowID][t.highID]=null,this._IDPool.push(e),u(t)},n.prototype.update=function(t){for(var e=this.manifolds,i=0,n=e.length;n>i;i++){var s=e[i];if(s){var a=s.update(t);a||(this.removeManifold(s,i),s.bodyA.events.trigger("collision:end",s),s.bodyB.events.trigger("collision:end",s))}}},n.prototype.prepContacts=function(t){for(var e=this.manifolds,i=0,n=e.length;n>i;i++){var s=e[i];if(s)for(var a=s.contacts,r=0,o=a.length;o>r;r++){var l=a[r];l&&l.update(t)}}},n.prototype.resolveManifolds=function(){for(var t=this.manifolds,e=0,i=t.length;i>e;e++){var n=t[e];n&&n.resolveContacts()}},n.prototype.registerContact=function(t,e,i){var n,s;t._ID<e._ID?(n=t._ID,s=e._ID):(n=e._ID,s=t._ID);var a,r=this.manifolds,o=this.collisionMatrix;o[n]&&null!=o[n][s]?(a=r[o[n][s]],a.contains(i),a.addContact(t,e,i)):(a=this.addManifold(n,s,t,e),a.addContact(t,e,i),t.events.trigger("collision:start",a),e.events.trigger("collision:start",a))};var z=10;s.prototype.reset=function(t,e,i,n){return this.lowID=t,this.highID=e,this.contacts=[],this.numContacts=0,this.bodyA=i,this.bodyB=n,this.lru=0,this},s.prototype.addContact=function(t,e,i){var n=this.lru;this.contacts[n]&&this.removeContact(this.contacts[n],n),this.contacts[n]=h().reset(t,e,i),this.lru=(this.lru+1)%4,this.numContacts++},s.prototype.removeContact=function(t,e){this.contacts[e]=null,this.numContacts--,o.freeCollisionData(t.data),t.data=null,c(t)},s.prototype.contains=function(t){for(var e=t.worldContactA,i=t.worldContactB,n=this.contacts,s=0,a=n.length;a>s;s++){var o=n[s];if(o){var l=o.data,h=r.subtract(l.worldContactA,e,w).length(),u=r.subtract(l.worldContactB,i,C).length();if(z>h||z>u)return this.removeContact(o,s),!0}}return!1},s.prototype.update=function(){for(var t=this.contacts,e=this.bodyA,i=this.bodyB,n=e.position,s=i.position,a=0,o=t.length;o>a;a++){var l=t[a];if(l){var h=l.data,u=h.normal,c=h.localContactA,p=h.localContactB,d=h.worldContactA,m=h.worldContactB,f=r.add(n,c,b),g=r.add(s,p,T),y=r.dot(r.subtract(g,f,A),u)>0,_=r.subtract(d,f,w),v=r.subtract(m,g,C);(_.length()>=z||v.length()>=z||y)&&this.removeContact(l,a)}}return this.numContacts?!0:!1},s.prototype.resolveContacts=function(){for(var t=this.contacts,e=0,i=t.length;i>e;e++)t[e]&&t[e].resolve()},a.prototype.reset=function(t,e,i){return this.bodyA=t,this.bodyB=e,this.data=i,this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,this.impulse.clear(),this.angImpulseA.clear(),this.angImpulseB.clear(),this.init(),this},a.prototype.init=function(){var t=this.data,e=t.normal,i=new r;e.x>=.57735?i.set(e.y,-e.x,0):i.set(0,e.z,-e.y),i.normalize();var n=r.cross(e,i,new r);this.tangent1=i,this.tangent2=n;var s=this.bodyA,a=this.bodyB,o=t.localContactA,l=t.localContactB,h=s.inverseMass+a.inverseMass,u=r.cross(o,e,y),c=r.cross(l,e,_);this.effNormalMass=1/(h+r.dot(u,s.inverseInertia.vectorMultiply(u,p))+r.dot(c,a.inverseInertia.vectorMultiply(c,p)));var d=r.cross(o,i,y),m=r.cross(l,i,_);this.effTangentialMass1=1/(h+r.dot(d,s.inverseInertia.vectorMultiply(d,p))+r.dot(m,a.inverseInertia.vectorMultiply(m,p)));var f=r.cross(o,n,y),g=r.cross(l,n,_);this.effTangentialMass2=1/(h+r.dot(f,s.inverseInertia.vectorMultiply(f,p))+r.dot(g,a.inverseInertia.vectorMultiply(g,p))),this.restitution=Math.min(s.restitution,a.restitution),this.friction=s.friction*a.friction},a.prototype.update=function(t){var e=this.data,i=this.bodyA,n=this.bodyB,s=e.localContactA,a=e.localContactB,o=e.normal,l=r.add(i.velocity,r.cross(i.angularVelocity,s,g),m),h=r.add(n.velocity,r.cross(n.angularVelocity,a,g),f),u=h.subtract(l),c=r.dot(u,o),p=.15,d=1.5,y=20,_=Math.abs(c)<y?0:this.restitution;this.velocityBias=-p*Math.max(e.penetration-d,0)/t,this.velocityBias+=_*c;var v=this.impulse.scale(.25),S=this.angImpulseA.scale(.25),x=this.angImpulseB.scale(.25);n.applyImpulse(v),n.applyAngularImpulse(x),v.invert(),i.applyImpulse(v),i.applyAngularImpulse(S),this.normalImpulse=0,this.tangentImpulse1=0,this.tangentImpulse2=0,v.clear(),S.clear(),x.clear()},a.prototype.resolve=function(){var t=this.data,e=this.bodyA,n=this.bodyB,s=t.localContactA,a=t.localContactB,o=t.normal,l=this.tangent1,h=this.tangent2,u=r.add(e.velocity,r.cross(e.angularVelocity,s,g),m),c=r.add(n.velocity,r.cross(n.angularVelocity,a,g),f),y=c.subtract(u),_=-(r.dot(y,o)+this.velocityBias)*this.effNormalMass,b=Math.max(this.normalImpulse+_,0);_=b-this.normalImpulse;var T=this.friction*b,A=-r.dot(y,l)*this.effTangentialMass1,w=i(this.tangentImpulse1+A,-T,T);A=w-this.tangentImpulse1;var C=-r.dot(y,h)*this.effTangentialMass2,z=i(this.tangentImpulse2+C,-T,T);C=z-this.tangentImpulse2;var E=r.scale(o,_,v),R=r.scale(l,A,S),O=r.scale(h,C,x);E.add(R).add(O);var P=r.cross(a,E,p),I=r.cross(s,E,d).invert();n.applyImpulse(E),n.applyAngularImpulse(P),E.invert(),e.applyImpulse(E),e.applyAngularImpulse(I),this.normalImpulse=b,this.tangentImpulse1=w,this.tangentImpulse2=z,this.impulse.add(E),this.angImpulseA.add(I),this.angImpulseB.add(P)},e.exports=n},{"../../../math/Vec3":44,"../../../utilities/ObjectManager":93}],66:[function(t,e){function i(t,e,i){this.vertex=t,this.worldVertexA=e,this.worldVertexB=i}function n(t){var e,i=t.vertices;for(e=i.length;e--;){var n=i.pop();null!==n&&c(n)}t.numVertices=0;var s=t.features;for(e=s.length;e--;){var a=s.pop();null!==a&&d(a)}t.numFeatures=0,p(t)}function s(t,e,i){var n=o.scale(i,-1,v),s=o.add(t.support(i),t.position,new o),a=o.add(e.support(n),e.position,new o);return h().reset(o.subtract(s,a,new o),s,a)}function a(t,e){var i=s,a=o.subtract(e.position,t.position,_).normalize(),r=u();r.addVertex(i(t,e,a)),a.invert();for(var l=0,h=1e3;l++<h&&(0!==a.x||0!==a.y||0!==a.z)&&(r.addVertex(i(t,e,a)),!(o.dot(r.getLastVertex().vertex,a)<0));)if(r.simplexContainsOrigin(a,c))return r;return n(r),!1}function r(t,e,i){for(var a=s,r=1/0,h=0,u=1e3;h++<u;){var p=i.getFeatureClosestToOrigin();if(null===p)return null;var d=p.normal,_=a(t,e,d);if(r=Math.min(r,o.dot(_.vertex,d)),r-p.distance<=.01){var v=i.vertices[p.vertexIndices[0]],S=i.vertices[p.vertexIndices[1]],x=i.vertices[p.vertexIndices[2]],b=v.vertex,T=S.vertex,A=x.vertex,w=o.scale(d,p.distance,m),C=o.subtract(T,b,f),z=o.subtract(A,b,g),E=o.subtract(w,b,y),R=o.dot(C,C),O=o.dot(C,z),P=o.dot(z,z),I=o.dot(E,C),M=o.dot(E,z),L=R*P-O*O,X=(P*I-O*M)/L,D=(R*M-O*I)/L,Y=1-X-D,k=v.worldVertexA.scale(Y).add(S.worldVertexA.scale(X)).add(x.worldVertexA.scale(D)),F=v.worldVertexB.scale(Y).add(S.worldVertexB.scale(X)).add(x.worldVertexB.scale(D)),U=o.subtract(k,t.position,new o),j=o.subtract(F,e.position,new o);return n(i),c(_),l.requestCollisionData().reset(p.distance,d,k,F,U,j)}i.addVertex(_),i.reshape()}throw new Error("EPA failed to terminate in allotted iterations.")}var o=t("../../../math/Vec3"),l=t("../../../utilities/ObjectManager");l.register("GJK_EPASupportPoint",i);var h=l.requestGJK_EPASupportPoint,u=l.requestDynamicGeometry,c=l.freeGJK_EPASupportPoint,p=l.freeDynamicGeometry,d=l.freeDynamicGeometryFeature,m=new o,f=new o,g=new o,y=new o,_=new o,v=new o;i.prototype.reset=function(t,e,i){return this.vertex=t,this.worldVertexA=e,this.worldVertexB=i,this},e.exports.gjk=a,e.exports.epa=r},{"../../../math/Vec3":44,"../../../utilities/ObjectManager":93}],67:[function(t,e){function i(t){this._sweepVolumes=[],this._entityRegistry={},this._boundingVolumeRegistry={},this.endpoints={x:[],y:[],z:[]},this.overlaps=[],this.overlapsMatrix={},this._IDPool=[],t=t||[];for(var e=0;e<t.length;e++)this.add(t[e])}function n(t){this._boundingVolume=t,this._ID=t._ID,this.points={x:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}],y:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}],z:[{_ID:t._ID,side:0,value:null},{_ID:t._ID,side:1,value:null}]},this.update()}var s=t("./AABB"),a=["x","y","z"];i.prototype.add=function(t){var e=new s(t),i=new n(e);this._entityRegistry[t._ID]=t,this._boundingVolumeRegistry[t._ID]=e,this._sweepVolumes.push(i);for(var r=0;3>r;r++){var o=a[r];this.endpoints[o].push(i.points[o][0]),this.endpoints[o].push(i.points[o][1])}},i.prototype.remove=function(t){this._entityRegistry[t._ID]=null,this._boundingVolumeRegistry[t._ID]=null;var e,i,n;for(e=0,i=this._sweepVolumes.length;i>e;e++)if(this._sweepVolumes[e]._ID===t._ID){n=e;break}this._sweepVolumes.splice(n,1);var s,a=this.endpoints,r=[];for(e=0,i=a.x.length;i>e;e++)s=a.x[e],s._ID!==t._ID&&r.push(s);var o=[];for(e=0,i=a.y.length;i>e;e++)s=a.y[e],s._ID!==t._ID&&o.push(s);var l=[];for(e=0,i=a.z.length;i>e;e++)s=a.z[e],s._ID!==t._ID&&l.push(s);a.x=r,a.y=o,a.z=l},i.prototype.update=function(){var t,e,i,n,r=this._sweepVolumes,o=this._entityRegistry,l=this._boundingVolumeRegistry;for(e=0,n=r.length;n>e;e++)r[e].update();var h=this.endpoints,u=this.overlaps,c=this.overlapsMatrix,p=this._IDPool;
for(i=0;3>i;i++){var d=a[i],m=h[d];for(e=1,n=m.length;n>e;e++){var f,g,y,_,v,S,x,b=m[e],T=b.value;for(t=e-1;t>=0&&(f=m[t]).value>T;)S=b._ID,x=f._ID,x>S?(_=S,v=x):(_=x,v=S),~b.side&f.side?s.checkOverlap(l[S],l[x])&&(g=c[_]=c[_]||{},y=g[v]=p.length?p.pop():u.length,u[y]=[o[_],o[v]]):b.side&~f.side&&(g=c[_])&&null!=g[v]&&(y=g[v],u[y]=null,g[v]=null,p.push(y)),m[t+1]=f,t--;m[t+1]=b}}return u},n.prototype.update=function(){var t=this._boundingVolume;t.update();for(var e=this.points,i=0;3>i;i++){var n=a[i];e[n][0].value=t.vertices[n][0],e[n][1].value=t.vertices[n][1]}},e.exports=i},{"./AABB":63}],68:[function(t,e){function i(t,e){n.call(this,t,e)}var n=t("./Force"),s=t("../../math/Vec3"),a=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.QUADRATIC=function(t){return t*t},i.LINEAR=function(t){return t},i.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||1,this.type=this.type||i.LINEAR},i.prototype.update=function(){for(var t=this.targets,e=this.type,i=a,n=this.max,r=this.strength,o=0,l=t.length;l>o;o++){var h=t[o],u=h.velocity,c=u.length(),p=c?1/c:0,d=-r*e(c);s.scale(u,(-n>d?-n:d)*p,i),h.applyForce(i)}},e.exports=i},{"../../math/Vec3":44,"./Force":69}],69:[function(t,e){function i(t,e){this.targets=t?t instanceof Array?t:[t]:[],e=e||{},this.setOptions(e),this._ID=n++}var n=0;i.prototype.setOptions=function(t){for(var e in t)this[e]=t[e];this.init(t)},i.prototype.addTarget=function(t){this.targets.push(t)},i.prototype.removeTarget=function(t){var e=this.targets.indexOf(t);0>e||this.targets.splice(e,1)},i.prototype.init=function(){},i.prototype.update=function(){},e.exports=i},{}],70:[function(t,e){function i(t,e){n.call(this,t,e)}var n=t("./Force"),s=t("../../math/Vec3"),a=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.DOWN=0,i.UP=1,i.LEFT=2,i.RIGHT=3,i.FORWARD=4,i.BACKWARD=5,i.prototype.init=function(t){if(this.max=this.max||1/0,t.acceleration)return this.strength=this.acceleration.length(),void(this.direction=-1);var e=this.acceleration=new s,n=this.direction=this.direction||i.DOWN,a=this.strength=this.strength||200;switch(n){case i.DOWN:e.set(0,a,0);break;case i.UP:e.set(0,-1*a,0);break;case i.LEFT:e.set(-1*a,0,0);break;case i.RIGHT:e.set(a,0,0);break;case i.FORWARD:e.set(0,0,-1*a);break;case i.BACKWARD:e.set(0,0,a)}},i.prototype.update=function(){for(var t=this.targets,e=a,i=this.max,n=this.acceleration,r=n.length(),o=r?1/r:0,l=0,h=t.length;h>l;l++){var u=t[l],c=r*u.mass;s.scale(n,(c>i?i:c)*o,e),u.applyForce(e)}},e.exports=i},{"../../math/Vec3":44,"./Force":69}],71:[function(t,e){function i(t,e,i){this.source=t||null,n.call(this,e,i)}var n=t("./Force"),s=t("../../math/Vec3"),a=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||200},i.prototype.update=function(){for(var t=this.source,e=this.targets,i=a,n=this.strength,r=this.max,o=this.anchor||t.position,l=this.anchor?1:t.mass,h=0,u=e.length;u>h;h++){var c=e[h];s.subtract(o,c.position,i);var p=i.length(),d=p?1/p:0,m=n*l*c.mass*d*d;m=0>m?-r>m?-r:m:m>r?r:m,i.scale(m*d),c.applyForce(i),t&&t.applyForce(i.invert())}},e.exports=i},{"../../math/Vec3":44,"./Force":69}],72:[function(t,e){function i(t,e){n.call(this,t,e)}var n=t("./Force"),s=t("../../math/Vec3"),a=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.QUADRATIC=function(t){return t.length()},i.LINEAR=function(){return 1},i.prototype.init=function(){this.max=this.max||1/0,this.strength=this.strength||1,this.type=this.type||i.LINEAR},i.prototype.update=function(){for(var t=this.targets,e=this.type,i=a,n=this.max,r=this.strength,o=0,l=t.length;l>o;o++){var h=t[o],u=h.angularVelocity,c=-r*e(u);s.scale(u,-n>c?-n:c,i),h.applyTorque(i)}},e.exports=i},{"../../math/Vec3":44,"./Force":69}],73:[function(t,e){function i(t,e,i){this.source=t||null,n.call(this,e,i)}var n=t("./Force"),s=t("../../math/Vec3"),a=t("../../math/Mat33"),r=t("../../math/Quaternion"),o=new r,l=new s,h=new s,u=new a,c=Math.PI;i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.init=function(t){this.source||(this.anchor=this.anchor?this.anchor.normalize():new r(1,0,0,0)),t.stiffness||t.damping?(this.stiffness=this.stiffness||100,this.damping=this.damping||0,this.period=null,this.dampingRatio=null):(t.period||t.dampingRatio)&&(this.period=this.period||1,this.dampingRatio=this.dampingRatio||0,this.stiffness=2*c/this.period,this.stiffness*=this.stiffness,this.damping=4*c*this.dampingRatio/this.period)},i.prototype.update=function(){for(var t=this.source,e=this.targets,i=o,n=l,c=h,p=u,d=this.max,m=this.stiffness,f=this.damping,g=this.anchor||t.orientation,y=this.anchor?null:t.inverseInertia,_=0,v=e.length;v>_;_++){var S=e[_],x=S.orientation;if(r.conjugate(x,i),i.multiply(g),!(i.w>=1)){var b=Math.acos(i.w),T=Math.sqrt(1-i.w*i.w),A=c.copy(i).scale(2*b/T);A.scale(m),null!==y?a.add(y,S.inverseInertia,p).inverse():a.inverse(S.inverseInertia,p),0!==f&&A.add(t?s.subtract(S.angularVelocity,t.angularVelocity,n).scale(-f):s.scale(S.angularVelocity,-f,n));var w=A.applyMatrix(p),C=w.length();C>d&&w.scale(d/C),S.applyTorque(w),t&&t.applyTorque(w.invert())}}},e.exports=i},{"../../math/Mat33":41,"../../math/Quaternion":42,"../../math/Vec3":44,"./Force":69}],74:[function(t,e){function i(t,e,i){this.source=t||null,n.call(this,e,i)}var n=t("./Force"),s=t("../../math/Vec3"),a=new s,r=new s;i.prototype=Object.create(n.prototype),i.prototype.constructor=i;var o=Math.PI;i.FENE=function(t,e){var i=.99*e,n=Math.max(Math.min(t,i),-i);return n/(1-n*n/(e*e))},i.HOOKE=function(t){return t},i.prototype.init=function(t){this.max=this.max||1/0,this.length=this.length||0,this.type=this.type||i.HOOKE,this.maxLength=this.maxLength||1/0,t.stiffness||t.damping?(this.stiffness=this.stiffness||100,this.damping=this.damping||0,this.period=null,this.dampingRatio=null):(t.period||t.dampingRatio)&&(this.period=this.period||1,this.dampingRatio=this.dampingRatio||0,this.stiffness=2*o/this.period,this.stiffness*=this.stiffness,this.damping=4*o*this.dampingRatio/this.period)},i.prototype.update=function(){for(var t=this.source,e=this.targets,i=a,n=r,o=this.max,l=this.stiffness,h=this.damping,u=this.length,c=this.maxLength,p=this.anchor||t.position,d=this.anchor?0:t.inverseMass,m=this.type,f=0,g=e.length;g>f;f++){var y=e[f];s.subtract(p,y.position,i);var _=i.length(),v=_-u;if(!(Math.abs(v)<1e-6)){var S=1/(y.inverseMass+d);null!==this.period&&(l*=S,h*=S),i.scale(l*m(v,c)/v),0!==h&&i.add(t?s.subtract(y.velocity,t.velocity,n).scale(-h):s.scale(y.velocity,-h,n));var x=i.length(),b=x?1/x:0;s.scale(i,(x>o?o:x)*b,i),y.applyForce(i),t&&t.applyForce(i.invert())}}},e.exports=i},{"../../math/Vec3":44,"./Force":69}],75:[function(t,e){e.exports={Particle:t("./bodies/Particle"),convexBodyFactory:t("./bodies/convexBodyFactory"),Box:t("./bodies/Box"),Sphere:t("./bodies/Sphere"),Wall:t("./bodies/Wall"),Constraint:t("./constraints/Constraint"),Angle:t("./constraints/Angle"),Collision:t("./constraints/Collision"),Direction:t("./constraints/Direction"),Distance:t("./constraints/Distance"),Curve:t("./constraints/Curve"),Hinge:t("./constraints/Hinge"),BallAndSocket:t("./constraints/BallAndSocket"),Force:t("./forces/Force"),Drag:t("./forces/Drag"),RotationalDrag:t("./forces/RotationalDrag"),Gravity1D:t("./forces/Gravity1D"),Gravity3D:t("./forces/Gravity3D"),Spring:t("./forces/Spring"),RotationalSpring:t("./forces/RotationalSpring"),PhysicsEngine:t("./PhysicsEngine"),Geometry:t("./Geometry")}},{"./Geometry":48,"./PhysicsEngine":49,"./bodies/Box":50,"./bodies/Particle":51,"./bodies/Sphere":52,"./bodies/Wall":53,"./bodies/convexBodyFactory":54,"./constraints/Angle":55,"./constraints/BallAndSocket":56,"./constraints/Collision":57,"./constraints/Constraint":58,"./constraints/Curve":59,"./constraints/Direction":60,"./constraints/Distance":61,"./constraints/Hinge":62,"./forces/Drag":68,"./forces/Force":69,"./forces/Gravity1D":70,"./forces/Gravity3D":71,"./forces/RotationalDrag":72,"./forces/RotationalSpring":73,"./forces/Spring":74}],76:[function(t,e){var i,n,s=0,a=["ms","moz","webkit","o"];if("object"==typeof window){i=window.requestAnimationFrame,n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(var r=0;r<a.length&&!i;++r)i=window[a[r]+"RequestAnimationFrame"],n=window[a[r]+"CancelRequestAnimationFrame"]||window[a[r]+"CancelAnimationFrame"];i&&!n&&(i=null)}if(!i){var o=Date.now?Date.now:function(){return(new Date).getTime()};i=function(t){var e=o(),i=Math.max(0,16-(e-s)),n=setTimeout(function(){t(e+i)},i);return s=e+i,n},n=function(t){clearTimeout(t)}}var l={requestAnimationFrame:i,cancelAnimationFrame:n};e.exports=l},{}],77:[function(t,e){e.exports={requestAnimationFrame:t("./animationFrame").requestAnimationFrame,cancelAnimationFrame:t("./animationFrame").cancelAnimationFrame}},{"./animationFrame":76}],78:[function(t,e){function i(){this._updates=[],this._stoppedAt=n(),this._sleep=0,this.start();var t=this;window.addEventListener("message",function(e){t._onWindowMessage(e)})}var n=t("./now");i.prototype._onWindowMessage=function(t){this._running&&t.data.constructor===Array&&"FRAME"===t.data[0]&&this.step(t.data[1]-this._sleep)},i.prototype.start=function(){return this._running=!0,this._sleep+=n()-this._stoppedAt,this},i.prototype.stop=function(){return this._running=!1,this._stoppedAt=n(),this},i.prototype.isRunning=function(){return this._running},i.prototype.step=function(t){for(var e=0,i=this._updates.length;i>e;e++)this._updates[e].update(t);return this},i.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},i.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=i},{"./now":81}],79:[function(t,e){function i(){var t=this;this._updates=[],this._looper=function(e){t.loop(e)},this._time=0,this._stoppedAt=0,this._sleep=0,this._startOnVisibilityChange=!0,this._rAF=null,this._sleepDiff=!0,this.start(),r&&document.addEventListener(l,function(){t._onVisibilityChange()})}var n=t("../polyfills"),s=n.requestAnimationFrame,a=n.cancelAnimationFrame,r="undefined"!=typeof document;if(r){var o,l;"undefined"!=typeof document.hidden?(o="hidden",l="visibilitychange"):"undefined"!=typeof document.mozHidden?(o="mozHidden",l="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(o="msHidden",l="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(o="webkitHidden",l="webkitvisibilitychange")}i.prototype._onVisibilityChange=function(){document[o]?this._onUnfocus():this._onFocus()},i.prototype._onFocus=function(){this._startOnVisibilityChange&&this._start()},i.prototype._onUnfocus=function(){this._stop()},i.prototype.start=function(){return this._running||(this._startOnVisibilityChange=!0,this._start()),this},i.prototype._start=function(){this._running=!0,this._sleepDiff=!0,this._rAF=s(this._looper)},i.prototype.stop=function(){return this._running&&(this._startOnVisibilityChange=!1,this._stop()),this},i.prototype._stop=function(){this._running=!1,this._stoppedAt=this._time,a(this._rAF)},i.prototype.isRunning=function(){return this._running},i.prototype.step=function(t){this._time=t,this._sleepDiff&&(this._sleep+=t-this._stoppedAt,this._sleepDiff=!1);for(var e=t-this._sleep,i=0,n=this._updates.length;n>i;i++)this._updates[i].update(e);return this},i.prototype.loop=function(t){return this.step(t),this._rAF=s(this._looper),this},i.prototype.update=function(t){return-1===this._updates.indexOf(t)&&this._updates.push(t),this},i.prototype.noLongerUpdate=function(t){var e=this._updates.indexOf(t);return e>-1&&this._updates.splice(e,1),this},e.exports=i},{"../polyfills":77}],80:[function(t,e){e.exports={RequestAnimationFrameLoop:t("./RequestAnimationFrameLoop"),ContainerLoop:t("./ContainerLoop"),now:t("./now")}},{"./ContainerLoop":78,"./RequestAnimationFrameLoop":79,"./now":81}],81:[function(t,e){var i=window.performance&&window.performance.now?function(){return window.performance.now()}:Date.now;e.exports=i},{}],82:[function(t,e){function i(){s(),this._contexts={},this._outCommands=[],this._inCommands=[],this._time=null,this._resized=!1;var t=this;window.addEventListener("resize",function(){t._resized=!0})}var n=t("./Context"),s=t("./inject-css");i.prototype.getTime=function(){return this._time},i.prototype.sendEvent=function(t,e,i){this._outCommands.push("WITH",t,"TRIGGER",e,i)},i.prototype.sendResize=function(t,e){this.sendEvent(t,"CONTEXT_RESIZE",e)},i.prototype.handleWith=function(t,e){var i=e[t],n=i.split("/"),s=this.getOrSetContext(n.shift());return s.receive(i,e,t)},i.prototype.getOrSetContext=function(t){if(this._contexts[t])return this._contexts[t];var e=new n(t,this);return this._contexts[t]=e,e},i.prototype.giveSizeFor=function(t,e){var i=e[t],n=this.getOrSetContext(i).getRootSize();this.sendResize(i,n)},i.prototype.drawCommands=function(){for(var t=this._inCommands,e=0,i=t[e];i;){switch(i){case"TIME":this._time=t[++e];break;case"WITH":e=this.handleWith(++e,t);break;case"NEED_SIZE_FOR":this.giveSizeFor(++e,t)}i=t[++e]}for(var n in this._contexts)this._contexts[n].draw();return this._resized&&this.updateSize(),this._outCommands},i.prototype.updateSize=function(){for(var t in this._contexts)this._contexts[t].updateSize()},i.prototype.receiveCommands=function(t){for(var e=t.length,i=0;e>i;i++)this._inCommands.push(t[i])},i.prototype.clearCommands=function(){this._inCommands.length=0,this._outCommands.length=0,this._resized=!1},e.exports=i},{"./Context":83,"./inject-css":86}],83:[function(t,e){function i(t,e){this._compositor=e,this._rootEl=document.querySelector(t),this._selector=t;var i=document.createElement("div");this._rootEl.appendChild(i),this.DOMRenderer=new a(i,t,e),this.WebGLRenderer=null,this.canvas=null,this._renderState={projectionType:s.ORTHOGRAPHIC_PROJECTION,perspectiveTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewTransform:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),viewDirty:!1,perspectiveDirty:!1},this._size=[],this._children={},this._elementHash={},this._meshTransform=[],this._meshSize=[0,0,0]}var n=t("../webgl-renderers/WebGLRenderer"),s=t("../components/Camera"),a=t("../dom-renderers/DOMRenderer");i.prototype.updateSize=function(){var t=this.DOMRenderer.getSize();this._compositor.sendResize(this._selector,t);var e=t[0],i=t[1];return this._size[0]=e,this._size[1]=i,this._size[2]=e>i?e:i,this.canvas&&(this.canvas.width=e,this.canvas.height=i),this.WebGLRenderer&&this.WebGLRenderer.updateSize(this._size),this},i.prototype.draw=function(){this.DOMRenderer.draw(this._renderState),this.WebGLRenderer&&this.WebGLRenderer.draw(this._renderState),this._renderState.perspectiveDirty&&(this._renderState.perspectiveDirty=!1),this._renderState.viewDirty&&(this._renderState.viewDirty=!1)},i.prototype.getRootSize=function(){return this.DOMRenderer.getSize()},i.prototype.initWebGL=function(){this.canvas=document.createElement("canvas"),this._rootEl.appendChild(this.canvas),this.WebGLRenderer=new n(this.canvas,this._compositor),this.updateSize()},i.prototype.receive=function(t,e,i){var n=i,a=e[++n];for(this.DOMRenderer.loadPath(t),this.DOMRenderer.findTarget();a;){switch(a){case"INIT_DOM":this.DOMRenderer.insertEl(e[++n]);break;case"DOM_RENDER_SIZE":this.DOMRenderer.getSizeOf(e[++n]);break;case"CHANGE_TRANSFORM":for(var r=0;16>r;r++)this._meshTransform[r]=e[++n];this.DOMRenderer.setMatrix(this._meshTransform),this.WebGLRenderer&&this.WebGLRenderer.setCutoutUniform(t,"u_transform",this._meshTransform);break;case"CHANGE_SIZE":var o=e[++n],l=e[++n];this.DOMRenderer.setSize(o,l),this.WebGLRenderer&&(this._meshSize[0]=o,this._meshSize[1]=l,this.WebGLRenderer.setCutoutUniform(t,"u_size",this._meshSize));break;case"CHANGE_PROPERTY":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setProperty(e[++n],e[++n]);break;case"CHANGE_CONTENT":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setContent(e[++n]);break;case"CHANGE_ATTRIBUTE":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.setAttribute(e[++n],e[++n]);break;case"ADD_CLASS":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.addClass(e[++n]);break;case"REMOVE_CLASS":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.removeClass(e[++n]);break;case"SUBSCRIBE":this.WebGLRenderer&&this.WebGLRenderer.getOrSetCutout(t),this.DOMRenderer.subscribe(e[++n],e[++n]);break;case"GL_SET_DRAW_OPTIONS":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshOptions(t,e[++n]);break;case"GL_AMBIENT_LIGHT":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setAmbientLightColor(t,e[++n],e[++n],e[++n]);break;case"GL_LIGHT_POSITION":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setLightPosition(t,e[++n],e[++n],e[++n]);break;case"GL_LIGHT_COLOR":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setLightColor(t,e[++n],e[++n],e[++n]);break;case"MATERIAL_INPUT":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.handleMaterialInput(t,e[++n],e[++n]);break;case"GL_SET_GEOMETRY":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setGeometry(t,e[++n],e[++n],e[++n]);break;case"GL_UNIFORMS":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshUniform(t,e[++n],e[++n]);break;case"GL_BUFFER_DATA":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.bufferData(t,e[++n],e[++n],e[++n],e[++n],e[++n]);break;case"GL_CUTOUT_STATE":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setCutoutState(t,e[++n]);break;case"GL_MESH_VISIBILITY":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.setMeshVisibility(t,e[++n]);break;case"GL_REMOVE_MESH":this.WebGLRenderer||this.initWebGL(),this.WebGLRenderer.removeMesh(t);break;case"PINHOLE_PROJECTION":this._renderState.projectionType=s.PINHOLE_PROJECTION,this._renderState.perspectiveTransform[11]=-1/e[++n],this._renderState.perspectiveDirty=!0;break;case"ORTHOGRAPHIC_PROJECTION":this._renderState.projectionType=s.ORTHOGRAPHIC_PROJECTION,this._renderState.perspectiveTransform[11]=0,this._renderState.perspectiveDirty=!0;break;case"CHANGE_VIEW_TRANSFORM":this._renderState.viewTransform[0]=e[++n],this._renderState.viewTransform[1]=e[++n],this._renderState.viewTransform[2]=e[++n],this._renderState.viewTransform[3]=e[++n],this._renderState.viewTransform[4]=e[++n],this._renderState.viewTransform[5]=e[++n],this._renderState.viewTransform[6]=e[++n],this._renderState.viewTransform[7]=e[++n],this._renderState.viewTransform[8]=e[++n],this._renderState.viewTransform[9]=e[++n],this._renderState.viewTransform[10]=e[++n],this._renderState.viewTransform[11]=e[++n],this._renderState.viewTransform[12]=e[++n],this._renderState.viewTransform[13]=e[++n],this._renderState.viewTransform[14]=e[++n],this._renderState.viewTransform[15]=e[++n],this._renderState.viewDirty=!0;break;case"WITH":return n-1}a=e[++n]}return n},e.exports=i},{"../components/Camera":2,"../dom-renderers/DOMRenderer":25,"../webgl-renderers/WebGLRenderer":131}],84:[function(t,e){function i(t,e,i){this._thread=t,this._compositor=e,this._renderLoop=i,this._renderLoop.update(this);var n=this;this._thread.onmessage=function(t){var e=t.data?t.data:t;if("ENGINE"===e[0])switch(e[1]){case"START":n._renderLoop.start();break;case"STOP":n._renderLoop.stop();break;default:console.error('Unknown ENGINE command "'+e[1]+'"')}else n._compositor.receiveCommands(e)},this._thread.onerror=function(t){console.error(t)}}i.prototype.getThread=function(){return this._thread},i.prototype.getCompositor=function(){return this._compositor},i.prototype.getEngine=function(){return this._renderLoop},i.prototype.update=function(t){this._thread.postMessage(["FRAME",t]);var e=this._compositor.drawCommands();this._thread.postMessage(e),this._compositor.clearCommands()},e.exports=i},{}],85:[function(t,e){e.exports={Compositor:t("./Compositor"),Context:t("./Context"),UIManager:t("./UIManager"),injectCSS:t("./inject-css")}},{"./Compositor":82,"./Context":83,"./UIManager":84,"./inject-css":86}],86:[function(t,e){function i(){if(!s)if(s=!0,document.createStyleSheet){var t=document.createStyleSheet();t.cssText=n}else{var e=document.getElementsByTagName("head")[0],i=document.createElement("style");i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),(e?e:document.documentElement).appendChild(i)}}var n=".famous-dom-renderer {width:100%;height:100%;transform-style:preserve-3d;-webkit-transform-style:preserve-3d;}.famous-dom-element {-webkit-transform-origin:0% 0%;transform-origin:0% 0%;-webkit-backface-visibility:visible;backface-visibility:visible;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-tap-highlight-color:transparent;pointer-events:auto;z-index:1;}.famous-dom-element-content,.famous-dom-element {position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;}.famous-webgl-renderer {-webkit-transform: translateZ(1000000px);transform: translateZ(1000000px)pointer-events:none;position:absolute;z-index:1;top:0;left:0;}",s="undefined"==typeof document;e.exports=i},{}],87:[function(t,e){var i={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t},inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},outElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},inOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2===(t/=.5)?1:(i||(i=.3*1.5),e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-i.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*i.inBounce(2*t):.5*i.outBounce(2*t-1)+.5},flat:function(){return 0}};e.exports=i},{}],88:[function(t,e){function i(t){this._queue=[],this._from=null,this._state=null,this._startedAt=null,this._pausedAt=null,null!=t&&this.from(t)}var n=t("./Curves"),s=t("../core/FamousEngine");i.Clock=s.getClock(),i.prototype.to=function(t,e,i,s,a){return e=null!=e&&e.constructor===String?n[e]:e,0===this._queue.length&&(this._startedAt=this.constructor.Clock.now(),this._pausedAt=null),this._queue.push(t,null!=e?e:n.linear,null!=i?i:100,s,a),this},i.prototype.from=function(t){return this._state=t,this._from=this._sync(null,this._state),this._queue.length=0,this._startedAt=this.constructor.Clock.now(),this._pausedAt=null,this},i.prototype.delay=function(t,e){var i=this._queue.length>0?this._queue[this._queue.length-5]:this._state;return this.to(i,n.flat,t,e)},i.prototype.override=function(t,e,i,s,a){return this._queue.length>0&&(null!=t&&(this._queue[0]=t),null!=e&&(this._queue[1]=e.constructor===String?n[e]:e),null!=i&&(this._queue[2]=i),null!=s&&(this._queue[3]=s),null!=a&&(this._queue[4]=a)),this},i.prototype._interpolate=function(t,e,i,n,s){if(i instanceof Object)if("slerp"===s){var a,r,o,l,h,u,c,p,d,m,f,g,y;if(a=e[0],r=e[1],o=e[2],l=e[3],h=i[0],u=i[1],c=i[2],p=i[3],1===n)return t[0]=h,t[1]=u,t[2]=c,t[3]=p,t;m=l*p+a*h+r*u+o*c,1-m>1e-5?(d=Math.acos(m),f=Math.sin(d),g=Math.sin((1-n)*d)/f,y=Math.sin(n*d)/f):(g=1-n,y=n),t[0]=a*g+h*y,t[1]=r*g+u*y,t[2]=o*g+c*y,t[3]=l*g+p*y}else if(i instanceof Array)for(var _=0,v=i.length;v>_;_++)t[_]=this._interpolate(t[_],e[_],i[_],n,s);else for(var S in i)t[S]=this._interpolate(t[S],e[S],i[S],n,s);else t=e+n*(i-e);return t},i.prototype._sync=function a(t,e){if("number"==typeof e)t=e;else if(e instanceof Array){null==t&&(t=[]);for(var i=0,n=e.length;n>i;i++)t[i]=a(t[i],e[i])}else if(e instanceof Object){null==t&&(t={});for(var s in e)t[s]=a(t[s],e[s])}return t},i.prototype.get=function(t){if(0===this._queue.length)return this._state;t=this._pausedAt?this._pausedAt:t,t=t?t:this.constructor.Clock.now();var e=(t-this._startedAt)/this._queue[2];this._state=this._interpolate(this._state,this._from,this._queue[0],this._queue[1](e>1?1:e),this._queue[4]);var i=this._state;if(e>=1){this._startedAt=this._startedAt+this._queue[2],this._from=this._sync(this._from,this._state),this._queue.shift(),this._queue.shift(),this._queue.shift();var n=this._queue.shift();this._queue.shift(),n&&n()}return e>1?this.get():i},i.prototype.isActive=function(){return this._queue.length>0},i.prototype.halt=function(){return this.from(this.get())},i.prototype.pause=function(){return this._pausedAt=this.constructor.Clock.now(),this},i.prototype.isPaused=function(){return!!this._pausedAt},i.prototype.resume=function(){var t=this._pausedAt-this._startedAt;return this._startedAt=this.constructor.Clock.now()-t,this._pausedAt=null,this},i.prototype.reset=function(t){return this.from(t)},i.prototype.set=function(t,e,i){return null==e?(this.from(t),i&&i()):this.to(t,e.curve,e.duration,i,e.method),this},e.exports=i},{"../core/FamousEngine":17,"./Curves":87}],89:[function(t,e){e.exports={Curves:t("./Curves"),Transitionable:t("./Transitionable")}},{"./Curves":87,"./Transitionable":88}],90:[function(t,e){function i(){this._events={}}i.prototype.on=function(t,e){this._events[t]||(this._events[t]=[]);var i=this._events[t];return i.push(e),function(){i.splice(i.indexOf(e),1)}},i.prototype.off=function(t,e){var i=this._events[t];return i&&i.splice(i.indexOf(e),1),this},i.prototype.trigger=function(t,e){var i=this._events[t];if(i)for(var n=0,s=i.length;s>n;n++)i[n](e);return this},e.exports=i},{}],91:[function(t,e){function i(t,e,i){this._r=new n(0),this._g=new n(0),this._b=new n(0),this._opacity=new n(1),t&&this.set(t,e,i)}var n=t("../transitions/Transitionable");i.prototype.toString=function(){return"Color"},i.prototype.set=function(t,e,n){switch(i.determineType(t)){case"hex":return this.setHex(t,e,n);case"colorName":return this.setColor(t,e,n);case"instance":return this.changeTo(t,e,n);case"rgb":return this.setRGB(t[0],t[1],t[2],e,n)}return this},i.prototype.isActive=function(){return this._r.isActive()||this._g.isActive()||this._b.isActive()||this._opacity.isActive()},i.prototype.halt=function(){return this._r.halt(),this._g.halt(),this._b.halt(),this._opacity.halt(),this},i.prototype.changeTo=function(t,e,n){if(i.isColorInstance(t)){var s=t.getRGB();this.setRGB(s[0],s[1],s[2],e,n)}return this},i.prototype.setColor=function(t,e,i){return s[t]&&this.setHex(s[t],e,i),this},i.prototype.getColor=function(t){return i.isString(t)&&(t=t.toLowerCase()),"hex"===t?this.getHex():this.getRGB()},i.prototype.setR=function(t,e,i){return this._r.set(t,e,i),this},i.prototype.setG=function(t,e,i){return this._g.set(t,e,i),this},i.prototype.setB=function(t,e,i){return this._b.set(t,e,i),this},i.prototype.setOpacity=function(t,e,i){return this._opacity.set(t,e,i),this},i.prototype.setRGB=function(t,e,i,n,s){return this.setR(t,n),this.setG(e,n),this.setB(i,n,s),this},i.prototype.getR=function(){return this._r.get()},i.prototype.getG=function(){return this._g.get()},i.prototype.getB=function(){return this._b.get()},i.prototype.getOpacity=function(){return this._opacity.get()},i.prototype.getRGB=function(){return[this.getR(),this.getG(),this.getB()]},i.prototype.getNormalizedRGB=function(){var t=this.getR()/255,e=this.getG()/255,i=this.getB()/255;return[t,e,i]},i.prototype.getNormalizedRGBA=function(){var t=this.getR()/255,e=this.getG()/255,i=this.getB()/255,n=this.getOpacity();return[t,e,i,n]},i.prototype.getHex=function(){var t=i.toHex(this.getR()),e=i.toHex(this.getG()),n=i.toHex(this.getB());return"#"+t+e+n},i.prototype.setHex=function(t,e,i){if(t="#"===t.charAt(0)?t.substring(1,t.length):t,3===t.length){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,function(t,e,i,n){return e+e+i+i+n+n})}var s=parseInt(t.substring(0,2),16),a=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16);return this.setRGB(s,a,r,e,i),this},i.toHex=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},i.determineType=function(t){return i.isColorInstance(t)?"instance":s[t]?"colorName":i.isHex(t)?"hex":Array.isArray(t)?"rgb":void 0},i.isString=function(t){return"string"==typeof t},i.isHex=function(t){return i.isString(t)?"#"===t[0]:!1},i.isColorInstance=function(t){return!!t.getColor};var s={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};
e.exports=i},{"../transitions/Transitionable":88}],92:[function(t,e){e.exports={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9}},{}],93:[function(t,e){function i(t,e){return function(){return 0!==t.length?t.pop():new e}}function n(t){return function(e){t.push(e)}}var s={};s.pools={},s.register=function(t,e){var s=this.pools[t]=[];this["request"+t]=i(s,e),this["free"+t]=n(s)},s.disposeOf=function(t){for(var e=this.pools[t],i=e.length;i--;)e.pop()},e.exports=s},{}],94:[function(t,e){function i(t,e,i){return e>t?e:t>i?i:t}e.exports=i},{}],95:[function(t,e){var i=function n(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var i in t)if("object"==typeof t[i]&&null!==t[i])if(t[i]instanceof Array){e[i]=new Array(t[i].length);for(var s=0;s<t[i].length;s++)e[i][s]=n(t[i][s])}else e[i]=n(t[i]);else e[i]=t[i]}else e=t;return e};e.exports=i},{}],96:[function(t,e){e.exports={CallbackStore:t("./CallbackStore"),clamp:t("./clamp"),clone:t("./clone"),Color:t("./Color"),KeyCodes:t("./KeyCodes"),keyValueToArrays:t("./keyValueToArrays"),loadURL:t("./loadURL"),ObjectManager:t("./ObjectManager"),strip:t("./strip"),vendorPrefix:t("./vendorPrefix")}},{"./CallbackStore":90,"./Color":91,"./KeyCodes":92,"./ObjectManager":93,"./clamp":94,"./clone":95,"./keyValueToArrays":97,"./loadURL":98,"./strip":99,"./vendorPrefix":100}],97:[function(t,e){e.exports=function(t){var e=[],i=[],n=0;for(var s in t)t.hasOwnProperty(s)&&(e[n]=s,i[n]=t[s],n++);return{keys:e,values:i}}},{}],98:[function(t,e){var i=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()};e.exports=i},{}],99:[function(t,e){function i(t){switch(t){case null:case void 0:return t}switch(t.constructor){case Boolean:case Number:case String:return t;case Object:for(var e in t){var n=i(t[e],!0);t[e]=n}return t;default:return null}}e.exports=i},{}],100:[function(t,e){function i(t){for(var e=0;e<n.length;e++){var i=n[e]+t;if(""===document.documentElement.style[i])return i}return t}var n=["","-ms-","-webkit-","-moz-","-o-"];e.exports=i},{}],101:[function(t,e){function i(t){n.call(this,t),this.spec.dynamic=!0}var n=t("./Geometry");i.prototype.getLength=function(){return this.getVertexPositions().length},i.prototype.getVertexBuffer=function(t){if(!t)throw"getVertexBuffer requires a name";var e=this.spec.bufferNames.indexOf(t);if(~e)return this.spec.bufferValues[e];throw"buffer does not exist"},i.prototype.setVertexBuffer=function(t,e,i){var n=this.spec.bufferNames.indexOf(t);return-1===n&&(n=this.spec.bufferNames.push(t)-1),this.spec.bufferValues[n]=e||[],this.spec.bufferSpacings[n]=i||this.DEFAULT_BUFFER_SIZE,-1===this.spec.invalidations.indexOf(n)&&this.spec.invalidations.push(n),this},i.prototype.fromGeometry=function(t){for(var e=t.spec.bufferNames.length,i=0;e>i;i++)this.setVertexBuffer(t.spec.bufferNames[i],t.spec.bufferValues[i],t.spec.bufferSpacings[i]);return this},i.prototype.setVertexPositions=function(t){return this.setVertexBuffer("a_pos",t,3)},i.prototype.setNormals=function(t){return this.setVertexBuffer("a_normals",t,3)},i.prototype.setTextureCoords=function(t){return this.setVertexBuffer("a_texCoord",t,2)},i.prototype.setIndices=function(t){return this.setVertexBuffer("indices",t,1)},i.prototype.setDrawType=function(t){return this.spec.type=t.toUpperCase(),this},i.prototype.getVertexPositions=function(){return this.getVertexBuffer("a_pos")},i.prototype.getNormals=function(){return this.getVertexBuffer("a_normals")},i.prototype.getTextureCoords=function(){return this.getVertexBuffer("a_texCoord")},e.exports=i},{"./Geometry":102}],102:[function(t,e){function i(t){if(this.options=t||{},this.DEFAULT_BUFFER_SIZE=3,this.spec={id:n++,dynamic:!1,type:this.options.type||"TRIANGLES",bufferNames:[],bufferValues:[],bufferSpacings:[],invalidations:[]},this.options.buffers)for(var e=this.options.buffers.length,i=0;e>i;)this.spec.bufferNames.push(this.options.buffers[i].name),this.spec.bufferValues.push(this.options.buffers[i].data),this.spec.bufferSpacings.push(this.options.buffers[i].size||this.DEFAULT_BUFFER_SIZE),this.spec.invalidations.push(i++)}var n=0;e.exports=i},{}],103:[function(t,e){function i(t,e){return-(e+(t-e)/2)}function n(t,e){return 1/((t-e)/2)}var s=t("../math/Vec3"),a=t("../math/Vec2"),r=[new s,new s,new s,new a,new a],o={};o.generateParametric=function(t,e,i,n){var s,a,r,o,l=[],h=n?Math.PI+Math.PI/(t-1):Math.PI,u=[];for(s=0;t+1>s;s++)for(a=s*h/t,o=0;e>o;o++)r=2*o*h/e,i(a,r,u),l.push(u[0],u[1],u[2]);var c,p=[],d=0;for(s=0;t>s;s++){for(o=0;e>o;o++)c=(o+1)%e,p.push(d+o,d+o+e,d+c),p.push(d+c,d+o+e,d+c+e);d+=e}return{vertices:l,indices:p}},o.computeNormals=function(t,e,i){var n,s,a,o,l,h,u,c,p,d,m=i||[],f=e.length/3;for(h=0;f>h;h++)s=3*e[3*h+0],n=3*e[3*h+1],a=3*e[3*h+2],r[0].set(t[n],t[n+1],t[n+2]),r[1].set(t[s],t[s+1],t[s+2]),r[2].set(t[a],t[a+1],t[a+2]),o=r[2].subtract(r[0]).cross(r[1].subtract(r[0])).normalize(),m[n+0]=(m[n+0]||0)+o.x,m[n+1]=(m[n+1]||0)+o.y,m[n+2]=(m[n+2]||0)+o.z,m[s+0]=(m[s+0]||0)+o.x,m[s+1]=(m[s+1]||0)+o.y,m[s+2]=(m[s+2]||0)+o.z,m[a+0]=(m[a+0]||0)+o.x,m[a+1]=(m[a+1]||0)+o.y,m[a+2]=(m[a+2]||0)+o.z;for(h=0;h<m.length;h+=3)for(u=m[h],c=m[h+1],p=m[h+2],d=Math.sqrt(u*u+c*c+p*p),l=0;3>l;l++)m[h+l]/=d;return m},o.subdivide=function(t,e,i){for(var n,o,l,h,u,c,p=t.length/3;p--;)n=t.slice(3*p,3*p+3),u=n.map(function(t){return new s(e[3*t],e[3*t+1],e[3*t+2])}),e.push.apply(e,s.scale(s.add(u[0],u[1],r[0]),.5,r[1]).toArray()),e.push.apply(e,s.scale(s.add(u[1],u[2],r[0]),.5,r[1]).toArray()),e.push.apply(e,s.scale(s.add(u[0],u[2],r[0]),.5,r[1]).toArray()),i&&(c=n.map(function(t){return new a(i[2*t],i[2*t+1])}),i.push.apply(i,a.scale(a.add(c[0],c[1],r[3]),.5,r[4]).toArray()),i.push.apply(i,a.scale(a.add(c[1],c[2],r[3]),.5,r[4]).toArray()),i.push.apply(i,a.scale(a.add(c[0],c[2],r[3]),.5,r[4]).toArray())),o=e.length-3,l=o+1,h=o+2,t.push(o,l,h),t.push(n[0],o,h),t.push(o,n[1],l),t[p]=h,t[p+1]=l,t[p+2]=n[2]},o.getUniqueFaces=function(t,e){for(var i,n=e.length/3,s=[];n--;)for(var a=0;3>a;a++)i=e[3*n+a],s[i]?(t.push(t[3*i],t[3*i+1],t[3*i+2]),e[3*n+a]=t.length/3-1):s[i]=!0},o.subdivideSpheroid=function(t,e){for(var i,n,a,o,l,h=e.length/3;h--;)n=e.slice(3*h,3*h+3),i=n.map(function(e){return new s(t[3*e],t[3*e+1],t[3*e+2])}),t.push.apply(t,s.normalize(s.add(i[0],i[1],r[0]),r[1]).toArray()),t.push.apply(t,s.normalize(s.add(i[1],i[2],r[0]),r[1]).toArray()),t.push.apply(t,s.normalize(s.add(i[0],i[2],r[0]),r[1]).toArray()),a=t.length/3-3,o=a+1,l=a+2,e.push(a,o,l),e.push(n[0],a,l),e.push(a,n[1],o),e[3*h]=l,e[3*h+1]=o,e[3*h+2]=n[2]},o.getSpheroidNormals=function(t,e){e=e||[];for(var i,n=t.length/3,a=0;n>a;a++)i=new s(t[3*a+0],t[3*a+1],t[3*a+2]).normalize().toArray(),e[3*a+0]=i[0],e[3*a+1]=i[1],e[3*a+2]=i[2];return e},o.getSpheroidUV=function(t,e){e=e||[];for(var i,n=t.length/3,s=[],a=0;n>a;a++)i=r[0].set(t[3*a],t[3*a+1],t[3*a+2]).normalize().toArray(),s[0]=.5*this.getAzimuth(i)/Math.PI+.5,s[1]=this.getAltitude(i)/Math.PI+.5,e.push.apply(e,s);return e},o.normalizeAll=function(t,e){e=e||[];for(var i=t.length/3,n=0;i>n;n++)Array.prototype.push.apply(e,new s(t[3*n],t[3*n+1],t[3*n+2]).normalize().toArray());return e},o.normalizeVertices=function(t,e){e=e||[];var a,r,o,l,h,u,c,p,d=t.length/3,m=[];for(p=0;d>p;p++)c=m[p]=new s(t[3*p],t[3*p+1],t[3*p+2]),(null==a||c.x<a)&&(a=c.x),(null==r||c.x>r)&&(r=c.x),(null==o||c.y<o)&&(o=c.y),(null==l||c.y>l)&&(l=c.y),(null==h||c.z<h)&&(h=c.z),(null==u||c.z>u)&&(u=c.z);var f=new s(i(r,a),i(l,o),i(u,h)),g=Math.min(n(r+f.x,a+f.x),n(l+f.y,o+f.y),n(u+f.z,h+f.z));for(p=0;p<m.length;p++)e.push.apply(e,m[p].add(f).scale(g).toArray());return e},o.getAzimuth=function(t){return Math.atan2(t[2],-t[0])},o.getAltitude=function(t){return Math.atan2(-t[1],Math.sqrt(t[0]*t[0]+t[2]*t[2]))},o.trianglesToLines=function(t,e){var i=t.length/3;e=e||[];var n;for(n=0;i>n;n++)e.push(t[3*n+0],t[3*n+1]),e.push(t[3*n+1],t[3*n+2]),e.push(t[3*n+2],t[3*n+0]);return e},o.addBackfaceTriangles=function(t,e){for(var i=e.length/3,n=0,s=e.length;s--;)e[s]>n&&(n=e[s]);for(n++,s=0;i>s;s++){var a=e[3*s],r=e[3*s+1],o=e[3*s+2];e.push(a+n,o+n,r+n)}var l=t.length;for(s=0;l>s;s++)t.push(t[s])},e.exports=o},{"../math/Vec2":43,"../math/Vec3":44}],104:[function(t,e){function i(t,e){t=s(t);var i=t.split("\n"),a=[];e=e||{};for(var r,o,l,h,u,c,p=[],d=[],m=[],f=[],g=[],y=[],_=i.length,v=0;_>v;v++)c=i[v],u=i[v].split(" "),-1!==c.indexOf("v ")?y.push([parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])]):-1!==c.indexOf("vt ")?g.push([parseFloat(u[1]),parseFloat(u[2])]):-1!==c.indexOf("vn ")?f.push([parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])]):-1!==c.indexOf("f ")?-1!==u[1].indexOf("//")?(r=u[1].split("//"),o=u[2].split("//"),l=u[3].split("//"),d.push([parseFloat(r[0])-1,parseFloat(o[0])-1,parseFloat(l[0])-1]),m.push([parseFloat(r[1])-1,parseFloat(o[1])-1,parseFloat(l[1])-1]),u[4]&&(h=u[4].split("//"),d.push([parseFloat(r[0])-1,parseFloat(l[0])-1,parseFloat(h[0])-1]),m.push([parseFloat(r[2])-1,parseFloat(l[2])-1,parseFloat(h[2])-1]))):-1!==u[1].indexOf("/")?(r=u[1].split("/"),o=u[2].split("/"),l=u[3].split("/"),d.push([parseFloat(r[0])-1,parseFloat(o[0])-1,parseFloat(l[0])-1]),p.push([parseFloat(r[1])-1,parseFloat(o[1])-1,parseFloat(l[1])-1]),m.push([parseFloat(r[2])-1,parseFloat(o[2])-1,parseFloat(l[2])-1]),u[4]&&(h=u[4].split("/"),d.push([parseFloat(r[0])-1,parseFloat(l[0])-1,parseFloat(h[0])-1]),p.push([parseFloat(r[1])-1,parseFloat(l[1])-1,parseFloat(h[1])-1]),m.push([parseFloat(r[2])-1,parseFloat(l[2])-1,parseFloat(h[2])-1]))):(d.push([parseFloat(u[1])-1,parseFloat(u[2])-1,parseFloat(u[3])-1]),p.push([parseFloat(u[1])-1,parseFloat(u[2])-1,parseFloat(u[3])-1]),m.push([parseFloat(u[1])-1,parseFloat(u[2])-1,parseFloat(u[3])-1]),u[4]&&(d.push([parseFloat(u[1])-1,parseFloat(u[3])-1,parseFloat(u[4])-1]),p.push([parseFloat(u[1])-1,parseFloat(u[3])-1,parseFloat(u[4])-1]),m.push([parseFloat(u[1])-1,parseFloat(u[3])-1,parseFloat(u[4])-1]))):-1!==c.indexOf("g ")&&(d.length&&a.push(n(y,f,g,d,m,p,e)),d.length=0,p.length=0,m.length=0);return a.push(n(y,f,g,d,m,p,e)),a}function n(t,e,i,n,s,o,h){var u=a(t,e,i,n,s,o);return u.vertices=r(u.vertices),u.normals=r(u.normals),u.texCoords=r(u.texCoords),u.indices=r(u.indices),h.normalize&&(u.vertices=l.normalizeVertices(u.vertices)),h.computeNormals&&(u.normals=l.computeNormals(u.vertices,u.indices)),{vertices:u.vertices,normals:u.normals,textureCoords:u.texCoords,indices:u.indices}}function s(t){return t.replace(/ +(?= )/g,"").replace(/\s+$/g,"")}function a(t,e,i,n,s,a){for(var r,o,l,h,u,c=[],p=[],d=[],m=[],f={},g=0,y=n.length,_=s.length,v=a.length,S=0;y>S;S++){m[S]=[],h=n[S].length;for(var x=0;h>x;x++)v&&(l=a[S][x]),_&&(o=s[S][x]),r=n[S][x],u=f[r+","+o+","+l],void 0===u&&(u=g++,p.push(t[r]),_&&c.push(e[o]),v&&d.push(i[l]),f[r+","+o+","+l]=u),m[S].push(u)}return{vertices:p,normals:c,texCoords:d,indices:m}}function r(t){for(var e=t.length,i=[],n=0;e>n;n++)i.push.apply(i,t[n]);return i}var o=t("../utilities/loadURL"),l=t("./GeometryHelper"),h={cached:{},requests:{},formatText:i};h.load=function(t,e,i){this.cached[t]?e(this.cached[t]):this.requests[t]?this.requests[t].push(e):(this.requests[t]=[e],o(t,this._onsuccess.bind(this,t,i)))},h._onsuccess=function(t,e,n){var s=i.call(this,n,e||{});this.cached[t]=s;for(var a=0;a<this.requests[t].length;a++)this.requests[t][a](s);this.requests[t]=null},e.exports=h},{"../utilities/loadURL":98,"./GeometryHelper":103}],105:[function(t,e){e.exports={Box:t("./primitives/Box"),Circle:t("./primitives/Circle"),Cylinder:t("./primitives/Cylinder"),GeodesicSphere:t("./primitives/GeodesicSphere"),Icosahedron:t("./primitives/Icosahedron"),ParametricCone:t("./primitives/ParametricCone"),Plane:t("./primitives/Plane"),Sphere:t("./primitives/Sphere"),Tetrahedron:t("./primitives/Tetrahedron"),Torus:t("./primitives/Torus"),Triangle:t("./primitives/Triangle"),GeometryHelper:t("./GeometryHelper"),DynamicGeometry:t("./DynamicGeometry"),Geometry:t("./Geometry"),OBJLoader:t("./OBJLoader")}},{"./DynamicGeometry":101,"./Geometry":102,"./GeometryHelper":103,"./OBJLoader":104,"./primitives/Box":106,"./primitives/Circle":107,"./primitives/Cylinder":108,"./primitives/GeodesicSphere":109,"./primitives/Icosahedron":110,"./primitives/ParametricCone":111,"./primitives/Plane":112,"./primitives/Sphere":113,"./primitives/Tetrahedron":114,"./primitives/Torus":115,"./primitives/Triangle":116}],106:[function(t,e){function i(t){return[2*(1&t)-1,(2&t)-1,(4&t)/2-1]}function n(t){t=t||{};var e,n,r,o,l,h=[],u=[],c=[],p=[];for(o=0;o<a.length;o++){for(e=a[o],r=4*o,l=0;4>l;l++){n=e[l];var d=i(n);h.push(d[0],d[1],d[2]),u.push(1&l,(2&l)/2),c.push(e[4],e[5],e[6])}p.push(r,r+1,r+2),p.push(r+2,r+1,r+3)}return new s({buffers:[{name:"a_pos",data:h},{name:"a_texCoord",data:u,size:2},{name:"a_normals",data:c},{name:"indices",data:p,size:1}]})}var s=t("../Geometry"),a=[[0,4,2,6,-1,0,0],[1,3,5,7,1,0,0],[0,1,4,5,0,-1,0],[2,6,3,7,0,1,0],[0,2,1,3,0,0,-1],[4,5,6,7,0,0,1]];e.exports=n},{"../Geometry":102}],107:[function(t,e){function i(t){t=t||{};var e=t.detail||30,i=s(e,!0);t.backface!==!1&&r.addBackfaceTriangles(i.vertices,i.indices);var o=n(i.vertices),l=r.computeNormals(i.vertices,i.indices);return new a({buffers:[{name:"a_pos",data:i.vertices},{name:"a_texCoord",data:o,size:2},{name:"a_normals",data:l},{name:"indices",data:i.indices,size:1}]})}function n(t){for(var e=[],i=t.length/3,n=0;i>n;n++){var s=t[3*n],a=t[3*n+1];e.push(.5+.5*s,.5+.5*-a)}return e}function s(t){for(var e,i,n,s=[0,0,0],a=[],r=1,o=0;t+1>o;o++)e=o/t*Math.PI*2,i=Math.cos(e),n=Math.sin(e),s.push(i,n,0),o>0&&a.push(0,r,++r);return{vertices:s,indices:a}}var a=t("../Geometry"),r=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],108:[function(t,e){function i(t){t=t||{};var e,a=t.radius||1,r=t.detail||15;return e=s.generateParametric(r,r,i.generator.bind(null,a)),t.backface!==!1&&s.addBackfaceTriangles(e.vertices,e.indices),new n({buffers:[{name:"a_pos",data:e.vertices},{name:"a_texCoord",data:s.getSpheroidUV(e.vertices),size:2},{name:"a_normals",data:s.computeNormals(e.vertices,e.indices)},{name:"indices",data:e.indices,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");i.generator=function(t,e,i,n){n[1]=t*Math.sin(i),n[0]=t*Math.cos(i),n[2]=t*(-1+e/Math.PI*2)},e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],109:[function(t,e){function i(t){var e=.5*(1+Math.sqrt(5)),i=[-1,e,0,1,e,0,-1,-e,0,1,-e,0,0,-1,-e,0,1,-e,0,-1,e,0,1,e,e,0,1,e,0,-1,-e,0,1,-e,0,-1],a=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];i=s.normalizeAll(i),t=t||{};for(var r=t.detail||3;--r;)s.subdivideSpheroid(i,a);s.getUniqueFaces(i,a);var o=s.computeNormals(i,a),l=s.getSpheroidUV(i);return new n({buffers:[{name:"a_pos",data:i},{name:"a_texCoord",data:l,size:2},{name:"a_normals",data:o},{name:"indices",data:a,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],110:[function(t,e){function i(){var t=(1+Math.sqrt(5))/2,e=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,-t,0,1,-t,0,-1,t,0,1,t,t,0,1,t,0,-1,-t,0,1,-t,0,-1],i=[0,5,11,0,1,5,0,7,1,0,10,7,0,11,10,1,9,5,5,4,11,11,2,10,10,6,7,7,8,1,3,4,9,3,2,4,3,6,2,3,8,6,3,9,8,4,5,9,2,11,4,6,10,2,8,7,6,9,1,8];s.getUniqueFaces(e,i);var a=s.computeNormals(e,i),r=s.getSpheroidUV(e);return e=s.normalizeAll(e),new n({buffers:[{name:"a_pos",data:e},{name:"a_texCoord",data:r,size:2},{name:"a_normals",data:a},{name:"indices",data:i,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],111:[function(t,e){function i(t){t=t||{};var e=t.detail||15,a=t.radius||1/Math.PI,r=s.generateParametric(e,e,i.generator.bind(null,a));return t.backface!==!1&&s.addBackfaceTriangles(r.vertices,r.indices),new n({buffers:[{name:"a_pos",data:r.vertices},{name:"a_texCoord",data:s.getSpheroidUV(r.vertices),size:2},{name:"a_normals",data:s.computeNormals(r.vertices,r.indices)},{name:"indices",data:r.indices,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");i.generator=function(t,e,i,n){n[0]=-t*e*Math.cos(i),n[1]=t*e*Math.sin(i),n[2]=-e/(Math.PI/2)+1},e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],112:[function(t,e){function i(t){t=t||{};for(var e,i=t.detailX||t.detail||1,a=t.detailY||t.detail||1,r=[],o=[],l=[],h=[],u=0;a>=u;u++)for(var c=u/a,p=0;i>=p;p++){var d=p/i;r.push(2*(d-.5),2*(c-.5),0),o.push(d,1-c),i>p&&a>u&&(e=p+u*(i+1),h.push(e,e+1,e+i+1),h.push(e+i+1,e+1,e+i+2))}if(t.backface!==!1){s.addBackfaceTriangles(r,h);var m=o.length;for(e=0;m>e;e++)o.push(o[e])}return l=s.computeNormals(r,h),new n({buffers:[{name:"a_pos",data:r},{name:"a_texCoord",data:o,size:2},{name:"a_normals",data:l},{name:"indices",data:h,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],113:[function(t,e){function i(t){t=t||{};var e=t.detail||10,a=t.detailX||e,r=t.detailY||e,o=s.generateParametric(a,r,i.generator,!0);return s.getUniqueFaces(o.vertices,o.indices),new n({buffers:[{name:"a_pos",data:o.vertices},{name:"a_texCoord",data:s.getSpheroidUV(o.vertices),size:2},{name:"a_normals",data:s.getSpheroidNormals(o.vertices)},{name:"indices",data:o.indices,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");i.generator=function(t,e,i){var n=Math.sin(t)*Math.cos(e),s=Math.cos(t),a=-Math.sin(t)*Math.sin(e);i[0]=n,i[1]=s,i[2]=a},e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],114:[function(t,e){function i(t){var e,i,a=[],r=[],o=Math.sqrt(3),l=[1,-1,-1/o,-1,-1,-1/o,0,1,0,0,1,0,0,-1,o-1/o,1,-1,-1/o,0,1,0,-1,-1,-1/o,0,-1,o-1/o,0,-1,o-1/o,-1,-1,-1/o,1,-1,-1/o],h=[0,1,2,3,4,5,6,7,8,9,10,11];for(i=0;4>i;i++)a.push(0,0,.5,1,1,0);for(t=t||{};--e;)s.subdivide(h,l,a);return r=s.computeNormals(l,h),new n({buffers:[{name:"a_pos",data:l},{name:"a_texCoord",data:a,size:2},{name:"a_normals",data:r},{name:"indices",data:h,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],115:[function(t,e){function i(t){t=t||{};var e=t.detail||30,a=t.holeRadius||.8,r=t.tubeRadius||.2,o=s.generateParametric(e,e,i.generator.bind(null,a,r));return new n({buffers:[{name:"a_pos",data:o.vertices},{name:"a_texCoord",data:s.getSpheroidUV(o.vertices),size:2},{name:"a_normals",data:s.computeNormals(o.vertices,o.indices)},{name:"indices",data:o.indices,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");i.generator=function(t,e,i,n,s){s[0]=(t+e*Math.cos(2*n))*Math.sin(2*i),s[1]=-(t+e*Math.cos(2*n))*Math.cos(2*i),s[2]=e*Math.sin(2*n)},e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],116:[function(t,e){function i(t){t=t||{};for(var e=t.detail||1,i=[],a=[0,0,.5,1,1,0],r=[0,1,2],o=[-1,-1,0,0,1,0,1,-1,0];--e;)s.subdivide(r,o,a);return t.backface!==!1&&s.addBackfaceTriangles(o,r),i=s.computeNormals(o,r),new n({buffers:[{name:"a_pos",data:o},{name:"a_texCoord",data:a,size:2},{name:"a_normals",data:i},{name:"indices",data:r,size:1}]})}var n=t("../Geometry"),s=t("../GeometryHelper");e.exports=i},{"../Geometry":102,"../GeometryHelper":103}],117:[function(t,e){function i(t,e,s,a){a=a||{},this.name=t,this.chunk=e,this.inputs=s?Array.isArray(s)?s:[s]:[],this.uniforms=a.uniforms||{},this.varyings=a.varyings,this.attributes=a.attributes,a.texture&&(this.texture=a.texture.__isATexture__?a.texture:n.register(null,a.texture)),this._id=i.id++,this.invalidations=[],this.__isAMaterial__=!0}var n=t("./TextureRegistry"),s={},a={abs:{glsl:"abs(%1);",output:{4:4,3:3,2:2,1:1}},sign:{glsl:"sign(%1);",output:{4:4,3:3,2:2,1:1}},floor:{glsl:"floor(%1);",output:{4:4,3:3,2:2,1:1}},ceiling:{glsl:"ceil(%1);",output:{4:4,3:3,2:2,1:1}},mod:{glsl:"mod(%1, %2);"},min:{glsl:"min(%1, %2);",output:{4:4,3:3,2:2,1:1}},max:{glsl:"max(%1, %2);",output:{4:4,3:3,2:2,1:1}},clamp:{glsl:"clamp(%1, %2, %3);",output:{"4,1,1":4,"3,1,1":3,"2,1,1":2,"1,1,1":1}},mix:{glsl:"mix(%1, %2, %3);",output:{"4,4,1":4,"3,3,1":3,"2,2,1":2,"1,1,1":1}},step:{glsl:"step(%1, %2, %3);",output:{"1,1":1,"1,2":2,"1,3":3,"1,4":4}},smoothstep:{glsl:"smoothstep(%1);",output:{"1,1,1":1,"2,2,2":2,"3,3,3":3,"4,4,4":4}},fragCoord:{glsl:"gl_FragColor;",output:4},sin:{glsl:"sin(%1);",output:{1:1,2:2,3:3,4:4}},cos:{glsl:"cos(%1);",output:{1:1,2:2,3:3,4:4}},pow:{glsl:"pow(%1, %2);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},sqrt:{glsl:"sqrt(%1);",output:{"1,1":1,"2,2":2,"3,3":3,"1,4":4}},time:{glsl:"time;",output:1},add:{glsl:"%1 + %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},subtract:{glsl:"%1 - %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},multiply:{glsl:"%1 * %2;",output:{"1,1":1,"2,2":2,"3,3":3,"4,4":4,"2,1":2,"3,1":3,"4,1":4}},normal:{glsl:"vec4((v_normal + 1.0) * 0.5, 1.0);",output:4},uv:{glsl:"v_textureCoordinate;",output:2},meshPosition:{glsl:"(v_position + 1.0) * 0.5;",output:3},normalize:{glsl:"normalize(%1)",output:{1:1,2:2,3:3,4:4}},dot:{glsl:"dot(%1, %2);",output:{"1,1":1,"2,2":1,"3,3":1,"4,4":1}},image:{glsl:"texture2D($TEXTURE, v_textureCoordinate);",output:4},constant:{glsl:"%1;"},parameter:{uniforms:{parameter:1},glsl:"parameter;"},vec3:{glsl:"vec3(%1);",output:3},vec2:{glsl:"vec2(%1);",output:2}};s.registerExpression=function(t,e){this[t]=function(n,s){return new i(t,e,n,s)}};for(var r in a)s.registerExpression(r,a[r]);i.id=2,i.prototype.setUniform=function(t,e){this.uniforms[t]=e,this.invalidations.push(t)},e.exports=s,s.Material=i,s.Texture=function(t){return"undefined"==typeof window?console.error("Texture constructor cannot be run inside of a worker"):s.image([],{texture:t})},s.Custom=function(t,e,n){return new i("custom",{glsl:t,output:1,uniforms:n||{}},e)}},{"./TextureRegistry":118}],118:[function(t,e){var i={registry:{},textureIds:1};i.register=function(t,e,i){return t?(this.registry[t]={id:this.textureIds++,__isATexture__:!0,data:e,options:i},this.registry[t]):{id:this.textureIds++,data:e,__isATexture__:!0,options:i}},i.get=function(t){if(this.registry[t])return this.registry[t];throw'Texture "'+t+'" not found!'},e.exports=i},{}],119:[function(t,e){e.exports={Material:t("./Material"),TextureRegistry:t("./TextureRegistry")}},{"./Material":117,"./TextureRegistry":118}],120:[function(t,e){function i(t,e){this._node=t,this._changeQueue=[],this._initialized=!1,this._requestingUpdate=!1,this._inDraw=!1,this.value={drawOptions:{},color:null,expressions:{},geometry:null,flatShading:null,glossiness:null,positionOffset:null,normals:null},e&&this.setDrawOptions(e),this._id=t.addComponent(this)}var n=t("../webgl-geometries");i.prototype.setDrawOptions=function(t){return this._changeQueue.push("GL_SET_DRAW_OPTIONS"),this._changeQueue.push(t),this},i.prototype.getDrawOptions=function(){return this.value.drawOptions},i.prototype.setGeometry=function(t,e){if("string"==typeof t){if(!n[t])throw'Invalid geometry: "'+t+'".';t=new n[t](e)}if((this.value.geometry!==t||this._inDraw)&&(this._initialized&&(this._changeQueue.push("GL_SET_GEOMETRY"),this._changeQueue.push(t.spec.id),this._changeQueue.push(t.spec.type),this._changeQueue.push(t.spec.dynamic)),this._requestUpdate(),this.value.geometry=t),this._initialized&&this._node){for(var i=this.value.geometry.spec.invalidations.length;i--;)this.value.geometry.spec.invalidations.pop(),this._changeQueue.push("GL_BUFFER_DATA"),this._changeQueue.push(this.value.geometry.spec.id),this._changeQueue.push(this.value.geometry.spec.bufferNames[i]),this._changeQueue.push(this.value.geometry.spec.bufferValues[i]),this._changeQueue.push(this.value.geometry.spec.bufferSpacings[i]),this._changeQueue.push(this.value.geometry.spec.dynamic);i&&this._requestUpdate()}return this},i.prototype.getGeometry=function(){return this.value.geometry},i.prototype.setBaseColor=function(t){var e,i=t.__isAMaterial__,n=!!t.getNormalizedRGBA;return i?(this.value.color=null,this.value.expressions.baseColor=t,e=t):n&&(this.value.expressions.baseColor=null,this.value.color=t,e=t.getNormalizedRGBA()),this._initialized&&(i?this._changeQueue.push("MATERIAL_INPUT"):n&&this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_baseColor"),this._changeQueue.push(e)),this._requestUpdate(),this},i.prototype.getBaseColor=function(){return this.value.expressions.baseColor||this.value.color},i.prototype.setFlatShading=function(t){return(this._inDraw||this.value.flatShading!==t)&&(this.value.flatShading=t,this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_flatShading"),this._changeQueue.push(t?1:0)),this._requestUpdate()),this},i.prototype.getFlatShading=function(){return this.value.flatShading},i.prototype.setNormals=function(t){var e=t.__isAMaterial__;return e&&(this.value.expressions.normals=t),this._initialized&&(this._changeQueue.push(e?"MATERIAL_INPUT":"UNIFORM_INPUT"),this._changeQueue.push("u_normals"),this._changeQueue.push(t)),this._requestUpdate(),this},i.prototype.getNormals=function(){return this.value.expressions.normals},i.prototype.setGlossiness=function(t,e){var i=t.__isAMaterial__,n=!!t.getNormalizedRGB;return i?(this.value.glossiness=[null,null],this.value.expressions.glossiness=t):n&&(this.value.expressions.glossiness=null,this.value.glossiness=[t,e||20],t=t?t.getNormalizedRGB():[0,0,0],t.push(e||20)),this._initialized&&(this._changeQueue.push(i?"MATERIAL_INPUT":"GL_UNIFORMS"),this._changeQueue.push("u_glossiness"),this._changeQueue.push(t)),this._requestUpdate(),this},i.prototype.getGlossiness=function(){return this.value.expressions.glossiness||this.value.glossiness},i.prototype.setPositionOffset=function(t){var e,i=t.__isAMaterial__;return i?(this.value.expressions.positionOffset=t,e=t):(this.value.expressions.positionOffset=null,this.value.positionOffset=t,e=this.value.positionOffset),this._initialized&&(this._changeQueue.push(i?"MATERIAL_INPUT":"GL_UNIFORMS"),this._changeQueue.push("u_positionOffset"),this._changeQueue.push(e)),this._requestUpdate(),this},i.prototype.getPositionOffset=function(){return this.value.expressions.positionOffset||this.value.positionOffset},i.prototype.getMaterialExpressions=function(){return this.value.expressions},i.prototype.getValue=function(){return this.value},i.prototype._pushInvalidations=function(t){var e,i=this.value.expressions[t];if(i)for(var n=i.invalidations.length;n--;)e=i.invalidations.pop(),this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand(e),this._node.sendDrawCommand(i.uniforms[e]);return this},i.prototype.onUpdate=function(){var t=this._node,e=this._changeQueue;if(t){if(t.sendDrawCommand("WITH"),t.sendDrawCommand(t.getLocation()),this.value.color&&this.value.color.isActive()&&(this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand("u_baseColor"),this._node.sendDrawCommand(this.value.color.getNormalizedRGBA()),this._node.requestUpdateOnNextTick(this._id)),this.value.glossiness&&this.value.glossiness[0]&&this.value.glossiness[0].isActive()){this._node.sendDrawCommand("GL_UNIFORMS"),this._node.sendDrawCommand("u_glossiness");var i=this.value.glossiness[0].getNormalizedRGB();i.push(this.value.glossiness[1]),this._node.sendDrawCommand(i),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1;this._pushInvalidations("baseColor"),this._pushInvalidations("positionOffset");for(var n=0;n<e.length;n++)t.sendDrawCommand(e[n]);e.length=0}},i.prototype.onMount=function(t,e){this._node=t,this._id=e,this.draw()},i.prototype.onDismount=function(){this._initialized=!1,this._changeQueue.push("GL_REMOVE_MESH"),this._requestUpdate()},i.prototype.onShow=function(){this._changeQueue.push("GL_MESH_VISIBILITY",!0),this._requestUpdate()},i.prototype.onHide=function(){this._changeQueue.push("GL_MESH_VISIBILITY",!1),this._requestUpdate()},i.prototype.onTransformChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_transform"),this._changeQueue.push(t)),this._requestUpdate()},i.prototype.onSizeChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_size"),this._changeQueue.push(t)),this._requestUpdate()},i.prototype.onOpacityChange=function(t){this._initialized&&(this._changeQueue.push("GL_UNIFORMS"),this._changeQueue.push("u_opacity"),this._changeQueue.push(t)),this._requestUpdate()},i.prototype.onAddUIEvent=function(){},i.prototype._requestUpdate=function(){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0)},i.prototype.init=function(){this._initialized=!0,this.onTransformChange(this._node.getTransform()),this.onSizeChange(this._node.getSize()),this.onOpacityChange(this._node.getOpacity()),this._requestUpdate()},i.prototype.draw=function(){this._inDraw=!0,this.init();var t=this.getValue();null!=t.geometry&&this.setGeometry(t.geometry),null!=t.color&&this.setBaseColor(t.color),null!=t.glossiness&&this.setGlossiness.apply(this,t.glossiness),null!=t.drawOptions&&this.setDrawOptions(t.drawOptions),null!=t.flatShading&&this.setFlatShading(t.flatShading),null!=t.expressions.normals&&this.setNormals(t.expressions.normals),null!=t.expressions.baseColor&&this.setBaseColor(t.expressions.baseColor),null!=t.expressions.glossiness&&this.setGlossiness(t.expressions.glossiness),null!=t.expressions.positionOffset&&this.setPositionOffset(t.expressions.positionOffset),this._inDraw=!1},e.exports=i},{"../webgl-geometries":105}],121:[function(t,e){e.exports={Mesh:t("./Mesh"),PointLight:t("./lights/PointLight"),AmbientLight:t("./lights/AmbientLight")}},{"./Mesh":120,"./lights/AmbientLight":122,"./lights/PointLight":124}],122:[function(t,e){function i(t){n.call(this,t),this.commands.color="GL_AMBIENT_LIGHT"}var n=t("./Light");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,e.exports=i},{"./Light":123}],123:[function(t,e){function i(t){this._node=t,this._id=t.addComponent(this),this._requestingUpdate=!1,this.queue=[],this._color=null,this.commands={color:"GL_LIGHT_COLOR"}}i.prototype.setColor=function(t){if(!t.getNormalizedRGB)return!1;this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this._color=t,this.queue.push(this.commands.color);var e=this._color.getNormalizedRGB();return this.queue.push(e[0]),this.queue.push(e[1]),this.queue.push(e[2]),this},i.prototype.getColor=function(){return this._color},i.prototype.onUpdate=function(){var t=this._node.getLocation();this._node.sendDrawCommand("WITH").sendDrawCommand(t);for(var e=this.queue.length;e--;)this._node.sendDrawCommand(this.queue.shift());if(this._color&&this._color.isActive()){this._node.sendDrawCommand(this.commands.color);var i=this._color.getNormalizedRGB();this._node.sendDrawCommand(i[0]),this._node.sendDrawCommand(i[1]),this._node.sendDrawCommand(i[2]),this._node.requestUpdateOnNextTick(this._id)}else this._requestingUpdate=!1},e.exports=i},{}],124:[function(t,e){function i(t){n.call(this,t),this.commands.position="GL_LIGHT_POSITION",this.onTransformChange(t.getTransform())}var n=t("./Light");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.onTransformChange=function(t){this._requestingUpdate||(this._node.requestUpdate(this._id),this._requestingUpdate=!0),this.queue.push(this.commands.position),this.queue.push(t[12]),this.queue.push(t[13]),this.queue.push(t[14])},e.exports=i},{"./Light":123}],125:[function(t,e){function i(t,e,i){this.buffer=null,this.target=t,this.type=e,this.data=[],this.gl=i}i.prototype.subData=function(){for(var t=this.gl,e=[],i=0,n=1e4;i<this.data.length;i+=n)e=Array.prototype.concat.apply(e,this.data.slice(i,i+n));this.buffer=this.buffer||t.createBuffer(),t.bindBuffer(this.target,this.buffer),t.bufferData(this.target,new this.type(e),t.STATIC_DRAW)
},e.exports=i},{}],126:[function(t,e){function i(t){this.gl=t,this.registry={},this._dynamicBuffers=[],this._staticBuffers=[],this._arrayBufferMax=3e4,this._elementBufferMax=3e4}var n="indices",s=t("./Buffer");i.prototype.allocate=function(t,e,i,a,r){var o,l,h,u,c=this.registry[t]||(this.registry[t]={keys:[],values:[],spacing:[],offset:[],length:[]}),p=c.keys.indexOf(e),d=e===n,m=!1,f=0;if(-1===p){if(p=c.keys.length,l=d?i.length:Math.floor(i.length/a),r)h=new s(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._dynamicBuffers.push({buffer:h,offset:i.length,isIndex:d});else{for(u=0;u<this._staticBuffers.length;u++)if(d===this._staticBuffers[u].isIndex&&(o=this._staticBuffers[u].offset+i.length,!d&&o<this._arrayBufferMax||d&&o<this._elementBufferMax)){h=this._staticBuffers[u].buffer,f=this._staticBuffers[u].offset,this._staticBuffers[u].offset+=i.length,m=!0;break}m||(h=new s(d?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,d?Uint16Array:Float32Array,this.gl),this._staticBuffers.push({buffer:h,offset:i.length,isIndex:d}))}c.keys.push(e),c.values.push(h),c.spacing.push(a),c.offset.push(f),c.length.push(l)}var g=i.length;for(u=0;g>u;u++)c.values[p].data[f+u]=i[u];c.values[p].subData()},e.exports=i},{"./Buffer":125}],127:[function(t,e){function i(t,e){return function(){var i=t.apply(this,arguments);return e.apply(this,arguments),i}}function n(t,e){var i="body,html{background:#e3e3e3;font-family:monaco,monospace;font-size:14px;line-height:1.7em}#shaderReport{left:0;top:0;right:0;box-sizing:border-box;position:absolute;z-index:1000;color:#222;padding:15px;white-space:normal;list-style-type:none;margin:50px auto;max-width:1200px}#shaderReport li{background-color:#fff;margin:13px 0;box-shadow:0 1px 2px rgba(0,0,0,.15);padding:20px 30px;border-radius:2px;border-left:20px solid #e01111}span{color:#e01111;text-decoration:underline;font-weight:700}#shaderReport li p{padding:0;margin:0}#shaderReport li:nth-child(even){background-color:#f4f4f4}#shaderReport li p:first-child{margin-bottom:10px;color:#666}",n=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(n),n.textContent=i;var s=document.createElement("ul");s.setAttribute("id","shaderReport"),document.body.appendChild(s);for(var a,r=/ERROR: [\d]+:([\d]+): (.+)/gim,o=e.split("\n");null!=(a=r.exec(t));){a.index===r.lastIndex&&r.lastIndex++;var l=document.createElement("li"),h='<p><span>ERROR</span> "'+a[2]+'" in line '+a[1]+"</p>";h+="<p><b>"+o[a[1]-1].replace(/^[ \t]+/g,"")+"</b></p>",l.innerHTML=h,s.appendChild(l)}}e.exports=function(){return i(this.gl.compileShader,function(t){if(!this.getShaderParameter(t,this.COMPILE_STATUS)){var e=this.getShaderInfoLog(t),i=this.getShaderSource(t);n(e,i)}})}},{}],128:[function(t,e){function i(t,e){this.gl=t,this.textureSlots=1,this.options=e||{},this.registeredMaterials={},this.flaggedUniforms=[],this.cachedUniforms={},this.uniformTypes=[],this.definitionVec4=[],this.definitionVec3=[],this.definitionFloat=[],this.applicationVec3=[],this.applicationVec4=[],this.applicationFloat=[],this.applicationVert=[],this.definitionVert=[],this.resetProgram()}var n=t("../utilities/clone"),s=t("../utilities/keyValueToArrays"),a=t("../webgl-shaders").vertex,r=t("../webgl-shaders").fragment,o=t("./Debug"),l=35633,h=35632,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c="precision mediump float;\n",p={undefined:"float ",1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 ",16:"mat4 "},d={u_baseColor:"vec4",u_normals:"vert",u_glossiness:"vec4",u_positionOffset:"vert"},m={vert:1,vec3:2,vec4:4,"float":8},f=s({u_perspective:u,u_view:u,u_resolution:[0,0,0],u_transform:u,u_size:[1,1,1],u_time:0,u_opacity:1,u_metalness:0,u_glossiness:[0,0,0,0],u_baseColor:[1,1,1,1],u_normals:[1,1,1],u_positionOffset:[0,0,0],u_lightPosition:u,u_lightColor:u,u_ambientLight:[0,0,0],u_flatShading:0,u_numLights:0}),g=s({a_pos:[0,0,0],a_texCoord:[0,0],a_normals:[0,0,0]}),y=s({v_textureCoordinate:[0,0],v_normal:[0,0,0],v_position:[0,0,0],v_eyeVector:[0,0,0]});i.prototype.registerMaterial=function(t,e){var i=e,n=d[t],s=m[n];if((this.registeredMaterials[e._id]&s)===s)return this;var a;for(a in i.uniforms)-1===f.keys.indexOf(a)&&(f.keys.push(a),f.values.push(i.uniforms[a]));for(a in i.varyings)-1===y.keys.indexOf(a)&&(y.keys.push(a),y.values.push(i.varyings[a]));for(a in i.attributes)-1===g.keys.indexOf(a)&&(g.keys.push(a),g.values.push(i.attributes[a]));return this.registeredMaterials[e._id]|=s,"float"===n&&(this.definitionFloat.push(e.defines),this.definitionFloat.push("float fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationFloat.push("if (int(abs(ID)) == "+e._id+") return fa_"+e._id+"();")),"vec3"===n&&(this.definitionVec3.push(e.defines),this.definitionVec3.push("vec3 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVec3.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vec4"===n&&(this.definitionVec4.push(e.defines),this.definitionVec4.push("vec4 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVec4.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),"vert"===n&&(this.definitionVert.push(e.defines),this.definitionVert.push("vec3 fa_"+e._id+"() {\n "+i.glsl+" \n}"),this.applicationVert.push("if (int(abs(ID.x)) == "+e._id+") return fa_"+e._id+"();")),this.resetProgram()},i.prototype.resetProgram=function(){var t,e,i,s,o,u,d=[c],m=[c];for(this.uniformLocations=[],this.attributeLocations={},this.uniformTypes={},this.attributeNames=n(g.keys),this.attributeValues=n(g.values),this.varyingNames=n(y.keys),this.varyingValues=n(y.values),this.uniformNames=n(f.keys),this.uniformValues=n(f.values),this.flaggedUniforms=[],this.cachedUniforms={},m.push("uniform sampler2D u_textures[7];\n"),this.applicationVert.length&&d.push("uniform sampler2D u_textures[7];\n"),u=0;u<this.uniformNames.length;u++)s=this.uniformNames[u],o=this.uniformValues[u],d.push("uniform "+p[o.length]+s+";\n"),m.push("uniform "+p[o.length]+s+";\n");for(u=0;u<this.attributeNames.length;u++)s=this.attributeNames[u],o=this.attributeValues[u],d.push("attribute "+p[o.length]+s+";\n");for(u=0;u<this.varyingNames.length;u++)s=this.varyingNames[u],o=this.varyingValues[u],d.push("varying "+p[o.length]+s+";\n"),m.push("varying "+p[o.length]+s+";\n");e=d.join("")+a.replace("#vert_definitions",this.definitionVert.join("\n")).replace("#vert_applications",this.applicationVert.join("\n")),t=m.join("")+r.replace("#vec3_definitions",this.definitionVec3.join("\n")).replace("#vec3_applications",this.applicationVec3.join("\n")).replace("#vec4_definitions",this.definitionVec4.join("\n")).replace("#vec4_applications",this.applicationVec4.join("\n")).replace("#float_definitions",this.definitionFloat.join("\n")).replace("#float_applications",this.applicationFloat.join("\n")),i=this.gl.createProgram(),this.gl.attachShader(i,this.compileShader(this.gl.createShader(l),e)),this.gl.attachShader(i,this.compileShader(this.gl.createShader(h),t)),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.program=i,this.gl.useProgram(this.program)):(console.error("link error: "+this.gl.getProgramInfoLog(i)),this.program=null),this.setUniforms(this.uniformNames,this.uniformValues);var _=this.gl.getUniformLocation(this.program,"u_textures[0]");return this.gl.uniform1iv(_,[0,1,2,3,4,5,6]),this},i.prototype.uniformIsCached=function(t,e){if(null==this.cachedUniforms[t])return this.cachedUniforms[t]=e.length?new Float32Array(e):e,!1;if(e.length){for(var i=e.length;i--;)if(e[i]!==this.cachedUniforms[t][i]){for(i=e.length;i--;)this.cachedUniforms[t][i]=e[i];return!1}}else if(this.cachedUniforms[t]!==e)return this.cachedUniforms[t]=e,!1;return!0},i.prototype.setUniforms=function(t,e){var i,n,s,a,r,o=this.gl;if(!this.program)return this;for(a=t.length,r=0;a>r;r++)if(s=t[r],n=e[r],i=this.uniformLocations[s]||o.getUniformLocation(this.program,s),i&&(this.uniformLocations[s]=i,!this.uniformIsCached(s,n)))switch(this.uniformTypes[s]||(this.uniformTypes[s]=this.getUniformTypeFromValue(n)),this.uniformTypes[s]){case"uniform4fv":o.uniform4fv(i,n);break;case"uniform3fv":o.uniform3fv(i,n);break;case"uniform2fv":o.uniform2fv(i,n);break;case"uniform1fv":o.uniform1fv(i,n);break;case"uniform1f":o.uniform1f(i,n);break;case"uniformMatrix3fv":o.uniformMatrix3fv(i,!1,n);break;case"uniformMatrix4fv":o.uniformMatrix4fv(i,!1,n)}return this},i.prototype.getUniformTypeFromValue=function(t){if(Array.isArray(t)||t instanceof Float32Array)switch(t.length){case 1:return"uniform1fv";case 2:return"uniform2fv";case 3:return"uniform3fv";case 4:return"uniform4fv";case 9:return"uniformMatrix3fv";case 16:return"uniformMatrix4fv"}else if(!isNaN(parseFloat(t))&&isFinite(t))return"uniform1f";throw'cant load uniform "'+name+'" with value:'+JSON.stringify(t)},i.prototype.compileShader=function(t,e){var i=1;return this.options.debug&&(this.gl.compileShader=o.call(this)),this.gl.shaderSource(t,e),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS)||(console.error("compile error: "+this.gl.getShaderInfoLog(t)),console.error("1: "+e.replace(/\n/g,function(){return"\n"+(i+=1)+": "}))),t},e.exports=i},{"../utilities/clone":95,"../utilities/keyValueToArrays":97,"../webgl-shaders":136,"./Debug":127}],129:[function(t,e){function i(t,e){e=e||{},this.id=t.createTexture(),this.width=e.width||0,this.height=e.height||0,this.mipmap=e.mipmap,this.format=e.format||"RGBA",this.type=e.type||"UNSIGNED_BYTE",this.gl=t,this.bind(),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[e.magFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[e.minFilter]||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[e.wrapS]||t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[e.wrapT]||t.CLAMP_TO_EDGE)}i.prototype.bind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,this.id),this},i.prototype.unbind=function(){return this.gl.bindTexture(this.gl.TEXTURE_2D,null),this},i.prototype.setImage=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.gl[this.format],this.gl[this.type],t),this.mipmap&&this.gl.generateMipmap(this.gl.TEXTURE_2D),this},i.prototype.setArray=function(t){return this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl[this.format],this.width,this.height,0,this.gl[this.format],this.gl[this.type],t),this},i.prototype.readBack=function(t,e,i,n){var s,a=this.gl;t=t||0,e=e||0,i=i||this.width,n=n||this.height;var r=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,r),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.id,0),a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE&&(s=new Uint8Array(i*n*4),a.readPixels(t,e,i,n,a.RGBA,a.UNSIGNED_BYTE,s)),s},e.exports=i},{}],130:[function(t,e){function i(t){this.registry=[],this._needsResample=[],this._activeTexture=0,this._boundTexture=null,this._checkerboard=a(),this.gl=t}function n(t,e){var i=("string"==typeof t?new Image:t)||{};return i.crossOrigin="anonymous",i.src||(i.src=t),i.complete?e(i):i.onload=function(){e(i)},i}var s=t("./Texture"),a=t("./createCheckerboard");i.prototype.update=function(t){for(var e=this.registry.length,i=1;e>i;i++){var n=this.registry[i];n&&n.isLoaded&&n.resampleRate&&(!n.lastResample||t-n.lastResample>n.resampleRate)&&(this._needsResample[n.id]||(this._needsResample[n.id]=!0,n.lastResample=t))}},i.prototype.register=function(t,e){var i,a=t.data,r=t.id,o=t.options||{},l=this.registry[r];return l||(l=new s(this.gl,o),l.setImage(this._checkerboard),i=this.registry[r]={resampleRate:o.resampleRate||null,lastResample:null,isLoaded:!1,texture:l,source:a,id:r,slot:e},Array.isArray(a)||a instanceof Uint8Array||a instanceof Float32Array?(this.bindTexture(r),l.setArray(a),i.isLoaded=!0):window&&a instanceof window.HTMLVideoElement?a.addEventListener("loadeddata",function(){this.bindTexture(r),l.setImage(a),i.isLoaded=!0,i.source=a}.bind(this)):"string"==typeof a&&n(a,function(t){this.bindTexture(r),l.setImage(t),i.isLoaded=!0,i.source=t}.bind(this))),r},i.prototype.bindTexture=function(t){var e=this.registry[t];this._activeTexture!==e.slot&&(this.gl.activeTexture(this.gl.TEXTURE0+e.slot),this._activeTexture=e.slot),this._boundTexture!==t&&(this._boundTexture=t,e.texture.bind()),this._needsResample[e.id]&&(e.texture.setImage(e.source),this._needsResample[e.id]=!1)},e.exports=i},{"./Texture":129,"./createCheckerboard":133}],131:[function(t,e){function i(t,e){t.classList.add("famous-webgl-renderer"),this.canvas=t,this.compositor=e;for(var i in this.constructor.DEFAULT_STYLES)this.canvas.style[i]=this.constructor.DEFAULT_STYLES[i];var r=this.gl=this.getWebGLContext(this.canvas);r.clearColor(0,0,0,0),r.polygonOffset(.1,.1),r.enable(r.POLYGON_OFFSET_FILL),r.enable(r.DEPTH_TEST),r.enable(r.BLEND),r.depthFunc(r.LEQUAL),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.CULL_FACE),r.cullFace(r.BACK),this.meshRegistry={},this.meshRegistryKeys=[],this.cutoutRegistry={},this.cutoutRegistryKeys=[],this.numLights=0,this.ambientLightColor=[0,0,0],this.lightRegistry={},this.lightRegistryKeys=[],this.lightPositions=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lightColors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.textureManager=new l(r),this.texCache={},this.bufferRegistry=new s(r),this.program=new n(r,{debug:!0}),this.state={boundArrayBuffer:null,boundElementBuffer:null,lastDrawn:null,enabledAttributes:{},enabledAttributesKeys:[]},this.resolutionName=["u_resolution"],this.resolutionValues=[],this.cachedSize=[],this.projectionTransform=[1,0,0,0,0,1,0,0,0,0,-1e-6,0,-1,1,0,1];var o=this.cutoutGeometry=new a;this.bufferRegistry.allocate(o.spec.id,"a_pos",o.spec.bufferValues[0],3),this.bufferRegistry.allocate(o.spec.id,"a_texCoord",o.spec.bufferValues[1],2),this.bufferRegistry.allocate(o.spec.id,"a_normals",o.spec.bufferValues[2],3),this.bufferRegistry.allocate(o.spec.id,"indices",o.spec.bufferValues[3],1)}var n=t("./Program"),s=t("./BufferRegistry"),a=t("../webgl-geometries/primitives/Plane"),r=t("./radixSort"),o=t("../utilities/keyValueToArrays"),l=t("./TextureManager"),h=t("./compileMaterial"),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c=o({u_numLights:0,u_ambientLight:new Array(3),u_lightPosition:new Array(3),u_lightColor:new Array(3),u_perspective:new Array(16),u_time:0,u_view:new Array(16)});i.prototype.getWebGLContext=function(t){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,n=0;n<e.length;n++){try{i=t.getContext(e[n])}catch(t){var s="Error creating WebGL context: "+t.prototype.toString();console.error(s)}if(i)break}return i?i:!1},i.prototype.createLight=function(t){return this.numLights++,this.lightRegistryKeys.push(t),this.lightRegistry[t]={color:[0,0,0],position:[0,0,0]},this.lightRegistry[t]},i.prototype.createMesh=function(t){this.meshRegistryKeys.push(t);var e=o({u_opacity:1,u_transform:u,u_size:[0,0,0],u_baseColor:[.5,.5,.5,1],u_positionOffset:[0,0,0],u_normals:[0,0,0],u_flatShading:0,u_glossiness:[0,0,0,0]});return this.meshRegistry[t]={depth:null,uniformKeys:e.keys,uniformValues:e.values,buffers:{},geometry:null,drawType:null,textures:[],visible:!0},this.meshRegistry[t]},i.prototype.setCutoutState=function(t,e){var i=this.getOrSetCutout(t);i.visible=e},i.prototype.getOrSetCutout=function(t){if(this.cutoutRegistry[t])return this.cutoutRegistry[t];var e=o({u_opacity:0,u_transform:u.slice(),u_size:[0,0,0],u_origin:[0,0,0],u_baseColor:[0,0,0,1]});return this.cutoutRegistryKeys.push(t),this.cutoutRegistry[t]={uniformKeys:e.keys,uniformValues:e.values,geometry:this.cutoutGeometry.spec.id,drawType:this.cutoutGeometry.spec.type,visible:!0},this.cutoutRegistry[t]},i.prototype.setMeshVisibility=function(t,e){var i=this.meshRegistry[t]||this.createMesh(t);i.visible=e},i.prototype.removeMesh=function(t){var e=this.meshRegistryKeys.indexOf(t);this.meshRegistryKeys.splice(e,1),this.meshRegistry[t]=null},i.prototype.setCutoutUniform=function(t,e,i){var n=this.getOrSetCutout(t),s=n.uniformKeys.indexOf(e);if(Array.isArray(i))for(var a=0,r=i.length;r>a;a++)n.uniformValues[s][a]=i[a];else n.uniformValues[s]=i},i.prototype.setMeshOptions=function(t,e){var i=this.meshRegistry[t]||this.createMesh(t);return i.options=e,this},i.prototype.setAmbientLightColor=function(t,e,i,n){return this.ambientLightColor[0]=e,this.ambientLightColor[1]=i,this.ambientLightColor[2]=n,this},i.prototype.setLightPosition=function(t,e,i,n){var s=this.lightRegistry[t]||this.createLight(t);return s.position[0]=e,s.position[1]=i,s.position[2]=n,this},i.prototype.setLightColor=function(t,e,i,n){var s=this.lightRegistry[t]||this.createLight(t);return s.color[0]=e,s.color[1]=i,s.color[2]=n,this},i.prototype.handleMaterialInput=function(t,e,i){var n=this.meshRegistry[t]||this.createMesh(t);i=h(i,n.textures.length),n.uniformValues[n.uniformKeys.indexOf(e)][0]=-i._id;for(var s=i.textures.length;s--;)n.textures.push(this.textureManager.register(i.textures[s],n.textures.length+s));return this.program.registerMaterial(e,i),this.updateSize()},i.prototype.setGeometry=function(t,e,i,n){var s=this.meshRegistry[t]||this.createMesh(t);return s.geometry=e,s.drawType=i,s.dynamic=n,this},i.prototype.setMeshUniform=function(t,e,i){var n=this.meshRegistry[t]||this.createMesh(t),s=n.uniformKeys.indexOf(e);-1===s?(n.uniformKeys.push(e),n.uniformValues.push(i)):n.uniformValues[s]=i},i.prototype.bufferData=function(t,e,i,n,s,a){return this.bufferRegistry.allocate(e,i,n,s,a),this},i.prototype.draw=function(t){var e=this.compositor.getTime();this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textureManager.update(e),this.meshRegistryKeys=r(this.meshRegistryKeys,this.meshRegistry),this.setGlobalUniforms(t),this.drawCutouts(),this.drawMeshes()},i.prototype.drawMeshes=function(){for(var t,e,i=this.gl,n=0;n<this.meshRegistryKeys.length;n++)if(e=this.meshRegistry[this.meshRegistryKeys[n]],t=this.bufferRegistry.registry[e.geometry],e.visible&&(e.uniformValues[0]<1?(i.depthMask(!1),i.enable(i.BLEND)):(i.depthMask(!0),i.disable(i.BLEND)),t)){for(var s=e.textures.length;s--;)this.textureManager.bindTexture(e.textures[s]);e.options&&this.handleOptions(e.options,e),this.program.setUniforms(e.uniformKeys,e.uniformValues),this.drawBuffers(t,e.drawType,e.geometry),e.options&&this.resetOptions(e.options)}},i.prototype.drawCutouts=function(){var t,e,i=this.cutoutRegistryKeys.length;i&&(this.gl.enable(this.gl.BLEND),this.gl.depthMask(!0));for(var n=0;i>n;n++)t=this.cutoutRegistry[this.cutoutRegistryKeys[n]],e=this.bufferRegistry.registry[t.geometry],t.visible&&(this.program.setUniforms(t.uniformKeys,t.uniformValues),this.drawBuffers(e,t.drawType,t.geometry))},i.prototype.setGlobalUniforms=function(t){for(var e,i,n=0,s=this.lightRegistryKeys.length;s>n;n++)e=this.lightRegistry[this.lightRegistryKeys[n]],i=4*n,this.lightPositions[0+i]=e.position[0],this.lightPositions[1+i]=e.position[1],this.lightPositions[2+i]=e.position[2],this.lightColors[0+i]=e.color[0],this.lightColors[1+i]=e.color[1],this.lightColors[2+i]=e.color[2];c.values[0]=this.numLights,c.values[1]=this.ambientLightColor,c.values[2]=this.lightPositions,c.values[3]=this.lightColors,this.projectionTransform[0]=1/(.5*this.cachedSize[0]),this.projectionTransform[5]=-1/(.5*this.cachedSize[1]),this.projectionTransform[11]=t.perspectiveTransform[11],c.values[4]=this.projectionTransform,c.values[5]=.001*this.compositor.getTime(),c.values[6]=t.viewTransform,this.program.setUniforms(c.keys,c.values)},i.prototype.drawBuffers=function(t,e,i){var n,s,a,r,o,l,h,u,c=this.gl,p=0;for(l=t.keys.length,u=0;l>u;u++)n=t.keys[u],"indices"!==n?(s=this.program.attributeLocations[n],-1!==s&&(void 0!==s||(s=c.getAttribLocation(this.program.program,n),this.program.attributeLocations[n]=s,-1!==s))&&(this.state.enabledAttributes[n]||(c.enableVertexAttribArray(s),this.state.enabledAttributes[n]=!0,this.state.enabledAttributesKeys.push(n)),o=t.values[u],a=t.spacing[u],r=t.offset[u],p=t.length[u],this.state.boundArrayBuffer!==o&&(c.bindBuffer(o.target,o.buffer),this.state.boundArrayBuffer=o),this.state.lastDrawn!==i&&c.vertexAttribPointer(s,a,c.FLOAT,c.FALSE,0,4*r))):h=u;var d=this.state.enabledAttributesKeys.length;for(u=0;d>u;u++){var m=this.state.enabledAttributesKeys[u];this.state.enabledAttributes[m]&&-1===t.keys.indexOf(m)&&(c.disableVertexAttribArray(this.program.attributeLocations[m]),this.state.enabledAttributes[m]=!1)}p&&(void 0!==h?(o=t.values[h],r=t.offset[h],a=t.spacing[h],p=t.length[h],this.state.boundElementBuffer!==o&&(c.bindBuffer(o.target,o.buffer),this.state.boundElementBuffer=o),c.drawElements(c[e],p,c.UNSIGNED_SHORT,2*r)):c.drawArrays(c[e],0,p)),this.state.lastDrawn=i},i.prototype.updateSize=function(t){return t&&(this.cachedSize[0]=t[0],this.cachedSize[1]=t[1],this.cachedSize[2]=t[0]>t[1]?t[0]:t[1]),this.gl.viewport(0,0,this.cachedSize[0],this.cachedSize[1]),this.resolutionValues[0]=this.cachedSize,this.program.setUniforms(this.resolutionName,this.resolutionValues),this},i.prototype.handleOptions=function(t,e){var i=this.gl;t&&("double"===t.side&&(this.gl.cullFace(this.gl.FRONT),this.drawBuffers(this.bufferRegistry.registry[e.geometry],e.drawType,e.geometry),this.gl.cullFace(this.gl.BACK)),t.blending&&i.blendFunc(i.SRC_ALPHA,i.ONE),"back"===t.side&&i.cullFace(i.FRONT))},i.prototype.resetOptions=function(t){var e=this.gl;t&&(t.blending&&e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),"back"===t.side&&e.cullFace(e.BACK))},i.DEFAULT_STYLES={pointerEvents:"none",position:"absolute",zIndex:1,top:"0px",left:"0px"},e.exports=i},{"../utilities/keyValueToArrays":97,"../webgl-geometries/primitives/Plane":112,"./BufferRegistry":126,"./Program":128,"./TextureManager":130,"./compileMaterial":132,"./radixSort":135}],132:[function(t,e){function i(t,e){var i="",l={},u={},c={},p=[],d=[];return n(t,function(t){if(t.chunk){var n=h[s(t)],m=r(t),f=a(t.chunk.glsl,t.inputs,d.length+e);i+=n+m+" = "+f+"\n ",t.uniforms&&o(l,t.uniforms),t.varyings&&o(u,t.varyings),t.attributes&&o(c,t.attributes),t.chunk.defines&&p.push(t.chunk.defines),t.texture&&d.push(t.texture)}}),{_id:t._id,glsl:i+"return "+r(t)+";",defines:p.join("\n"),uniforms:l,varyings:u,attributes:c,textures:d}}function n(t,e){for(var i=t.inputs,s=i&&i.length,a=-1;++a<s;)n(i[a],e);return e(t),t}function s(t){if("number"==typeof t)return 1;if(Array.isArray(t))return t.length;var e=t.chunk.output;if("number"==typeof e)return e;var i=t.inputs.map(function(t){return s(t)}).join(",");return e[i]}function a(t,e,i){return t.replace(/%\d/g,function(t){return r(e[t[1]-1])}).replace(/\$TEXTURE/,"u_textures["+i+"]")}function r(t){return Array.isArray(t)?l(t):"object"==typeof t?"fa_"+t._id:t.toFixed(6)}function o(t,e){for(var i in e)t[i]=e[i]}function l(t){var e=t.length;return"vec"+e+"("+t.join(",")+")"}var h={1:"float ",2:"vec2 ",3:"vec3 ",4:"vec4 "};e.exports=i},{}],133:[function(t,e){function i(){var t=document.createElement("canvas").getContext("2d");t.canvas.width=t.canvas.height=128;for(var e=0;e<t.canvas.height;e+=16)for(var i=0;i<t.canvas.width;i+=16)t.fillStyle=16&(i^e)?"#FFF":"#DDD",t.fillRect(i,e,16,16);return t.canvas}e.exports=i},{}],134:[function(t,e){e.exports={Buffer:t("./Buffer"),BufferRegistry:t("./BufferRegistry"),createCheckerboard:t("./createCheckerboard"),Program:t("./Program"),WebGLRenderer:t("./WebGLRenderer"),Texture:t("./Texture")}},{"./Buffer":125,"./BufferRegistry":126,"./Program":128,"./Texture":129,"./WebGLRenderer":131,"./createCheckerboard":133}],135:[function(t,e){function i(t,e,i){var n=t[i],s=e[n];return(s.depth?s.depth:e[n].uniformValues[1][14])+g}function n(t,e,i,n){var s=t[i];return e[s].depth=r(n)-g,s}function s(t,e,i){e[t[i]].depth=null}function a(t){return _[0]=t,v[0]}function r(t){return v[0]=t,_[0]}function o(t,e){var r,o,p,g,y,_,v,S,x,b,T,A=0,w=[];for(m=32/l+.999999999999999|0,r=0,g=h*m;g>r;r++)c[r]=0;for(r=0,g=t.length;g>r;r++){for(y=a(i(t,e,r)),y^=y>>31|2147483648,o=0,p=0;f>o;o+=h,p+=l)c[o+(y>>>p&u)]++;c[o+(y>>>p&d)]++}for(o=0;f>=o;o+=h)for(S=o,x=0;o+h>S;S++)b=c[S]+x,c[S]=x-1,x=b;if(--m){for(r=0,g=t.length;g>r;r++)y=a(i(t,e,r)),w[++c[y&u]]=n(t,e,r,y^=y>>31|2147483648);for(v=w,w=t,t=v;++A<m;){for(r=0,g=t.length,_=A*h,T=A*l;g>r;r++)y=a(i(t,e,r)),w[++c[_+(y>>>T&u)]]=t[r];v=w,w=t,t=v}}for(r=0,g=t.length,_=A*h,T=A*l;g>r;r++)y=a(i(t,e,r)),w[++c[_+(y>>>T&d)]]=n(t,e,r,y^(~y>>31|2147483648)),s(t,e,r);return w}var l=11,h=1<<l,u=h-1,c=new Array(h*Math.ceil(64/l)),p=1<<31%l,d=(p<<1)-1,m=32/l+.999999999999999|0,f=h*(m-1),g=Math.pow(20,6),y=new ArrayBuffer(4),_=new Float32Array(y,0,1),v=new Int32Array(y,0,1);e.exports=o},{}],136:[function(t,e){var i=(t("glslify"),t("glslify/simple-adapter.js")("\n#define GLSLIFY 1\n\nmat3 a_x_getNormalMatrix(in mat4 t) {\n  mat3 matNorm;\n  mat4 a = t;\n  float a00 = a[0][0], a01 = a[0][1], a02 = a[0][2], a03 = a[0][3], a10 = a[1][0], a11 = a[1][1], a12 = a[1][2], a13 = a[1][3], a20 = a[2][0], a21 = a[2][1], a22 = a[2][2], a23 = a[2][3], a30 = a[3][0], a31 = a[3][1], a32 = a[3][2], a33 = a[3][3], b00 = a00 * a11 - a01 * a10, b01 = a00 * a12 - a02 * a10, b02 = a00 * a13 - a03 * a10, b03 = a01 * a12 - a02 * a11, b04 = a01 * a13 - a03 * a11, b05 = a02 * a13 - a03 * a12, b06 = a20 * a31 - a21 * a30, b07 = a20 * a32 - a22 * a30, b08 = a20 * a33 - a23 * a30, b09 = a21 * a32 - a22 * a31, b10 = a21 * a33 - a23 * a31, b11 = a22 * a33 - a23 * a32, det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  det = 1.0 / det;\n  matNorm[0][0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  matNorm[0][1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  matNorm[0][2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  matNorm[1][0] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  matNorm[1][1] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  matNorm[1][2] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  matNorm[2][0] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  matNorm[2][1] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  matNorm[2][2] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return matNorm;\n}\nfloat b_x_inverse(float m) {\n  return 1.0 / m;\n}\nmat2 b_x_inverse(mat2 m) {\n  return mat2(m[1][1], -m[0][1], -m[1][0], m[0][0]) / (m[0][0] * m[1][1] - m[0][1] * m[1][0]);\n}\nmat3 b_x_inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11), b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10), b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\nmat4 b_x_inverse(mat4 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3], a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3], a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3], a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3], b00 = a00 * a11 - a01 * a10, b01 = a00 * a12 - a02 * a10, b02 = a00 * a13 - a03 * a10, b03 = a01 * a12 - a02 * a11, b04 = a01 * a13 - a03 * a11, b05 = a02 * a13 - a03 * a12, b06 = a20 * a31 - a21 * a30, b07 = a20 * a32 - a22 * a30, b08 = a20 * a33 - a23 * a30, b09 = a21 * a32 - a22 * a31, b10 = a21 * a33 - a23 * a31, b11 = a22 * a33 - a23 * a32, det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  return mat4(a11 * b11 - a12 * b10 + a13 * b09, a02 * b10 - a01 * b11 - a03 * b09, a31 * b05 - a32 * b04 + a33 * b03, a22 * b04 - a21 * b05 - a23 * b03, a12 * b08 - a10 * b11 - a13 * b07, a00 * b11 - a02 * b08 + a03 * b07, a32 * b02 - a30 * b05 - a33 * b01, a20 * b05 - a22 * b02 + a23 * b01, a10 * b10 - a11 * b08 + a13 * b06, a01 * b08 - a00 * b10 - a03 * b06, a30 * b04 - a31 * b02 + a33 * b00, a21 * b02 - a20 * b04 - a23 * b00, a11 * b07 - a10 * b09 - a12 * b06, a00 * b09 - a01 * b07 + a02 * b06, a31 * b01 - a30 * b03 - a32 * b00, a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\nfloat c_x_transpose(float m) {\n  return m;\n}\nmat2 c_x_transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0], m[0][1], m[1][1]);\n}\nmat3 c_x_transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0], m[0][1], m[1][1], m[2][1], m[0][2], m[1][2], m[2][2]);\n}\nmat4 c_x_transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0], m[0][1], m[1][1], m[2][1], m[3][1], m[0][2], m[1][2], m[2][2], m[3][2], m[0][3], m[1][3], m[2][3], m[3][3]);\n}\nvec4 applyTransform(vec4 pos) {\n  mat4 MVMatrix = u_view * u_transform;\n  pos.x += 1.0;\n  pos.y -= 1.0;\n  pos.xyz *= u_size * 0.5;\n  pos.y *= -1.0;\n  v_position = (MVMatrix * pos).xyz;\n  v_eyeVector = (u_resolution * 0.5) - v_position;\n  pos = u_perspective * MVMatrix * pos;\n  return pos;\n}\n#vert_definitions\n\nvec3 calculateOffset(vec3 ID) {\n  \n  #vert_applications\n  return vec3(0.0);\n}\nvoid main() {\n  v_textureCoordinate = a_texCoord;\n  vec3 invertedNormals = a_normals + (u_normals.x < 0.0 ? calculateOffset(u_normals) * 2.0 - 1.0 : vec3(0.0));\n  invertedNormals.y *= -1.0;\n  v_normal = c_x_transpose(mat3(b_x_inverse(u_transform))) * invertedNormals;\n  vec3 offsetPos = a_pos + calculateOffset(u_positionOffset);\n  gl_Position = applyTransform(vec4(offsetPos, 1.0));\n}","\n#define GLSLIFY 1\n\n#float_definitions\n\nfloat a_x_applyMaterial(float ID) {\n  \n  #float_applications\n  return 1.;\n}\n#vec3_definitions\n\nvec3 a_x_applyMaterial(vec3 ID) {\n  \n  #vec3_applications\n  return vec3(0);\n}\n#vec4_definitions\n\nvec4 a_x_applyMaterial(vec4 ID) {\n  \n  #vec4_applications\n  return vec4(0);\n}\nvec4 b_x_applyLight(in vec4 baseColor, in vec3 normal, in vec4 glossiness) {\n  int numLights = int(u_numLights);\n  vec3 ambientColor = u_ambientLight * baseColor.rgb;\n  vec3 eyeVector = normalize(v_eyeVector);\n  vec3 diffuse = vec3(0.0);\n  bool hasGlossiness = glossiness.a > 0.0;\n  bool hasSpecularColor = length(glossiness.rgb) > 0.0;\n  for(int i = 0; i < 4; i++) {\n    if(i >= numLights)\n      break;\n    vec3 lightDirection = normalize(u_lightPosition[i].xyz - v_position);\n    float lambertian = max(dot(lightDirection, normal), 0.0);\n    if(lambertian > 0.0) {\n      diffuse += u_lightColor[i].rgb * baseColor.rgb * lambertian;\n      if(hasGlossiness) {\n        vec3 halfVector = normalize(lightDirection + eyeVector);\n        float specularWeight = pow(max(dot(halfVector, normal), 0.0), glossiness.a);\n        vec3 specularColor = hasSpecularColor ? glossiness.rgb : u_lightColor[i].rgb;\n        diffuse += specularColor * specularWeight * lambertian;\n      }\n    }\n  }\n  return vec4(ambientColor + diffuse, baseColor.a);\n}\nvoid main() {\n  vec4 material = u_baseColor.r >= 0.0 ? u_baseColor : a_x_applyMaterial(u_baseColor);\n  bool lightsEnabled = (u_flatShading == 0.0) && (u_numLights > 0.0 || length(u_ambientLight) > 0.0);\n  vec3 normal = normalize(v_normal);\n  vec4 glossiness = u_glossiness.x < 0.0 ? a_x_applyMaterial(u_glossiness) : u_glossiness;\n  vec4 color = lightsEnabled ? b_x_applyLight(material, normalize(v_normal), glossiness) : material;\n  gl_FragColor = color;\n  gl_FragColor.a *= u_opacity;\n}",[],[]));e.exports=i},{glslify:46,"glslify/simple-adapter.js":47}]},{},[40])(40)}),i("helpers/StatsTimer",["require","exports","module"],function(t,e,i){function n(){}n.prototype.createTimer=function(){var t=function(){var t=Date.now(),e=t,i=0,n=1/0,s=0,a=0,r=1/0,o=0,l=0,h=0,u=document.createElement("div");u.id="stats",u.addEventListener("mousedown",function(t){t.preventDefault(),_(++h%2)},!1),u.style.cssText="width:80px;opacity:0.9;cursor:pointer";var c=document.createElement("div");c.id="fps",c.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",u.appendChild(c);var p=document.createElement("div");p.id="fpsText",p.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",p.innerHTML="FPS",c.appendChild(p);var d=document.createElement("div");for(d.id="fpsGraph",d.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",c.appendChild(d);74>d.children.length;){var m=document.createElement("span");
m.style.cssText="width:1px;height:30px;float:left;background-color:#113",d.appendChild(m)}var f=document.createElement("div");f.id="ms",f.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",u.appendChild(f);var g=document.createElement("div");g.id="msText",g.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",g.innerHTML="MS",f.appendChild(g);var y=document.createElement("div");for(y.id="msGraph",y.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",f.appendChild(y);74>y.children.length;)m=document.createElement("span"),m.style.cssText="width:1px;height:30px;float:left;background-color:#131",y.appendChild(m);var _=function(t){switch(h=t){case 0:c.style.display="block",f.style.display="none";break;case 1:c.style.display="none",f.style.display="block"}};return{REVISION:12,domElement:u,setMode:_,begin:function(){t=Date.now()},end:function(){var h=Date.now();i=h-t,n=Math.min(n,i),s=Math.max(s,i),g.textContent=i+" MS ("+n+"-"+s+")";var u=Math.min(30,30-30*(i/200));return y.appendChild(y.firstChild).style.height=u+"px",l++,h>e+1e3&&(a=Math.round(1e3*l/(h-e)),r=Math.min(r,a),o=Math.max(o,a),p.textContent=a+" FPS ("+r+"-"+o+")",u=Math.min(30,30-30*(a/100)),d.appendChild(d.firstChild).style.height=u+"px",e=h,l=0),h},update:function(){t=this.end()}}};"object"==typeof i&&(i.exports=t);var e=new t;return e.setMode(0),e.domElement.style.position="absolute",e.domElement.style.left="0px",e.domElement.style.top="0px",document.body.appendChild(e.domElement),e},i.exports=n}),i("helpers/OrientationController",["require","exports","module"],function(t,e,i){function n(){}n.prototype.constructor=n,n.prototype.reset=function(){this.started=!1,this.baseOrientation=void 0,this.orientationDifference=[0,0,0],this.lastValue={orientationDifference:this.orientationDifference,timeStamp:0},this.orientationDifferenceAt=function(){return this.lastValue.orientationDifference}},n.prototype.interpolate=function(t,e,i,n){var s=function(s){return e+(n-e)*((s-t)/(i-t))};return s.m=(n-e)/(i-t),s.text="y = "+s.m+"x",s},n.prototype.setTimeKeeper=function(t){this.timeKeeper=t,this.reset()},n.prototype.makeOrientationFunction=function(t){var e=this,i=this.lastValue,n=t,s=[void 0,void 0,void 0];s=s.map(function(t,s){var a=i.timeStamp,r=i.orientationDifference[s],o=n.timeStamp,l=n.orientationDifference[s],h=e.interpolate(a,r,o,l);return h}),window.watchh=s;var a=function(t){var e;return e=t>=n.timeStamp?n.orientationDifference:[s[0](t),s[1](t),s[2](t)],this.lastValue={orientationDifference:e,timeStamp:t},e};return a},n.prototype.reInterpolate=function(t,e,i,n){var s=function(s){return e+(n-e)*((s-t)/(i-t))};return s},n.prototype.normalize=function(t){return t[0]=-t[0],t},n.prototype.startListening=function(){var t=this;window.DeviceOrientationEvent&&(t.started=!0,window.addEventListener("deviceorientation",function(e){var i=[e.gamma,e.beta,e.alpha],n=t.normalize(i);t.baseOrientation||(t.baseOrientation=n);var s=n.map(function(t){return t>30?30:-30>t?-30:t}),a={orientationDifference:s,timeStamp:this.timeKeeper.timePassed+50};t.orientationDifferenceAt=t.makeOrientationFunction(a)}))},i.exports=n}),this.createjs=this.createjs||{},function(){var t=createjs.SoundJS=createjs.SoundJS||{};t.version="NEXT",t.buildDate="Tue, 19 May 2015 17:26:59 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n){i[(e+="_")+"constructor"]=n.constructor;for(var s in n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s])}return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){for(var i=0,n=t.length;n>i;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},function(){function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,a){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,s),n&&t.remove()},a)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var a=0,r=s.length;r>a;a++)if(s[a]==e){1==r?delete n[t]:s.splice(a,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t){if("string"==typeof t){var e=this._listeners;if(!e||!e[t])return!1;t=new createjs.Event(t)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(i){}if(t.bubbles&&this.parent){for(var n=this,s=[n];n.parent;)s.push(n=n.parent);var a,r=s.length;for(a=r-1;a>=0&&!t.propagationStopped;a--)s[a]._dispatchEvent(t,1+(0==a));for(a=1;r>a&&!t.propagationStopped;a++)s[a]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var s=n[t.type];if(!s||!(i=s.length))return;try{t.currentTarget=this}catch(a){}try{t.eventPhase=e}catch(a){}t.removed=!1,s=s.slice();for(var r=0;i>r&&!t.immediatePropagationStopped;r++){var o=s[r];o.handleEvent?o.handleEvent(t):o(t),t.removed&&(this.off(t.type,o,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(t,"Event")}(window),this.createjs=this.createjs||{},function(){function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},i=t;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof i)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=i}(),function(){var t={};t.ABSOLUTE_PATT=/^(?:\w+:)?\/{2}/i,t.RELATIVE_PATT=/^[./]*?\//i,t.EXTENSION_PATT=/\/?[^/]+\.(\w{1,5})$/i,t.parseURI=function(e){var i={absolute:!1,relative:!1};if(null==e)return i;var n=e.indexOf("?");n>-1&&(e=e.substr(0,n));var s;return t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(s=e.match(t.EXTENSION_PATT))&&(i.extension=s[1].toLowerCase()),i},t.formatQueryString=function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},t.buildPath=function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var s=t.slice(n+1);i=i.concat(s.split("&"))}return-1!=n?t.slice(0,n)+"?"+this._formatQueryString(e,i):t+"?"+this._formatQueryString(e,i)},t.isCrossDomain=function(t){var e=document.createElement("a");e.href=t.src;var i=document.createElement("a");i.href=location.href;var n=""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname);return n},t.isLocal=function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},t.isBinary=function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},t.isImageTag=function(t){return t instanceof HTMLImageElement},t.isAudioTag=function(t){return window.HTMLAudioElement?t instanceof HTMLAudioElement:!1},t.isVideoTag=function(t){return window.HTMLVideoElement?t instanceof HTMLVideoElement:!1},t.isText=function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},t.getTypeByExtension=function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}},createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;i.POST="POST",i.GET="GET",i.BINARY="binary",i.CSS="css",i.IMAGE="image",i.JAVASCRIPT="javascript",i.JSON="json",i.JSONP="jsonp",i.MANIFEST="manifest",i.SOUND="sound",i.VIDEO="video",i.SPRITESHEET="spritesheet",i.SVG="svg",i.TEXT="text",i.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return null==window.createjs||this.canceled?!0:!1},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this),i=this;e instanceof Function?e(function(t){i._result=t,i._sendComplete()}):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(t.type)}},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),!this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null==this._request)return void this._handleError();this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}},e.setResponseType=function(t){this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(){if(!this.loaded){this.loaded=!0;var t=this._checkError();if(t)return void this._handleError(t);this._response=this._getResponse(),this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);switch(t){case 404:case 0:return new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var a=0,r=s.ACTIVEX_VERSIONS.length;r>a;a++){s.ACTIVEX_VERSIONS[a];try{n=new ActiveXObject(axVersions);break}catch(o){}}if(null==n)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var l=null;if(l=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,n.open(t.method||createjs.AbstractLoader.GET,l,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var h in t.headers)i[h]=t.headers[h];for(h in i)n.setRequestHeader(h,i[h]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){var t=function(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null},e=t.prototype={},i=t;i.create=function(t){if(t instanceof i||t instanceof Object){var e=new createjs.PlayPropsConfig;return e.set(t),e}throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[PlayPropsConfig]"},createjs.PlayPropsConfig=i}(),this.createjs=this.createjs||{},function(){function t(){throw"Sound cannot be instantiated"}function e(t,e){this.init(t,e)}var i=t;i.INTERRUPT_ANY="any",i.INTERRUPT_EARLY="early",i.INTERRUPT_LATE="late",i.INTERRUPT_NONE="none",i.PLAY_INITED="playInited",i.PLAY_SUCCEEDED="playSucceeded",i.PLAY_INTERRUPTED="playInterrupted",i.PLAY_FINISHED="playFinished",i.PLAY_FAILED="playFailed",i.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],i.EXTENSION_MAP={m4a:"mp4"},i.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([/.]*?(?:[^?]+)?\/)?((?:[^/?]+)\.(\w+))(?:\?(\S+)?)?$/,i.defaultInterruptBehavior=i.INTERRUPT_NONE,i.alternateExtensions=[],i.activePlugin=null,i._masterVolume=1,Object.defineProperty(i,"volume",{get:function(){return this._masterVolume},set:function(t){if(null==Number(t))return!1;if(t=Math.max(0,Math.min(1,t)),i._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t))for(var e=this._instances,n=0,s=e.length;s>n;n++)e[n].setMasterVolume(t)}}),i._masterMute=!1,Object.defineProperty(i,"muted",{get:function(){return this._masterMute},set:function(t){if(null==t)return!1;if(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t))for(var e=this._instances,i=0,n=e.length;n>i;i++)e[i].setMasterMute(t);return!0}}),Object.defineProperty(i,"capabilities",{get:function(){return null==i.activePlugin?null:i.activePlugin._capabilities},set:function(){return!1}}),i._pluginsRegistered=!1,i._lastID=0,i._instances=[],i._idHash={},i._preloadHash={},i._defaultPlayPropsHash={},i.addEventListener=null,i.removeEventListener=null,i.removeAllEventListeners=null,i.dispatchEvent=null,i.hasEventListener=null,i._listeners=null,createjs.EventDispatcher.initialize(i),i.getPreloadHandlers=function(){return{callback:createjs.proxy(i.initLoad,i),types:["sound"],extensions:i.SUPPORTED_EXTENSIONS}},i._handleLoadComplete=function(t){var e=t.target.getItem().src;if(i._preloadHash[e])for(var n=0,s=i._preloadHash[e].length;s>n;n++){var a=i._preloadHash[e][n];if(i._preloadHash[e][n]=!0,i.hasEventListener("fileload")){var t=new createjs.Event("fileload");t.src=a.src,t.id=a.id,t.data=a.data,t.sprite=a.sprite,i.dispatchEvent(t)}}},i._handleLoadError=function(t){var e=t.target.getItem().src;if(i._preloadHash[e])for(var n=0,s=i._preloadHash[e].length;s>n;n++){var a=i._preloadHash[e][n];if(i._preloadHash[e][n]=!1,i.hasEventListener("fileerror")){var t=new createjs.Event("fileerror");t.src=a.src,t.id=a.id,t.data=a.data,t.sprite=a.sprite,i.dispatchEvent(t)}}},i._registerPlugin=function(t){return t.isSupported()?(i.activePlugin=new t,!0):!1},i.registerPlugins=function(t){i._pluginsRegistered=!0;for(var e=0,n=t.length;n>e;e++)if(i._registerPlugin(t[e]))return!0;return!1},i.initializeDefaultPlugins=function(){return null!=i.activePlugin?!0:i._pluginsRegistered?!1:i.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])?!0:!1},i.isReady=function(){return null!=i.activePlugin},i.getCapabilities=function(){return null==i.activePlugin?null:i.activePlugin._capabilities},i.getCapability=function(t){return null==i.activePlugin?null:i.activePlugin._capabilities[t]},i.initLoad=function(t){return i._registerSound(t)},i._registerSound=function(t){if(!i.initializeDefaultPlugins())return!1;var n;if(t.src instanceof Object?(n=i._parseSrc(t.src),n.src=t.path+n.src):n=i._parsePath(t.src),null==n)return!1;t.src=n.src,t.type="sound";var s=t.data,a=null;if(null!=s&&(isNaN(s.channels)?isNaN(s)||(a=parseInt(s)):a=parseInt(s.channels),s.audioSprite))for(var r,o=s.audioSprite.length;o--;)r=s.audioSprite[o],i._idHash[r.id]={src:t.src,startTime:parseInt(r.startTime),duration:parseInt(r.duration)},r.defaultPlayProps&&(i._defaultPlayPropsHash[r.id]=createjs.PlayPropsConfig.create(r.defaultPlayProps));null!=t.id&&(i._idHash[t.id]={src:t.src});var l=i.activePlugin.register(t);return e.create(t.src,a),null!=s&&isNaN(s)?t.data.channels=a||e.maxPerChannel():t.data=a||e.maxPerChannel(),l.type&&(t.type=l.type),t.defaultPlayProps&&(i._defaultPlayPropsHash[t.src]=createjs.PlayPropsConfig.create(t.defaultPlayProps)),l},i.registerSound=function(t,e,n,s,a){var r={src:t,id:e,data:n,defaultPlayProps:a};t instanceof Object&&t.src&&(s=e,r=t),r=createjs.LoadItem.create(r),r.path=s,null==s||r.src instanceof Object||(r.src=s+t);var o=i._registerSound(r);if(!o)return!1;if(i._preloadHash[r.src]||(i._preloadHash[r.src]=[]),i._preloadHash[r.src].push(r),1==i._preloadHash[r.src].length)o.on("complete",createjs.proxy(this._handleLoadComplete,this)),o.on("error",createjs.proxy(this._handleLoadError,this)),i.activePlugin.preload(o);else if(1==i._preloadHash[r.src][0])return!0;return r},i.registerSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,s=t.length;s>n;n++)i[n]=createjs.Sound.registerSound(t[n].src,t[n].id,t[n].data,e,t[n].defaultPlayProps);return i},i.removeSound=function(t,n){if(null==i.activePlugin)return!1;t instanceof Object&&t.src&&(t=t.src);var s;if(t instanceof Object?s=i._parseSrc(t):(t=i._getSrcById(t).src,s=i._parsePath(t)),null==s)return!1;t=s.src,null!=n&&(t=n+t);for(var a in i._idHash)i._idHash[a].src==t&&delete i._idHash[a];return e.removeSrc(t),delete i._preloadHash[t],i.activePlugin.removeSound(t),!0},i.removeSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path,t=t.manifest);for(var n=0,s=t.length;s>n;n++)i[n]=createjs.Sound.removeSound(t[n].src,e);return i},i.removeAllSounds=function(){i._idHash={},i._preloadHash={},e.removeAll(),i.activePlugin&&i.activePlugin.removeAllSounds()},i.loadComplete=function(t){if(!i.isReady())return!1;var e=i._parsePath(t);return t=e?i._getSrcById(e.src).src:i._getSrcById(t).src,void 0==i._preloadHash[t]?!1:1==i._preloadHash[t][0]},i._parsePath=function(t){"string"!=typeof t&&(t=t.toString());var e=t.match(i.FILE_PATTERN);if(null==e)return!1;for(var n=e[4],s=e[5],a=i.capabilities,r=0;!a[s];)if(s=i.alternateExtensions[r++],r>i.alternateExtensions.length)return null;
t=t.replace("."+e[5],"."+s);var o={name:n,src:t,extension:s};return o},i._parseSrc=function(t){var e={name:void 0,src:void 0,extension:void 0},n=i.capabilities;for(var s in t)if(t.hasOwnProperty(s)&&n[s]){e.src=t[s],e.extension=s;break}if(!e.src)return!1;var a=e.src.lastIndexOf("/");return e.name=-1!=a?e.src.slice(a+1):e.src,e},i.play=function(t,e,n,s,a,r,o,l,h){var u;u=createjs.PlayPropsConfig.create(e instanceof Object||e instanceof createjs.PlayPropsConfig?e:{interrupt:e,delay:n,offset:s,loop:a,volume:r,pan:o,startTime:l,duration:h});var c=i.createInstance(t,u.startTime,u.duration),p=i._playInstance(c,u);return p||c._playFailed(),c},i.createInstance=function(t,n,s){if(!i.initializeDefaultPlugins())return new createjs.DefaultSoundInstance(t,n,s);var a=i._defaultPlayPropsHash[t];t=i._getSrcById(t);var r=i._parsePath(t.src),o=null;return null!=r&&null!=r.src?(e.create(r.src),null==n&&(n=t.startTime),o=i.activePlugin.create(r.src,n,s||t.duration),a=a||i._defaultPlayPropsHash[r.src],a&&o.applyPlayProps(a)):o=new createjs.DefaultSoundInstance(t,n,s),o.uniqueId=i._lastID++,o},i.stop=function(){for(var t=this._instances,e=t.length;e--;)t[e].stop()},i.setVolume=function(t){if(null==Number(t))return!1;if(t=Math.max(0,Math.min(1,t)),i._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t))for(var e=this._instances,n=0,s=e.length;s>n;n++)e[n].setMasterVolume(t)},i.getVolume=function(){return this._masterVolume},i.setMute=function(t){if(null==t)return!1;if(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t))for(var e=this._instances,i=0,n=e.length;n>i;i++)e[i].setMasterMute(t);return!0},i.getMute=function(){return this._masterMute},i.setDefaultPlayProps=function(t,e){t=i._getSrcById(t),i._defaultPlayPropsHash[i._parsePath(t.src).src]=createjs.PlayPropsConfig.create(e)},i.getDefaultPlayProps=function(t){return t=i._getSrcById(t),i._defaultPlayPropsHash[i._parsePath(t.src).src]},i._playInstance=function(t,e){var n=i._defaultPlayPropsHash[t.src]||{};if(null==e.interrupt&&(e.interrupt=n.interrupt||i.defaultInterruptBehavior),null==e.delay&&(e.delay=n.delay||0),null==e.offset&&(e.offset=t.getPosition()),null==e.loop&&(e.loop=t.loop),null==e.volume&&(e.volume=t.volume),null==e.pan&&(e.pan=t.pan),0==e.delay){var s=i._beginPlaying(t,e);if(!s)return!1}else{var a=setTimeout(function(){i._beginPlaying(t,e)},e.delay);t.delayTimeoutId=a}return this._instances.push(t),!0},i._beginPlaying=function(t,i){if(!e.add(t,i.interrupt))return!1;var n=t._beginPlaying(i);if(!n){var s=createjs.indexOf(this._instances,t);return s>-1&&this._instances.splice(s,1),!1}return!0},i._getSrcById=function(t){return i._idHash[t]||{src:t}},i._playFinished=function(t){e.remove(t);var i=createjs.indexOf(this._instances,t);i>-1&&this._instances.splice(i,1)},createjs.Sound=t,e.channels={},e.create=function(t,i){var n=e.get(t);return null==n?(e.channels[t]=new e(t,i),!0):!1},e.removeSrc=function(t){var i=e.get(t);return null==i?!1:(i._removeAll(),delete e.channels[t],!0)},e.removeAll=function(){for(var t in e.channels)e.channels[t]._removeAll();e.channels={}},e.add=function(t,i){var n=e.get(t.src);return null==n?!1:n._add(t,i)},e.remove=function(t){var i=e.get(t.src);return null==i?!1:(i._remove(t),!0)},e.maxPerChannel=function(){return n.maxDefault},e.get=function(t){return e.channels[t]};var n=e.prototype;n.constructor=e,n.src=null,n.max=null,n.maxDefault=100,n.length=0,n.init=function(t,e){this.src=t,this.max=e||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},n._get=function(t){return this._instances[t]},n._add=function(t,e){return this._getSlot(e,t)?(this._instances.push(t),this.length++,!0):!1},n._remove=function(t){var e=createjs.indexOf(this._instances,t);return-1==e?!1:(this._instances.splice(e,1),this.length--,!0)},n._removeAll=function(){for(var t=this.length-1;t>=0;t--)this._instances[t].stop()},n._getSlot=function(e){var i,n;if(e!=t.INTERRUPT_NONE&&(n=this._get(0),null==n))return!0;for(var s=0,a=this.max;a>s;s++){if(i=this._get(s),null==i)return!0;if(i.playState==t.PLAY_FINISHED||i.playState==t.PLAY_INTERRUPTED||i.playState==t.PLAY_FAILED){n=i;break}e!=t.INTERRUPT_NONE&&(e==t.INTERRUPT_EARLY&&i.getPosition()<n.getPosition()||e==t.INTERRUPT_LATE&&i.getPosition()>n.getPosition())&&(n=i)}return null!=n?(n._interrupt(),this._remove(n),!0):!1},n.toString=function(){return"[Sound SoundChannel]"}}(),this.createjs=this.createjs||{},function(){var t=function(t,e,i,n){this.EventDispatcher_constructor(),this.src=t,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this._pan=0,Object.defineProperty(this,"pan",{get:this.getPan,set:this.setPan}),this._startTime=Math.max(0,e||0),Object.defineProperty(this,"startTime",{get:this.getStartTime,set:this.setStartTime}),this._duration=Math.max(0,i||0),Object.defineProperty(this,"duration",{get:this.getDuration,set:this.setDuration}),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this.getPlaybackResource,set:this.setPlaybackResource}),n!==!1&&n!==!0&&this.setPlaybackResource(n),this._position=0,Object.defineProperty(this,"position",{get:this.getPosition,set:this.setPosition}),this._loop=0,Object.defineProperty(this,"loop",{get:this.getLoop,set:this.setLoop}),this._muted=!1,Object.defineProperty(this,"muted",{get:this.getMuted,set:this.setMuted}),this._paused=!1,Object.defineProperty(this,"paused",{get:this.getPaused,set:this.setPaused})},e=createjs.extend(t,createjs.EventDispatcher);e.play=function(t,e,i,n,s,a){var r;return r=createjs.PlayPropsConfig.create(t instanceof Object||t instanceof createjs.PlayPropsConfig?t:{interrupt:t,delay:e,offset:i,loop:n,volume:s,pan:a}),this.playState==createjs.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(r),void(this._paused&&this.setPaused(!1))):(this._cleanUp(),createjs.Sound._playInstance(this,r),this)},e.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this},e.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},e.applyPlayProps=function(t){return null!=t.offset&&this.setPosition(t.offset),null!=t.loop&&this.setLoop(t.loop),null!=t.volume&&this.setVolume(t.volume),null!=t.pan&&this.setPan(t.pan),null!=t.startTime&&(this.setStartTime(t.startTime),this.setDuration(t.duration)),this},e.toString=function(){return"[AbstractSoundInstance]"},e.getPaused=function(){return this._paused},e.setPaused=function(t){return t!==!0&&t!==!1||this._paused==t||1==t&&this.playState!=createjs.Sound.PLAY_SUCCEEDED?void 0:(this._paused=t,t?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this)},e.setVolume=function(t){return t==this._volume?this:(this._volume=Math.max(0,Math.min(1,t)),this._muted||this._updateVolume(),this)},e.getVolume=function(){return this._volume},e.setMuted=function(t){return t===!0||t===!1?(this._muted=t,this._updateVolume(),this):void 0},e.getMuted=function(){return this._muted},e.setPan=function(t){return t==this._pan?this:(this._pan=Math.max(-1,Math.min(1,t)),this._updatePan(),this)},e.getPan=function(){return this._pan},e.getPosition=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},e.setPosition=function(t){return this._position=Math.max(0,t),this.playState==createjs.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},e.getStartTime=function(){return this._startTime},e.setStartTime=function(t){return t==this._startTime?this:(this._startTime=Math.max(0,t||0),this._updateStartTime(),this)},e.getDuration=function(){return this._duration},e.setDuration=function(t){return t==this._duration?this:(this._duration=Math.max(0,t||0),this._updateDuration(),this)},e.setPlaybackResource=function(t){return this._playbackResource=t,0==this._duration&&this._setDurationFromSource(),this},e.getPlaybackResource=function(){return this._playbackResource},e.getLoop=function(){return this._loop},e.setLoop=function(t){null!=this._playbackResource&&(0!=this._loop&&0==t?this._removeLooping(t):0==this._loop&&0!=t&&this._addLooping(t)),this._loop=t},e._sendEvent=function(t){var e=new createjs.Event(t);this.dispatchEvent(e)},e._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,createjs.Sound._playFinished(this)},e._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},e._beginPlaying=function(t){return this.setPosition(t.offset),this.setLoop(t.loop),this.setVolume(t.volume),this.setPan(t.pan),null!=t.startTime&&(this.setStartTime(t.startTime),this.setDuration(t.duration)),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},e._playFailed=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleSoundComplete=function(){return this._position=0,0!=this._loop?(this._loop--,this._handleLoop(),void this._sendEvent("loop")):(this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,void this._sendEvent("complete"))},e._handleSoundReady=function(){},e._updateVolume=function(){},e._updatePan=function(){},e._updateStartTime=function(){},e._updateDuration=function(){},e._setDurationFromSource=function(){},e._calculateCurrentPosition=function(){},e._updatePosition=function(){},e._removeLooping=function(){},e._addLooping=function(){},e._pause=function(){},e._resume=function(){},e._handleStop=function(){},e._handleCleanUp=function(){},e._handleLoop=function(){},createjs.AbstractSoundInstance=createjs.promote(t,"EventDispatcher"),createjs.DefaultSoundInstance=createjs.AbstractSoundInstance}(),this.createjs=this.createjs||{},function(){var t=function(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass},e=t.prototype;t._capabilities=null,t.isSupported=function(){return!0},e.register=function(t){var e=this._loaders[t.src];return e&&!e.canceled?this._loaders[t.src]:(this._audioSources[t.src]=!0,this._soundInstances[t.src]=[],e=new this._loaderClass(t),e.on("complete",createjs.proxy(this._handlePreloadComplete,this)),this._loaders[t.src]=e,e)},e.preload=function(t){t.on("error",createjs.proxy(this._handlePreloadError,this)),t.load()},e.isPreloadStarted=function(t){return null!=this._audioSources[t]},e.isPreloadComplete=function(t){return!(null==this._audioSources[t]||1==this._audioSources[t])},e.removeSound=function(t){if(this._soundInstances[t]){for(var e=this._soundInstances[t].length;e--;){var i=this._soundInstances[t][e];i.destroy()}delete this._soundInstances[t],delete this._audioSources[t],this._loaders[t]&&this._loaders[t].destroy(),delete this._loaders[t]}},e.removeAllSounds=function(){for(var t in this._audioSources)this.removeSound(t)},e.create=function(t,e,i){this.isPreloadStarted(t)||this.preload(this.register(t));var n=new this._soundInstanceClass(t,e,i,this._audioSources[t]);return this._soundInstances[t].push(n),n},e.setVolume=function(t){return this._volume=t,this._updateVolume(),!0},e.getVolume=function(){return this._volume},e.setMute=function(){return this._updateVolume(),!0},e.toString=function(){return"[AbstractPlugin]"},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._audioSources[e]=t.result;for(var i=0,n=this._soundInstances[e].length;n>i;i++){var s=this._soundInstances[e][i];s.setPlaybackResource(this._audioSources[e])}},e._handlePreloadError=function(){},e._updateVolume=function(){},createjs.AbstractPlugin=t}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.SOUND)}var e=createjs.extend(t,createjs.AbstractLoader);t.context=null,e.toString=function(){return"[WebAudioLoader]"},e._createRequest=function(){this._request=new createjs.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},e._sendComplete=function(){t.context.decodeAudioData(this._rawResult,createjs.proxy(this._handleAudioDecoded,this),createjs.proxy(this._sendError,this))},e._handleAudioDecoded=function(t){this._result=t,this.AbstractLoader__sendComplete()},createjs.WebAudioLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e,n,s){this.AbstractSoundInstance_constructor(t,e,n,s),this.gainNode=i.context.createGain(),this.panNode=i.context.createPanner(),this.panNode.panningModel=i._panningModel,this.panNode.connect(this.gainNode),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=createjs.proxy(this._handleSoundComplete,this)}var e=createjs.extend(t,createjs.AbstractSoundInstance),i=t;i.context=null,i.destinationNode=null,i._panningModel="equalpower",e.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},e.toString=function(){return"[WebAudioSoundInstance]"},e._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},e._removeLooping=function(){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},e._addLooping=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},e._handleCleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},e._cleanUpAudioNode=function(t){return t&&(t.stop(0),t.disconnect(0),t=null),t},e._handleSoundReady=function(){this.gainNode.connect(i.destinationNode);var t=.001*this._duration,e=.001*this._position;e>t&&(e=t),this.sourceNode=this._createAndPlayAudioNode(i.context.currentTime-t,e),this._playbackStartTime=this.sourceNode.startTime-e,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(t-e)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._createAndPlayAudioNode=function(t,e){var n=i.context.createBufferSource();n.buffer=this.playbackResource,n.connect(this.panNode);var s=.001*this._duration;return n.startTime=t+s,n.start(n.startTime,e+.001*this._startTime,s-e),n},e._pause=function(){this._position=1e3*(i.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},e._resume=function(){this._handleSoundReady()},e._updateVolume=function(){var t=this._muted?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},e._calculateCurrentPosition=function(){return 1e3*(i.context.currentTime-this._playbackStartTime)},e._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},e._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},e._updateDuration=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},createjs.WebAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this._panningModel=i._panningModel,this.context=i.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),createjs.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=i._capabilities,this._loaderClass=createjs.WebAudioLoader,this._soundInstanceClass=createjs.WebAudioSoundInstance,this._addPropsToClasses()}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i._capabilities=null,i._panningModel="equalpower",i.context=null,i.isSupported=function(){var t=createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry;return"file:"!=location.protocol||t||this._isFileXHRSupported()?(i._generateCapabilities(),null==i.context?!1:!0):!1},i.playEmptySound=function(){if(null!=i.context){var t=i.context.createBufferSource();t.buffer=i.context.createBuffer(1,1,22050),t.connect(i.context.destination),t.start(0,0,0)}},i._isFileXHRSupported=function(){var t=!0,e=new XMLHttpRequest;try{e.open("GET","WebAudioPluginTest.fail",!1)}catch(i){return t=!1}e.onerror=function(){t=!1},e.onload=function(){t=404==this.status||200==this.status||0==this.status&&""!=this.response};try{e.send()}catch(i){t=!1}return t},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;if(null==i.context)if(window.AudioContext)i.context=new AudioContext;else{if(!window.webkitAudioContext)return null;i.context=new webkitAudioContext}i._compatibilitySetUp(),i.playEmptySound(),i._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,s=0,a=e.length;a>s;s++){var r=e[s],o=n[r]||r;i._capabilities[r]="no"!=t.canPlayType("audio/"+r)&&""!=t.canPlayType("audio/"+r)||"no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)}i.context.destination.numberOfChannels<2&&(i._capabilities.panning=!1)}},i._compatibilitySetUp=function(){if(i._panningModel="equalpower",!i.context.createGain){i.context.createGain=i.context.createGainNode;var t=i.context.createBufferSource();t.__proto__.start=t.__proto__.noteGrainOn,t.__proto__.stop=t.__proto__.noteOff,i._panningModel=0}},e.toString=function(){return"[WebAudioPlugin]"},e._addPropsToClasses=function(){var t=this._soundInstanceClass;t.context=this.context,t.destinationNode=this.gainNode,t._panningModel=this._panningModel,this._loaderClass.context=this.context},e._updateVolume=function(){var t=createjs.Sound._masterMute?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},createjs.WebAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){function t(){throw"HTMLAudioTagPool cannot be instantiated"}function e(){this._tags=[]}var i=t;i._tags={},i._tagPool=new e,i._tagUsed={},i.get=function(t){var e=i._tags[t];return null==e?(e=i._tags[t]=i._tagPool.get(),e.src=t):i._tagUsed[t]?(e=i._tagPool.get(),e.src=t):i._tagUsed[t]=!0,e},i.set=function(t,e){e==i._tags[t]?i._tagUsed[t]=!1:i._tagPool.set(e)},i.remove=function(t){var e=i._tags[t];return null==e?!1:(i._tagPool.set(e),delete i._tags[t],delete i._tagUsed[t],!0)},i.getDuration=function(t){var e=i._tags[t];return null==e?0:1e3*e.duration},createjs.HTMLAudioTagPool=t;var n=e.prototype;n.constructor=e,n.get=function(){var t;return t=0==this._tags.length?this._createTag():this._tags.pop(),null==t.parentNode&&document.body.appendChild(t),t},n.set=function(t){var e=createjs.indexOf(this._tags,t);-1==e&&(this._tags.src=null,this._tags.push(t))},n.toString=function(){return"[TagPool]"},n._createTag=function(){var t=document.createElement("audio");return t.autoplay=!1,t.preload="none",t}}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleTagReady,this),this._stalledHandler=createjs.proxy(this._playFailed,this),this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=createjs.proxy(this._handleSoundComplete,this),i?this._audioSpriteStopTime=.001*(e+i):this._duration=createjs.HTMLAudioTagPool.getDuration(this.src)}var e=createjs.extend(t,createjs.AbstractSoundInstance);e.setMasterVolume=function(){this._updateVolume()},e.setMasterMute=function(){this._updateVolume()},e.toString=function(){return"[HTMLAudioSoundInstance]"},e._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},e._handleCleanUp=function(){var t=this._playbackResource;if(null!=t){t.pause(),t.loop=!1,t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{t.currentTime=this._startTime}catch(e){}createjs.HTMLAudioTagPool.set(this.src,t),this._playbackResource=null}},e._beginPlaying=function(t){return this._playbackResource=createjs.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(t)},e._handleSoundReady=function(){if(4!==this._playbackResource.readyState){var t=this._playbackResource;return t.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.preload="auto",void t.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},e._handleTagReady=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},e._pause=function(){this._playbackResource.pause()},e._resume=function(){this._playbackResource.play()},e._updateVolume=function(){if(null!=this._playbackResource){var t=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;t!=this._playbackResource.volume&&(this._playbackResource.volume=t)}},e._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},e._updatePosition=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(t){this._handleSetPositionSeek(null)}},e._handleSetPositionSeek=function(){null!=this._playbackResource&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._handleAudioSpriteLoop=function(){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},e._handleLoop=function(){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},e._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},createjs.HTMLAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this.defaultNumChannels=2,this._capabilities=i._capabilities,this._loaderClass=createjs.SoundLoader,this._soundInstanceClass=createjs.HTMLAudioSoundInstance}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i.MAX_INSTANCES=30,i._AUDIO_READY="canplaythrough",i._AUDIO_ENDED="ended",i._AUDIO_SEEKED="seeked",i._AUDIO_STALLED="stalled",i._TIME_UPDATE="timeupdate",i._capabilities=null,i.isSupported=function(){return i._generateCapabilities(),null!=i._capabilities},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;i._capabilities={panning:!1,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,s=0,a=e.length;a>s;s++){var r=e[s],o=n[r]||r;i._capabilities[r]="no"!=t.canPlayType("audio/"+r)&&""!=t.canPlayType("audio/"+r)||"no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)}}},e.register=function(t){var e=createjs.HTMLAudioTagPool.get(t.src),i=this.AbstractPlugin_register(t);return i.setTag(e),i},e.removeSound=function(t){this.AbstractPlugin_removeSound(t),createjs.HTMLAudioTagPool.remove(t)},e.create=function(t,e,i){var n=this.AbstractPlugin_create(t,e,i);return n.setPlaybackResource(null),n},e.toString=function(){return"[HTMLAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,createjs.HTMLAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.SOUND),this._media=null,this._loadTime=0,this._TIMER_FREQUENCY=100}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._media=new Media(this._item.src,null,createjs.proxy(this._mediaErrorHandler,this)),this._media.seekTo(0),this._getMediaDuration()},e.toString=function(){return"[CordovaAudioLoader]"},e._mediaErrorHandler=function(){this._media.release(),this._sendError()},e._getMediaDuration=function(){this._result=1e3*this._media.getDuration(),this._result<0?(this._loadTime+=this._TIMER_FREQUENCY,this._loadTime>this._item.loadTimeout?this.handleEvent({type:"timeout"}):setTimeout(createjs.proxy(this._getMediaDuration,this),this._TIMER_FREQUENCY)):(this._media.release(),this._sendComplete())},createjs.CordovaAudioLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this.playWhenScreenLocked=null,this._playStartTime=null,this._audioSpriteTimeout=null,this._audioSprite=!1,this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteComplete,this),this._mediaPlayFinishedHandler=createjs.proxy(this._handleSoundComplete,this),this._mediaErrorHandler=createjs.proxy(this._handleMediaError,this),this._mediaProgressHandler=createjs.proxy(this._handleMediaProgress,this),this._playbackResource=new Media(t,this._mediaPlayFinishedHandler,this._mediaErrorHandler,this._mediaProgressHandler),i?this._audioSprite=!0:this._setDurationFromSource()}var e=createjs.extend(t,createjs.AbstractSoundInstance);e.setMasterVolume=function(){this._updateVolume()},e.setMasterMute=function(){this._updateVolume()},e.destroy=function(){this.AbstractSoundInstance_destroy(),this._playbackResource.release()},e.getCurrentPosition=function(t,e){this._playbackResource.getCurrentPosition(t,e)},e.toString=function(){return"[CordovaAudioSoundInstance]"},e._handleMediaError=function(){clearTimeout(this.delayTimeoutId),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleMediaProgress=function(){},e._handleAudioSpriteComplete=function(){this._playbackResource.pause(),this._handleSoundComplete()},e._handleCleanUp=function(){clearTimeout(this._audioSpriteTimeout),this._playbackResource.pause()},e._handleSoundReady=function(){this._playbackResource.seekTo(this._startTime+this._position),this._audioSprite&&(this._audioSpriteTimeout=setTimeout(this._audioSpriteEndHandler,this._duration-this._position)),this._playbackResource.play({playAudioWhenScreenIsLocked:this.playWhenScreenLocked}),this._playStartTime=Date.now()},e._pause=function(){clearTimeout(this._audioSpriteTimeout),this._playbackResource.pause(),this._playStartTime&&(this._position=Date.now()-this._playStartTime,this._playStartTime=null),this._playbackResource.getCurrentPosition(createjs.proxy(this._updatePausePos,this))},e._updatePausePos=function(t){this._position=1e3*t-this._startTime,this._playStartTime&&(this._playStartTime=Date.now())},e._resume=function(){this._audioSprite&&(this._audioSpriteTimeout=setTimeout(this._audioSpriteEndHandler,this._duration-this._position)),this._playbackResource.play({playAudioWhenScreenIsLocked:this.playWhenScreenLocked}),this._playStartTime=Date.now()},e._handleStop=function(){clearTimeout(this._audioSpriteTimeout),this._playbackResource.pause(),this._playbackResource.seekTo(this._startTime),this._playStartTime&&(this._position=0,this._playStartTime=null)},e._updateVolume=function(){var t=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;this._playbackResource.setVolume(t)},e._calculateCurrentPosition=function(){return this._playStartTime&&(this._position=Date.now()-this._playStartTime+this._position,this._playStartTime=Date.now()),this._position},e._updatePosition=function(){this._playbackResource.seekTo(this._startTime+this._position),this._playStartTime=Date.now(),this._audioSprite&&(clearTimeout(this._audioSpriteTimeout),this._audioSpriteTimeout=setTimeout(this._audioSpriteEndHandler,this._duration-this._position))},e._handleLoop=function(){this._handleSoundReady()},e._updateStartTime=function(){this._audioSprite=!0,this.playState==createjs.Sound.PLAY_SUCCEEDED},e._updateDuration=function(){this._audioSprite,this.playState==createjs.Sound.PLAY_SUCCEEDED&&(clearTimeout(this._audioSpriteTimeout),this._audioSpriteTimeout=setTimeout(this._audioSpriteEndHandler,this._duration-this.position))},e._setDurationFromSource=function(){this._duration=createjs.Sound.activePlugin.getSrcDuration(this.src)},createjs.CordovaAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this._capabilities=i._capabilities,this._loaderClass=createjs.CordovaAudioLoader,this._soundInstanceClass=createjs.CordovaAudioSoundInstance,this._srcDurationHash={}}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i.playWhenScreenLocked=!1,i._capabilities=null,i.isSupported=function(){return i._generateCapabilities(),null!=i._capabilities
},i._generateCapabilities=function(){if(null==i._capabilities&&(window.cordova||window.PhoneGap||window.phonegap)&&window.Media){var t=document.createElement("audio");if(null==t.canPlayType)return null;i._capabilities={panning:!1,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,s=0,a=e.length;a>s;s++){var r=e[s],o=n[r]||r;i._capabilities[r]="no"!=t.canPlayType("audio/"+r)&&""!=t.canPlayType("audio/"+r)||"no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)}}},e.create=function(t,e,i){var n=this.AbstractPlugin_create(t,e,i);return n.playWhenScreenLocked=this.playWhenScreenLocked,n},e.toString=function(){return"[CordovaAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,e.getSrcDuration=function(t){return this._srcDurationHash[t]},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._srcDurationHash[e]=t.result,this._audioSources[e]=t.result},e.removeSound=function(t){delete this._srcDurationHash[t],this.AbstractPlugin_removeSound(t)},createjs.CordovaAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){var t=createjs.CordovaAudioPlugin=createjs.CordovaAudioPlugin||{};t.version="NEXT",t.buildDate="Tue, 19 May 2015 17:26:59 GMT"}(),i("soundjs",function(t){return function(){var e;return e||t.createjs.Sound}}(this)),i("helpers/SoundController",["require","exports","module","soundjs"],function(t,e,i){function n(e){this.isApp=e,e||(this.Sound=t("soundjs")),this.mediasPlaying=[]}n.prototype.mediaError=function(t){alert("Media Error"),alert(JSON.stringify(t))},n.prototype.createSounds=function(t){var e=this;e.manifest=t;var i="./content/sounds/";if(t)if(e.isApp)t.forEach(function(t){var n=new Media(i+t.src,null,e.mediaError);n.setVolume(parseFloat(t.volume)),n.play({numberOfLoops:parseInt(t.loop)}),e.mediasPlaying.push(n)});else{e.Sound.alternateExtensions=["mp3"];var n=function(t){var n=e.manifest.filter(function(e){return t.src===i+e.src})[0];e.Sound.play(i+n.src,{loop:n.loop,volume:n.volume})};e.Sound.addEventListener("fileload",n),e.Sound.registerSounds(t,i)}},n.prototype.clearSounds=function(){this.isApp?(this.mediasPlaying.forEach(function(t){t.stop(),t.release()}),this.mediasPlaying=[]):this.Sound.removeAllSounds(),this.manifest=null},i.exports=n}),i("helpers/ParameterTransformer",["require","exports","module"],function(t,e,i){function n(t,e,i){this.model=e,this.timeKeeper=i,this.setParsedConfig(t)}n.prototype.constructor=n,n.prototype.setParsedConfig=function(t){this.parsedConfig=t,this.setInitialValues()},n.prototype.setInitialValues=function(){this.initialPosition=[this.parsedConfig.x,this.parsedConfig.y,this.parsedConfig.height],this.initialOrigin=[this.parsedConfig.xOrigin,this.parsedConfig.yOrigin,0],this.initialScale=[this.parsedConfig.scale*this.parsedConfig.xyRatio,this.parsedConfig.scale,1],this.initialSize=[this.parsedConfig.sizeX,this.parsedConfig.sizeY],this.initialRotate=[this.parsedConfig.xRotate,this.parsedConfig.yRotate,this.parsedConfig.zRotate],this.initialOpacity=this.parsedConfig.opacity},n.prototype.calculateTransform=function(){var t,e=this.timeKeeper.timePassed,i=0,n=0,s=0,a=0,r=0,o=1,l=1,h=1,u=0;if(this.parsedConfig.translate&&(i+=this.parsedConfig.translateFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.translateXSpeed,this.parsedConfig.translateX),n+=this.parsedConfig.translateFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.translateYSpeed,this.parsedConfig.translateY)),this.parsedConfig.accel&&(t=window.orientationController.orientationDifferenceAt(e),i+=t[1]*this.parsedConfig.accelAmount,n+=t[0]*this.parsedConfig.accelAmount),this.parsedConfig.accelRotate&&(t=window.orientationController.orientationDifferenceAt(e),s+=t[0]*this.parsedConfig.accelRotateAmount,a+=t[1]*this.parsedConfig.accelRotateAmount),this.parsedConfig.rotate&&(r=this.parsedConfig.rotateFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.rotateSpeed,1/this.parsedConfig.rotateAngle)),this.parsedConfig.skew&&(o=1+this.parsedConfig.skewFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.skewSpeedX,this.parsedConfig.skewAmountX),l=1+this.parsedConfig.skewFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.skewSpeedY,this.parsedConfig.skewAmountY)),this.parsedConfig.zoom&&(h=this.parsedConfig.zoomRelativeTranslate?1+this.parsedConfig.zoomFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.zoomSpeed,this.parsedConfig.zoomRelativeMultiplier/this.parsedConfig.translateY):1+this.parsedConfig.zoomFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.zoomSpeed,this.parsedConfig.zoomAmount)),this.parsedConfig.animation){var c=Math.floor(this.parsedConfig.animationFunction((e+this.parsedConfig.timeOffset)/this.parsedConfig.animationSpeed,this.parsedConfig.numFrames));n-=c*this.model.page.y*this.parsedConfig.scale}var p={rotate:[this.initialRotate[0]+s,this.initialRotate[1]+a,this.initialRotate[2]+r],scale:[this.initialScale[0]*h*o,this.initialScale[1]*h*l,this.initialScale[2]],position:[this.initialPosition[0]+i,this.initialPosition[1]+n,this.initialPosition[2]+u]};return p},n.prototype.createComponent=function(t){this.node=t;var e=this,i={onUpdate:function(){var i=e.calculateTransform();t.setRotation(i.rotate[0],i.rotate[1],i.rotate[2]),t.setScale(i.scale[0],i.scale[1],i.scale[2]),t.setPosition(i.position[0],i.position[1],i.position[2]),t.requestUpdate(this.id)}},n=t.addComponent(i);return i.id=n,n},i.exports=n}),i("helpers/MathFunctions",["require","exports","module"],function(t,e,i){function n(){}n.prototype.constructor=n,n.prototype.sinFunction=function(t,e){return Math.sin(t)*e},n.prototype.sinFunction.period=2*Math.PI,n.prototype.halfOneSinFunction=function(t,e){return(Math.sin(t)+1)/2*e},n.prototype.halfOneSinFunction.period=2*Math.PI,n.prototype.cosFunction=function(t,e){return(1-Math.cos(2*Math.PI*t))/2*e},n.prototype.cosFunction.period=1,n.prototype.absSinFunction=function(t,e){return-Math.abs(Math.sin(t))*e},n.prototype.absSinFunction.period=Math.PI,n.prototype.triangleFunction=function(t,e){return 2/Math.PI*Math.asin(Math.sin(t))*e},n.prototype.triangleFunction.period=2*Math.PI,n.prototype.sawToothFunction=function(t,e){return e*(t-Math.floor(t))},n.prototype.sawToothFunction.period=1,n.prototype.periodChangedFunction=function(t,e){var i=function(i,n){return t(e*i,n)};return i.period=t.period/e,i},n.prototype.cutFunction=function(t,e,i,n){var s=100/(i-e),a=this.periodChangedFunction(t,s),r=function(s,r){var o=n*e/100,l=n*i/100,h=s%n;return o>h?t(.001,r):h>l?t(.9999*n,r):a(h-o,r)};return r.period=t.period/s,r},i.exports=n}),i("helpers/ConfigParser",["require","exports","module","helpers/MathFunctions"],function(t,e,i){function n(){}var s=t("helpers/MathFunctions");n.prototype.constructor=n,n.prototype.parseConfig=function(t,e){var i={};return i.name=t.name,i.url=t.url,i.text=(t.text||"").replace(/"/g,"&quot;"),i.pageSpeed=parseFloat(e.page.speed)||1,i.numFrames=parseFloat(t.numFrames),i.opacity=parseFloat(t.opacity)||1,i.sizeX=parseFloat(t.sizeX),i.sizeY=parseFloat(t.sizeY),i.x=parseFloat(t.initialX),i.y=parseFloat(t.initialY),i.xRotate=parseFloat(t.initialRotateX)||0,i.yRotate=parseFloat(t.initialRotateY)||0,i.zRotate=parseFloat(t.initialRotateZ)||0,i.xOrigin=parseFloat(t.xOrigin)||0,i.yOrigin=parseFloat(t.yOrigin)||0,i.scale=parseFloat(t.scale),i.xyRatio=parseFloat(t.xyRatio),i.timeOffset=parseFloat(t.timeOffset),i.translateXSpeed=i.pageSpeed*parseFloat(t.translateXSpeed),i.translateYSpeed=i.pageSpeed*parseFloat(t.translateYSpeed),i.translateX=parseFloat(t.translateX),i.translateY=parseFloat(t.translateY),i.rotateSpeed=i.pageSpeed*parseFloat(t.rotateSpeed),i.rotateAngle=parseFloat(t.rotateAngle),i.skewSpeedX=i.pageSpeed*parseFloat(t.skewSpeedX),i.skewAmountX=parseFloat(t.skewAmountX),i.skewSpeedY=i.pageSpeed*parseFloat(t.skewSpeedY),i.skewAmountY=parseFloat(t.skewAmountY),i.zoomSpeed=i.pageSpeed*parseFloat(t.zoomSpeed),i.zoomAmount=parseFloat(t.zoomAmount),i.zoomCutStart=parseFloat(t.zoomCutStart),i.zoomCutEnd=parseFloat(t.zoomCutEnd),i.translateCutStart=parseFloat(t.translateCutStart),i.translateCutEnd=parseFloat(t.translateCutEnd),i.height=parseFloat(t.height),i.cameraBoundOffset=parseFloat(t.cameraBoundOffset),i.zoomRelativeMultiplier=parseFloat(t.zoomRelativeMultiplier),i.animationSpeed=i.pageSpeed*parseFloat(t.animationSpeed)||100,i.numFrames=parseFloat(t.numFrames),i.motionType=t.motionType,i.zoomType=t.zoomType,i.rotateType=t.rotateType,i.zoomTypeCut=t.zoomTypeCut,i.translateTypeCut=t.translateTypeCut,i.translateFunction=void 0,i.zoomFunction=void 0,i.rotateFunction=void 0,i.skewFunction=void 0,i.animationFunction=s.prototype.sawToothFunction,i.translate=t.translate,i.accel=t.accel,i.accelAmount=parseFloat(t.accelAmount)||1,i.accelRotate=t.accelRotate,i.accelRotateAmount=parseFloat(t.accelRotateAmount)||1,i.rotate=t.rotate,i.skew=t.skew,i.zoom=t.zoom,i.zoomRelativeTranslate=t.zoomRelativeTranslate,i.animation=t.animation,i.cameraBound=t.cameraBound,i.translateFunction="triangle"===i.motionType?s.prototype.triangleFunction:"sawtooth"===i.motionType?s.prototype.sawToothFunction:"cos"===i.motionType?s.prototype.cosFunction:s.prototype.sinFunction,i.zoomFunction="triangle"===i.zoomType?s.prototype.triangleFunction:"sin"===i.zoomType?s.prototype.sinFunction:"cos"===i.zoomType?s.prototype.cosFunction:s.prototype.sawToothFunction,i.rotateFunction="triangle"===i.rotateType?s.prototype.triangleFunction:"sawToothFunction"===i.rotateType?s.prototype.sawToothFunction:"cos"===i.rotateType?s.prototype.cosFunction:s.prototype.sinFunction,i.skewFunction=s.prototype.cosFunction,i.zoomTypeCut&&(i.zoomFunction=s.prototype.cutFunction(i.zoomFunction,i.zoomCutStart,i.zoomCutEnd,i.zoomFunction.period)),i.translateTypeCut&&(i.translateFunction=s.prototype.cutFunction(i.translateFunction,i.translateCutStart,i.translateCutEnd,i.translateFunction.period)),i},i.exports=n}),i("elements/Element",["require","exports","module","famous"],function(t,e,i){function n(t,e,i){var n=(i.surfaceClasses||"").trim();n=(n+" "+(e.myClasses||"")).trim(),n&&""!==n&&(e.classes=n.split(" ")),a.apply(this,[t,e])}var s=t("famous"),a=s.domRenderables.DOMElement;n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},n.prototype.contentInserted=function(){},i.exports=n}),i("elements/RepeatingImage",["require","exports","module","elements/Element"],function(t,e,i){function n(t,e){var i={attributes:{},properties:{}};i.tagName="div",i.myClasses="repeating-image",i.properties={"background-image":"url('"+e.url+"')"},s.apply(this,[t,i,e])}var s=t("elements/Element");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("elements/HighlightingText",["require","exports","module","elements/Element","helpers/MathFunctions"],function(t,e,i){function n(t,e,i){var n=this;this.config=e,this.model=i,this.node=t;var a={attributes:{},properties:{}};this.textLines=e.text.split("\n"),this.currentLine=0,a.tagName="div",a.myClasses="overlay-text",a.content=this.createContent(-1),s.apply(this,[t,a,e]),this.updaterComponent={onUpdate:function(){n.needsUpdating&&n.updateContent(),n.updateHighlightText(),t.requestUpdate(this.id)}},this.updaterComponentID=t.addComponent(this.updaterComponent),this.updaterComponent.id=this.updaterComponentID,t.requestUpdate(this.updaterComponentID)}var s=t("elements/Element"),a=t("helpers/MathFunctions");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.updateHighlightText=function(){var t=parseFloat(Date.now()),e=parseFloat(this.config.timeOffset),i=parseFloat(this.model.page.speed)||1,n=(parseFloat(this.config.singSpeed)||1)*i,s=Math.floor(a.prototype.sawToothFunction((t+e)/n,this.textLines.length));s!==this.currentLine&&(this.currentLine=s,this.needsUpdating=!0)},n.prototype.updateContent=function(){var t=this.createContent(this.currentLine);this.setContent(t),this.needsUpdating=!1},n.prototype.setupGradientCSS=function(){var t=this.node.getAbsoluteSize()[0],e=t+80,i=e+80,n=i+80,s=2*t+240,a=t/270,r="-webkit-transform: translateZ(0);background-size: "+s+"px 3px;background-image: -webkit-linear-gradient(left, white 0px,white "+t+"px,rgb(53, 205, 247) "+e+"px,rgb(53, 205, 247) "+i+"px,white "+n+"px);-webkit-animation: stripes "+a+"s linear infinite;";return r},n.prototype.contentInserted=function(){self.needsUpdating=!0,this.updateContent()},n.prototype.createContent=function(t){var e=this,i=this.textLines.map(function(i,n){var s;return s=n===t?'<div class="highlight-text gradient-shadow" title="'+i+'"><div class="highlight-text-div" style="'+e.setupGradientCSS()+'">'+i+"</div></div>":'<div class="highlight-text gradient-shadow" title="'+i+'"><div class="highlight-text-div hightlight-inactive">'+i+"</div></div>"});return i.join("")},n.DEFAULT_OPTIONS={},i.exports=n}),i("elements/Image",["require","exports","module","elements/Element"],function(t,e,i){function n(t,e){var i={attributes:{},properties:{}};i.tagName="img",i.attributes={src:e.url},s.apply(this,[t,i,e])}var s=t("elements/Element");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("elements/PlainText",["require","exports","module","elements/Element"],function(t,e,i){function n(t,e){var i={attributes:{},properties:{}},n=(e.text||"").split("\n"),a=n.map(function(t){var e='<div class="highlight-text gradient-shadow" title="'+t+'"><div class="highlight-text-div hightlight-inactive">'+t+"</div></div>";return e});i.tagName="div",i.myClasses="overlay-text",i.content=a.join(""),s.apply(this,[t,i,e])}var s=t("elements/Element");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("elements/ChangingPlainText",["require","exports","module","elements/Element","helpers/MathFunctions"],function(t,e,i){function n(t,e,i){var n=this,r={attributes:{},properties:{}};this.textLines=(e.text||"").split("\n"),this.linesHtml=this.textLines.map(function(t){var e='<div class="highlight-text gradient-shadow" title="'+t+'"><div class="highlight-text-div hightlight-inactive">'+t+"</div></div>";return e}),r.tagName="div",r.myClasses="overlay-text",this.currentLine=0,r.content=this.linesHtml[0],s.apply(this,[t,r,e]),this.updaterComponent={onUpdate:function(){var s=parseFloat(Date.now()),r=parseFloat(e.timeOffset),o=parseFloat(i.page.speed)||1,l=(parseFloat(e.singSpeed)||1)*o,h=Math.floor(a.prototype.sawToothFunction((s+r)/l,n.textLines.length));h!==n.currentLine&&(n.currentLine=h,n.setContent(n.linesHtml[n.currentLine])),t.requestUpdate(this.id)}},this.updaterComponentID=t.addComponent(this.updaterComponent),this.updaterComponent.id=this.updaterComponentID,t.requestUpdate(this.updaterComponentID)}var s=t("elements/Element"),a=t("helpers/MathFunctions");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("elements/SingalongText",["require","exports","module","elements/Element","helpers/MathFunctions"],function(t,e,i){function n(t,e,i){var n=this;this.config=e,this.model=i;var a={attributes:{},properties:{}};this.textLines=e.text.split("\n"),this.currentLine=0,a.tagName="div",a.myClasses="overlay-text",a.content='<span class="highlight-text gradient-shadow singalong" title="'+this.textLines[this.currentLine]+'"><div class="highlight-text-div">'+this.textLines[this.currentLine]+"</div></span>",s.apply(this,[t,a,e]),this.updaterComponent={onUpdate:function(){n.needsUpdating&&n.updateContent(),n.updateHighlightText(),t.requestUpdate(this.id)}},this.updaterComponentID=t.addComponent(this.updaterComponent),this.updaterComponent.id=this.updaterComponentID,t.requestUpdate(this.updaterComponentID)}var s=t("elements/Element"),a=t("helpers/MathFunctions");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},n.prototype.updateSingalongText=function(){var t=parseFloat(Date.now()),e=parseFloat(this.config.timeOffset),i=parseFloat(this.model.page.speed)||1,n=(parseFloat(this.config.singSpeed)||1)*i,s=Math.floor(a.prototype.sawToothFunction((t+e)/n,this.textLines.length));s!==this.currentLine&&(this.currentLine=s,this.surface.setContent('<div class="overlay-text"><span class="highlight-text gradient-shadow singalong" title="'+this.textLines[this.currentLine]+'"><div class="highlight-text-div">'+this.textLines[this.currentLine]+"</div></span></div>"),this.needsUpdating=!0)},n.prototype.updateContent=function(){this.surface._currentTarget&&(this.refreshGradient(),this.needsUpdating=!1)},n.prototype.refreshGradient=function(){var t=this.setupGradientCSS(0),e=self.surface._currentTarget.getElementsByClassName("highlight-text-div")[0];e.setAttribute("style",t)},n.prototype.setupGradientCSS=function(t){var e=self.surface._currentTarget.getElementsByClassName("highlight-text-div")[t],i=e.getBoundingClientRect().width,n=i+80,s=n+80,a=s+80,r=2*i+240,o=i/270,l="-webkit-transform: translateZ(0);background-size: "+r+"px 3px;background-image: -webkit-linear-gradient(left, white 0px,white "+i+"px,rgb(53, 205, 247) "+n+"px,rgb(53, 205, 247) "+s+"px,white "+a+"px);-webkit-animation: stripes "+o+"s linear infinite;";return l},n.prototype.contentInserted=function(){self.needsUpdating=!0,this.updateContent()},i.exports=n}),i("nodes/PopupNode",["require","exports","module","famous","helpers/ParameterTransformer","helpers/ConfigParser","elements/RepeatingImage","elements/HighlightingText","elements/Image","elements/PlainText","elements/ChangingPlainText","elements/SingalongText"],function(t,e,i){function n(){var t=this;this.parsedConfig=l.prototype.parseConfig(this.config,this.model),this.transformer=new o(this.parsedConfig,this.model,this.timeKeeper),this.setupInitialState(),t.transformComponentID=this.transformer.createComponent(t),t.requestUpdate(t.transformComponentID);var e;switch(t.config.surfaceType){case"highlight":e=u;break;case"plain":e=p;break;case"changingPlain":e=d;break;case"repeatingImage":e=h;break;case"singalong":e=m;break;default:e=c}this.domElement=new e(this,this.parsedConfig,this.model),this.refresherComponent={onUpdate:function(){t.config.configChanged&&(t.parsedConfig=l.prototype.parseConfig(t.config,t.model),t.setupInitialState(),t.transformer.setParsedConfig(t.parsedConfig),t.config.configChanged=!1),t.requestUpdate(this.id)}},this.refresherComponentID=this.addComponent(this.refresherComponent),this.refresherComponent.id=this.refresherComponentID,this.requestUpdate(this.refresherComponentID)}function s(t,e,i){r.apply(this,arguments),this.config=t,this.model=e,this.timeKeeper=i,n.call(this),this.contentInserted=function(){this.domElement.contentInserted()}}var a=t("famous"),r=a.core.Node,o=t("helpers/ParameterTransformer"),l=t("helpers/ConfigParser"),h=t("elements/RepeatingImage"),u=t("elements/HighlightingText"),c=t("elements/Image"),p=t("elements/PlainText"),d=t("elements/ChangingPlainText"),m=t("elements/SingalongText");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.setupInitialState=function(){this.parsedConfig.sizeX&&this.parsedConfig.sizeY&&(this.setSizeMode("absolute","absolute"),this.setAbsoluteSize(this.transformer.initialSize[0],this.transformer.initialSize[1])),this.config.animation&&this.parsedConfig.numFrames&&this.setProportionalSize(1,this.parsedConfig.numFrames),this.setPosition(this.transformer.initialPosition[0],this.transformer.initialPosition[1],this.transformer.initialPosition[2]),this.setOrigin(this.transformer.initialOrigin[0],this.transformer.initialOrigin[1],this.transformer.initialOrigin[2]),this.setScale(this.transformer.initialScale[0],this.transformer.initialScale[1],this.transformer.initialScale[2]),this.setRotation(this.transformer.initialRotate[0],this.transformer.initialRotate[1],this.transformer.initialRotate[2]),this.setOpacity(this.transformer.initialOpacity)},i.exports=s}),i("nodes/PopupPageNode",["require","exports","module","famous","nodes/PopupNode","helpers/ParameterTransformer","helpers/ConfigParser","helpers/MathFunctions"],function(t,e,i){function n(){var t,e=this;this.popupNodes=[],this.cameraBoundNodes=[],this.topSceneRoot=this.topScene.addChild(),this.cameraBoundRoot=this.topSceneRoot.addChild(),this.popups.forEach(function(i){i.cameraBound?(t=new o(i,e.model,e),e.cameraBoundNodes.push(t),e.cameraBoundRoot.addChild(t)):(t=new o(i,e.model,e),e.popupNodes.push(t),e.addChild(t))})}function s(t,e,i){var s=this;r.apply(this,arguments),this.popups=t.popups,this.model=t,this.scene=e,this.topScene=i,this.timePassed=0,this.previousTime=0,window.timeKeeper=this,window.orientationController.setTimeKeeper(this),n.call(this),this.camera=new u(e),this.parsedConfig=h.prototype.parseConfig(t.camera,t),this.transformer=new l(this.parsedConfig,t,this),this.setupInitialState(),this.updaterComponent={onUpdate:function(e){if(!s.paused){var i=e-s.previousTime;s.timePassed=s.timePassed+i}if(s.previousTime=e,t.camera.configChanged&&(s.parsedConfig=h.prototype.parseConfig(t.camera,t),s.setupInitialState(),s.transformer.setParsedConfig(s.parsedConfig),t.camera.configChanged=!1),t.camera.perspectiveZoom){var n=parseFloat(t.camera.timeOffset),a=t.page.perspective-s.perspectiveFunction((s.timePassed+n)/s.perspectiveZoomSpeed,s.perspectiveZoomAmount);s.camera.setDepth(a)}s.requestUpdate(this.id)}},this.updaterComponentID=this.addComponent(this.updaterComponent),this.updaterComponent.id=this.updaterComponentID,this.requestUpdate(this.updaterComponentID),this.componentID=this.transformer.createComponent(this),this.requestUpdate(this.componentID)}var a=t("famous"),r=a.core.Node,o=t("nodes/PopupNode"),l=t("helpers/ParameterTransformer"),h=t("helpers/ConfigParser"),u=a.components.Camera,c=t("helpers/MathFunctions");s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.setupInitialState=function(){this.camera.setDepth(parseFloat(this.model.page.perspective)),this.model.camera.perspectiveZoom&&(this.pageSpeed=parseFloat(this.model.page.speed)||1,this.perspectiveZoomSpeed=this.pageSpeed*parseFloat(this.model.camera.perspectiveZoomSpeed),this.perspectiveZoomAmount=parseFloat(this.model.camera.perspectiveZoomAmount),this.perspectiveZoomCutStart=parseFloat(this.model.camera.perspectiveZoomCutStart),this.perspectiveZoomCutEnd=parseFloat(this.model.camera.perspectiveZoomCutEnd),this.perspectiveFunction="triangle"===this.model.camera.perspectiveZoomType?c.prototype.triangleFunction:"sawtooth"===this.model.camera.perspectiveZoomType?c.prototype.sawToothFunction:"cos"===this.model.camera.perspectiveZoomType?c.prototype.cosFunction:c.prototype.sinFunction,this.model.camera.perspectiveZoomCut&&(this.perspectiveFunction=c.prototype.cutFunction(this.perspectiveFunction,this.perspectiveZoomCutStart,this.perspectiveZoomCutEnd,this.perspectiveFunction.period))),this.setSizeMode("absolute","absolute"),this.setAbsoluteSize(parseFloat(this.model.page.x),parseFloat(this.model.page.y)),this.cameraBoundRoot.setSizeMode("absolute","absolute"),this.cameraBoundRoot.setAbsoluteSize(parseFloat(this.model.page.x),parseFloat(this.model.page.y)),this.setPosition(this.transformer.initialPosition[0],this.transformer.initialPosition[1],this.transformer.initialPosition[2]),this.setOrigin(this.transformer.initialOrigin[0],this.transformer.initialOrigin[1],this.transformer.initialOrigin[2]),this.setScale(this.transformer.initialScale[0],this.transformer.initialScale[1],this.transformer.initialScale[2])},s.prototype.contentInserted=function(){this.popupNodes.forEach(function(t){t.contentInserted()})},s.prototype.dismount=function(){this.cameraBoundRoot.dismount(),r.prototype.dismount.apply(this,arguments)},s.prototype.start=function(){this.initialTime=Date.now(),this.currentTime=0,this.lastTime=0},s.prototype.pause=function(){this.paused=!0},s.prototype.play=function(){this.paused=!1},s.prototype.setTime=function(t){this.timePassed=parseFloat(t)},i.exports=s}),i("nodes/PagerNode",["require","exports","module","famous"],function(t,e,i){function n(){a.apply(this,arguments)}var s=t("famous"),a=s.core.Node;n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.showPage=function(t){this.addChild(t),this.currentContent=t},n.prototype.clearPage=function(){this.currentContent.dismount()},i.exports=n}),i("nodes/AppNode",["require","exports","module","famous","nodes/PopupPageNode","nodes/PagerNode"],function(t,e,i){function n(t,e){a.apply(this,arguments),t.addChild(this),this.pagerNode=new o,this.addChild(this.pagerNode),this.scene=t,this.topScene=e}var s=t("famous"),a=s.core.Node,r=t("nodes/PopupPageNode"),o=t("nodes/PagerNode");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.createAndShowPage=function(t){this.contentNode=new r(t,this.scene,this.topScene),this.pagerNode.showPage(this.contentNode)},n.prototype.clearPage=function(){this.pagerNode.clearPage()},n.DEFAULT_OPTIONS={},i.exports=n}),i("BlankyApp",["require","exports","module","famous","helpers/StatsTimer","helpers/OrientationController","helpers/SoundController","nodes/AppNode"],function(t,e,i){function n(t){this.isApp=t,o.init(),window.initialPageId="UHGPYzstxO",window.blanky=this;var e=o.createScene("#device-screen"),i=o.createScene("#top-screen");window.appNode=new l(e,i),window.orientationController=new a({timePassed:0}),window.orientationController.startListening(this),this.soundController=new r(t)}var s=t("famous"),a=(t("helpers/StatsTimer"),t("helpers/OrientationController")),r=t("helpers/SoundController"),o=(s.Clock,s.core.FamousEngine),l=t("nodes/AppNode");n.prototype.clearPage=function(){window.appNode.clearPage(),this.soundController.clearSounds()},n.prototype.loadPage=function(t){var e=window.pagesModel.pages.filter(function(e){return e.objectId===t})[0];window.pageModel=e,window.appNode.createAndShowPage(e),this.soundController.createSounds(window.pageModel.sounds)},i.exports=n}),i("app",["require","exports","module","Fixtures","BlankyApp"],function(t){var e=t("Fixtures");window.Fixtures=e;var i={};i.pages=e.results,window.pagesModel=i;var n=["UHGPYzstxO","gBqF9PtfBm","w9zCNnEbfC","mt1s3uZ90p","rZ4dWe9BGU"],s=1,a=t("BlankyApp"),r=function(t){var e=t.clientX;e<document.getElementById("device-screen").getBoundingClientRect().width/2?window.orientationController.reset():(window.blanky.clearPage(),window.blanky.loadPage(n[s%n.length]),s++)},o=function(){window.blanky=new a(!0),window.blanky.loadPage(window.initialPageId),document.getElementById("top-screen").addEventListener("click",r,!1)},l=function(){window.blanky=new a(!1),window.blanky.loadPage(window.initialPageId),document.getElementById("top-screen").addEventListener("click",r,!1)},h=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://");h?document.addEventListener("deviceready",o,!1):l()}),e(["app"])}();