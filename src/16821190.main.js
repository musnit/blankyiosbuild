/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: mark@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2015
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: david@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2015
 */

/*!
* @license SoundJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011-2013 gskinner.com, inc.
*
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
*/

// Rivets.js
// version: 0.7.1
// author: Michael Richards
// license: MIT

!function(){var t,e,i;!function(n){function r(t,e){return b.call(t,e)}function s(t,e){var i,n,r,s,o,a,u,c,l,h,p,d=e&&e.split("/"),f=v.map,_=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,v.nodeIdCompat&&E.test(t[o])&&(t[o]=t[o].replace(E,"")),t=d.concat(t),l=0;l<t.length;l+=1)if(p=t[l],"."===p)t.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||_)&&f){for(i=t.split("/"),l=i.length;l>0;l-=1){if(n=i.slice(0,l).join("/"),d)for(h=d.length;h>0;h-=1)if(r=f[d.slice(0,h).join("/")],r&&(r=r[n])){s=r,a=l;break}if(s)break;!u&&_&&_[n]&&(u=_[n],c=l)}!s&&u&&(s=u,a=c),s&&(i.splice(0,a,s),t=i.join("/"))}return t}function o(t,e){return function(){return d.apply(n,w.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return s(e,t)}}function u(t){return function(e){m[t]=e}}function c(t){if(r(g,t)){var e=g[t];delete g[t],y[t]=!0,p.apply(n,e)}if(!r(m,t)&&!r(y,t))throw new Error("No "+t);return m[t]}function l(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function h(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,d,f,_,m={},g={},v={},y={},b=Object.prototype.hasOwnProperty,w=[].slice,E=/\.js$/;f=function(t,e){var i,n=l(t),r=n[0];return t=n[1],r&&(r=s(r,e),i=c(r)),r?t=i&&i.normalize?i.normalize(t,a(e)):s(t,e):(t=s(t,e),n=l(t),r=n[0],t=n[1],r&&(i=c(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:i}},_={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:h(t)}}},p=function(t,e,i,s){var a,l,h,p,d,v,b=[],w=typeof i;if(s=s||t,"undefined"===w||"function"===w){for(e=!e.length&&i.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(p=f(e[d],s),l=p.f,"require"===l)b[d]=_.require(t);else if("exports"===l)b[d]=_.exports(t),v=!0;else if("module"===l)a=b[d]=_.module(t);else if(r(m,l)||r(g,l)||r(y,l))b[d]=c(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,o(s,!0),u(l),{}),b[d]=m[l]}h=i?i.apply(m[t],b):void 0,t&&(a&&a.exports!==n&&a.exports!==m[t]?m[t]=a.exports:h===n&&v||(m[t]=h))}else t&&(m[t]=i)},t=e=d=function(t,e,i,r,s){if("string"==typeof t)return _[t]?_[t](e):c(f(t,e).f);if(!t.splice){if(v=t,v.deps&&d(v.deps,v.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=r,r=s),r?p(n,t,e,i):setTimeout(function(){p(n,t,e,i)},4),d},d.config=function(t){return d(t)},t._defined=m,i=function(t,e,i){e.splice||(i=e,e=[]),r(m,t)||r(g,t)||(g[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("famous/core/Entity",["require","exports","module"],function(t,e,i){function n(t){return a[t]}function r(t,e){a[t]=e}function s(t){var e=a.length;return r(e,t),e}function o(t){r(t,null)}var a=[];i.exports={register:s,unregister:o,get:n,set:r}}),i("famous/core/Transform",["require","exports","module"],function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function r(t){return Math.sqrt(n(t))}function s(t){return 0>t?-1:1}var o={};o.precision=1e-6,o.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},o.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},o.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},o.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],r=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return o.thenMove(e,[i,n,r])},o.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},o.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},o.scale=function(t,e,i){return void 0===i&&(i=1),void 0===e&&(e=t),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},o.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},o.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},o.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},o.rotate=function(t,e,i){var n=Math.cos(t),r=Math.sin(t),s=Math.cos(e),o=Math.sin(e),a=Math.cos(i),u=Math.sin(i),c=[s*a,n*u+r*o*a,r*u-n*o*a,0,-s*u,n*a-r*o*u,r*a+n*o*u,0,o,-r*s,n*s,0,0,0,0,1];return c},o.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),r=1-n,s=t[0]*t[0]*r,o=t[0]*t[1]*r,a=t[0]*t[2]*r,u=t[1]*t[1]*r,c=t[1]*t[2]*r,l=t[2]*t[2]*r,h=t[0]*i,p=t[1]*i,d=t[2]*i,f=[s+n,o+d,a-p,0,o-d,u+n,c+h,0,a+p,c-h,l+n,0,0,0,0,1];return f},o.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),r=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return o.thenMove(e,[i,n,r])},o.skew=function(t,e,i){return[1,Math.tan(e),0,0,Math.tan(i),1,0,0,0,Math.tan(t),1,0,0,0,0,1]},o.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},o.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},o.getTranslate=function(t){return[t[12],t[13],t[14]]},o.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],r=t[1]*t[10]-t[2]*t[9],s=t[0]*t[10]-t[2]*t[8],o=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],l=t[0]*e-t[1]*i+t[2]*n,h=1/l,p=[h*e,-h*r,h*a,0,-h*i,h*s,-h*u,0,h*n,-h*o,h*c,0,0,0,0,1];return p[12]=-t[12]*p[0]-t[13]*p[4]-t[14]*p[8],p[13]=-t[12]*p[1]-t[13]*p[5]-t[14]*p[9],p[14]=-t[12]*p[2]-t[13]*p[6]-t[14]*p[10],p},o.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},o.interpret=function(t){var e=[t[0],t[1],t[2]],i=s(e[0]),a=r(e),u=[e[0]+i*a,e[1],e[2]],c=2/n(u);if(c>=1/0)return{translate:o.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];l[0]=1-c*u[0]*u[0],l[5]=1-c*u[1]*u[1],l[10]=1-c*u[2]*u[2],l[1]=-c*u[0]*u[1],l[2]=-c*u[0]*u[2],l[6]=-c*u[1]*u[2],l[4]=l[1],l[8]=l[2],l[9]=l[6];var h=o.multiply(l,t),p=[h[5],h[6]],d=s(p[0]),f=r(p),_=[p[0]+d*f,p[1]],m=2/n(_),g=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];g[5]=1-m*_[0]*_[0],g[10]=1-m*_[1]*_[1],g[6]=-m*_[0]*_[1],g[9]=g[6];var v=o.multiply(g,l),y=o.multiply(v,t),b=o.scale(y[0]<0?-1:1,y[5]<0?-1:1,y[10]<0?-1:1);y=o.multiply(y,b),v=o.multiply(b,v);var w={};return w.translate=o.getTranslate(t),w.rotate=[Math.atan2(-v[6],v[10]),Math.asin(v[2]),Math.atan2(-v[1],v[0])],w.rotate[0]||(w.rotate[0]=0,w.rotate[2]=Math.atan2(v[4],v[5])),w.scale=[y[0],y[5],y[10]],w.skew=[Math.atan2(y[9],w.scale[2]),Math.atan2(y[8],w.scale[2]),Math.atan2(y[4],w.scale[0])],Math.abs(w.rotate[0])+Math.abs(w.rotate[2])>1.5*Math.PI&&(w.rotate[1]=Math.PI-w.rotate[1],w.rotate[1]>Math.PI&&(w.rotate[1]-=2*Math.PI),w.rotate[1]<-Math.PI&&(w.rotate[1]+=2*Math.PI),w.rotate[0]<0?w.rotate[0]+=Math.PI:w.rotate[0]-=Math.PI,w.rotate[2]<0?w.rotate[2]+=Math.PI:w.rotate[2]-=Math.PI),w},o.average=function(t,e,i){i=void 0===i?.5:i;for(var n=o.interpret(t),r=o.interpret(e),s={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)s.translate[a]=(1-i)*n.translate[a]+i*r.translate[a],s.rotate[a]=(1-i)*n.rotate[a]+i*r.rotate[a],s.scale[a]=(1-i)*n.scale[a]+i*r.scale[a],s.skew[a]=(1-i)*n.skew[a]+i*r.skew[a];return o.build(s)},o.build=function(t){var e=o.scale(t.scale[0],t.scale[1],t.scale[2]),i=o.skew(t.skew[0],t.skew[1],t.skew[2]),n=o.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return o.thenMove(o.multiply(o.multiply(n,i),e),t.translate)},o.equals=function(t,e){return!o.notEquals(t,e)},o.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},o.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},o.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],o.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=o}),i("famous/core/SpecParser",["require","exports","module","./Transform"],function(t,e,i){function n(){this.result={}}function r(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var s=t("./Transform");n._instance=new n,n.parse=function(t,e){return n._instance.parse(t,e)},n.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,s.identity),this.result},n.prototype.reset=function(){this.result={}};var o=[0,0];n.prototype._parseSpec=function(t,e,i){var n,a,u,c,l,h,p;if("number"==typeof t){if(n=t,u=e.transform,h=e.align||o,e.size&&h&&(h[0]||h[1])){var d=[h[0]*e.size[0],h[1]*e.size[1],0];u=s.thenMove(u,r(d,i))}this.result[n]={transform:u,opacity:e.opacity,origin:e.origin||o,align:e.align||o,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var f=0;f<t.length;f++)this._parseSpec(t[f],e,i);else{a=t.target,u=e.transform,c=e.opacity,l=e.origin,h=e.align,p=e.size;var _=i;if(void 0!==t.opacity&&(c=e.opacity*t.opacity),t.transform&&(u=s.multiply(e.transform,t.transform)),t.origin&&(l=t.origin,_=e.transform),t.align&&(h=t.align),t.size||t.proportions){var m=p;p=[p[0],p[1]],t.size&&(void 0!==t.size[0]&&(p[0]=t.size[0]),void 0!==t.size[1]&&(p[1]=t.size[1])),t.proportions&&(void 0!==t.proportions[0]&&(p[0]=p[0]*t.proportions[0]),void 0!==t.proportions[1]&&(p[1]=p[1]*t.proportions[1])),m&&(h&&(h[0]||h[1])&&(u=s.thenMove(u,r([h[0]*m[0],h[1]*m[1],0],i))),l&&(l[0]||l[1])&&(u=s.moveThen([-l[0]*p[0],-l[1]*p[1],0],u))),_=e.transform,l=null,h=null}this._parseSpec(a,{transform:u,opacity:c,origin:l,align:h,size:p},_)}}},i.exports=n}),i("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(t,e,i){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function r(t,e,i){for(var n=o.parse(t,e),a=Object.keys(n),u=0;u<a.length;u++){var c=a[u],l=s.get(c),h=n[c];h.allocator=e.allocator;var p=l.commit(h);p?r(p,e,i):i[c]=h}}var s=t("./Entity"),o=t("./SpecParser");n.prototype.add=function(t){var e=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),i=0;i<e.length;i++){var n=e[i];if(void 0===this._resultCache[n]){var o=s.get(n);o.cleanup&&o.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},r(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,i=0;i<e.length;i++)t[i]=e[i].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=n}),i("famous/core/EventEmitter",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var i=this.listeners[t];if(void 0!==i){var n=i.indexOf(e);n>=0&&i.splice(n,1)}return this},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),i("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,i){function n(){r.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var r=t("./EventEmitter");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=t.on,t.removeListener=e.removeListener.bind(e)},n.prototype.emit=function(t,e){r.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger&&this.downstream[i].trigger(t,e);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](t,e);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(r.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(t,e)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return this},n.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.removeListener(i,this.upstreamListeners[i])}return this},i.exports=n}),i("famous/core/ElementAllocator",["require","exports","module"],function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.firstChild);this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),i("famous/utilities/Utility",["require","exports","module"],function(t,e,i){var n={};n.Direction={X:0,Y:1,Z:2},n.after=function(t,e){var i=t;return function(){i--,0===i&&e.apply(this,arguments)}},n.loadURL=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()},n.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var i=document.createDocumentFragment();e.hasChildNodes();)i.appendChild(e.firstChild);return i},n.clone=function(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var i in t)if("object"==typeof t[i]&&null!==t[i])if(t[i]instanceof Array){e[i]=new Array(t[i].length);for(var r=0;r<t[i].length;r++)e[i][r]=n.clone(t[i][r])}else e[i]=n.clone(t[i]);else e[i]=t[i]}else e=t;return e},i.exports=n}),i("famous/transitions/MultipleTransition",["require","exports","module","../utilities/Utility"],function(t,e,i){function n(t){this.method=t,this._instances=[],this.state=[]}var r=t("../utilities/Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,e,i){for(var n=r.after(t.length,i),s=0;s<t.length;s++)this._instances[s]||(this._instances[s]=new this.method),this._instances[s].set(t[s],e,n)},n.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=n}),i("famous/transitions/TweenTransition",["require","exports","module"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function r(t,e,i){return(1-i)*t+i*e}function s(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function o(t,e){var i={curve:e.curve};return e.duration&&(i.duration=e.duration),e.speed&&(i.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(i.duration=t.duration),t.curve&&(i.curve=t.curve),t.speed&&(i.speed=t.speed)),"string"==typeof i.curve&&(i.curve=n.getCurve(i.curve)),i}function a(t,e,i,n,r){var s,o=1e-7,a=(i(r)-i(r-o))/o;if(t instanceof Array){s=[];for(var u=0;u<t.length;u++)s[u]="number"==typeof t[u]?a*(t[u]-e[u])/n:0}else s=a*(t-e)/n;return s}function u(t,e,i){var n;if(t instanceof Array){n=[];for(var s=0;s<t.length;s++)n[s]="number"==typeof t[s]?r(t[s],e[s],i):t[s]}else n=r(t,e,i);return n}n.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:n.Curves.linear,duration:500,speed:0};var c={};n.registerCurve=function(t,e){return c[t]?!1:(c[t]=e,!0)},n.unregisterCurve=function(t){return c[t]?(delete c[t],!0):!1},n.getCurve=function(t){var e=c[t];if(void 0!==e)return e;throw new Error("curve not registered")},n.getCurves=function(){return c},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),void(i&&i());if(this._startValue=s(this.get()),e=o(e,this.options),e.speed){var n=this._startValue;if(n instanceof Object){var r=0;for(var a in n)r+=(t[a]-n[a])*(t[a]-n[a]);e.duration=Math.sqrt(r)/e.speed}else e.duration=Math.abs(t-n)/e.speed}this._startTime=Date.now(),this._endValue=s(t),this._startVelocity=s(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=i},n.prototype.reset=function(t,e){if(this._callback){var i=this._callback;this._callback=void 0,i()}this.state=s(t),this.velocity=s(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},n.prototype.getVelocity=function(){return this.velocity},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var i=e/this._duration;this.state=u(this._startValue,this._endValue,this._curve(i)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,i)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",n.Curves.linear),n.registerCurve("easeIn",n.Curves.easeIn),n.registerCurve("easeOut",n.Curves.easeOut),n.registerCurve("easeInOut",n.Curves.easeInOut),n.registerCurve("easeOutBounce",n.Curves.easeOutBounce),n.registerCurve("spring",n.Curves.spring),n.customCurve=function(t,e){return t=t||0,e=e||0,function(i){return t*i+(-2*t-e+3)*i*i+(t+e-2)*i*i*i}},i.exports=n}),i("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(t,e,i){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function r(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,i=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(e=n.method,"string"==typeof e&&(e=a[e])):e=o,this._currentMethod!==e&&(this._engineInstance=!(i instanceof Object)||e.SUPPORTS_MULTIPLE===!0||i.length<=e.SUPPORTS_MULTIPLE?new e:new s(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(n.velocity=this.velocity),this._engineInstance.set(i,n,r.bind(this))}var s=t("./MultipleTransition"),o=t("./TweenTransition"),a={};n.register=function(t){var e=!0;for(var i in t)n.registerMethod(i,t[i])||(e=!1);return e},n.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),this;var n=[t,e];return this.actionQueue.push(n),this.callbackQueue.push(i),this.currentAction||r.call(this),this},n.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,e){var i;return i=this.actionQueue.length?this.actionQueue[this.actionQueue.length-1][0]:this.currentAction?this.currentAction[0]:this.get(),this.set(i,{duration:t,curve:function(){return 0}},e)},n.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){return this.set(this.get())},i.exports=n}),i("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","../transitions/Transitionable"],function(t,e,i){function n(){var t=this.container;return[t.clientWidth,t.clientHeight]}function r(t){this.container=t,this._allocator=new a(t),this._node=new s,this._eventOutput=new o,this._size=n.call(this),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:u.identity,opacity:1,origin:l,align:l,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n.call(this))}.bind(this))}var s=t("./RenderNode"),o=t("./EventHandler"),a=t("./ElementAllocator"),u=t("./Transform"),c=t("../transitions/Transitionable"),l=[0,0],h=!("perspective"in document.documentElement.style),p=h?function(t,e){t.style.webkitPerspective=e?e.toFixed()+"px":""}:function(t,e){t.style.perspective=e?e.toFixed()+"px":""};r.prototype.getAllocator=function(){return this._allocator},r.prototype.add=function(t){return this._node.add(t)},r.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},r.prototype.getSize=function(){return this._size},r.prototype.setSize=function(t){t||(t=n.call(this)),this._size[0]=t[0],this._size[1]=t[1]},r.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(p(this.container,e),this._perspective=e),this._node.commit(this._nodeContext)},r.prototype.getPerspective=function(){return this._perspectiveState.get()},r.prototype.setPerspective=function(t,e,i){return this._perspectiveState.set(t,e,i)},r.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},r.prototype.on=function(t,e){return this._eventOutput.on(t,e)},r.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},r.prototype.pipe=function(t){return this._eventOutput.pipe(t)},r.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=r}),i("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function r(){this.eventOutput=new s,this.eventOutput.bindThis(this),s.setOutputHandler(this,this.eventOutput)}var s=t("./EventHandler");n.patch=function(t){for(var e=new n(t),i=1;i<arguments.length;i++)e.patch(arguments[i]);return t},n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)n in t&&i[n]&&i[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,i[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return t?this._value[t]:this._value},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.on=function(){return r.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return r.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return r.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return r.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),i("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(t,e,i){function n(){x.runLoop?(f.step(),window.requestAnimationFrame(n)):w=!1}function r(){for(var t=0;t<_.length;t++)_[t].emit("resize");S.emit("resize")}function s(){window.addEventListener("touchmove",function(t){t.preventDefault()},!0),o()}function o(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void f.nextTick(o)}function a(t,e){return document.body?void document.body.addEventListener(t,e):void f.nextTick(addEventListener.bind(this,t,e))}function u(t,e){return document.body?(document.body.appendChild(e),void t.emit("resize")):void f.nextTick(u.bind(this,t,e))}var c,l,h=t("./Context"),p=t("./EventHandler"),d=t("./OptionsManager"),f={},_=[],m=[],g=0,v=0,y=[],b=Date.now(),w=!0,E={},S=new p,x={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},P=new d(x),A=10;f.step=function(){g++,v=g;var t=Date.now();if(!(l&&l>t-b)){var e=0;c=t-b,b=t,S.emit("prerender");for(var i=m.length;i--;)m.shift()(g);for(;y.length&&Date.now()-t<A;)y.shift().call(this);for(e=0;e<_.length;e++)_[e].update();S.emit("postrender")}},window.requestAnimationFrame(n),window.addEventListener("resize",r,!1),r();var T=!1;f.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(f):S.pipe(t)},f.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(f):S.unpipe(t)},f.on=function(t,e){return t in E||(E[t]=S.emit.bind(S,t),a(t,E[t])),S.on(t,e)},f.emit=function(t,e){return S.emit(t,e)},f.removeListener=function(t,e){return S.removeListener(t,e)},f.getFPS=function(){return 1e3/c},f.setFPSCap=function(t){l=Math.floor(1e3/t)},f.getOptions=function(t){return P.getOptions(t)},f.setOptions=function(){return P.setOptions.apply(P,arguments)},f.createContext=function(t){!T&&x.appMode&&f.nextTick(s);var e=!1;t||(t=document.createElement(x.containerType),t.classList.add(x.containerClass),e=!0);var i=new h(t);return f.registerContext(i),e&&u(i,t),i},f.registerContext=function(t){return _.push(t),t},f.getContexts=function(){return _},f.deregisterContext=function(t){var e=_.indexOf(t);e>=0&&_.splice(e,1)},f.nextTick=function(t){m.push(t)},f.defer=function(t){y.push(t)},P.on("change",function(t){"fpsCap"===t.id?f.setFPSCap(t.value):"runLoop"===t.id&&!w&&t.value&&(w=!0,window.requestAnimationFrame(n))}),i.exports=f}),i("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode","../utilities/Utility"],function(t,e,i){function n(t){this._node=new o,this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this.options=a.clone(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t)}var r=t("./EventHandler"),s=t("./OptionsManager"),o=t("./RenderNode"),a=t("../utilities/Utility");n.DEFAULT_OPTIONS={},n.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.add=function(){return this._node.add.apply(this._node,arguments)},n.prototype._add=n.prototype.add,n.prototype.render=function(){return this._node.render()},n.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=n}),i("famous/core/ElementOutput",["require","exports","module","./Entity","./EventHandler","./Transform"],function(t,e,i){function n(t){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new l,this._eventOutput.bindThis(this),this.eventForwarder=function(t){this._eventOutput.emit(t.type,t)}.bind(this),this.id=c.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,t&&this.attach(t)}function r(t){for(var e in this._eventOutput.listeners)t.addEventListener(e,this.eventForwarder)}function s(t){for(var e in this._eventOutput.listeners)t.removeEventListener(e,this.eventForwarder)
}function o(t){var e=0===window.orientation?window.screen.width:window.screen.height,i=0===window.orientation?window.screen.height:window.screen.width;navigator.userAgent.indexOf("iPhone")>=0&&window.devicePixelRatio&&(e*=window.devicePixelRatio,i*=window.devicePixelRatio),t[12]=Math.round(t[12]*e)/e,t[13]=Math.round(t[13]*i)/i;for(var n="matrix3d(",r=0;15>r;r++)n+=t[r]<1e-6&&t[r]>-1e-6?"0,":t[r]+",";return n+=t[15]+")"}function a(t){return 100*t[0]+"% "+100*t[1]+"%"}function u(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}{var c=t("./Entity"),l=t("./EventHandler"),h=t("./Transform"),p=!("transform"in document.documentElement.style);window.devicePixelRatio||1}n.prototype.on=function(t,e){this._element&&this._element.addEventListener(t,this.eventForwarder),this._eventOutput.on(t,e)},n.prototype.removeListener=function(t,e){this._eventOutput.removeListener(t,e)},n.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this._eventOutput.emit(t,e);return i&&e&&e.stopPropagation&&e.stopPropagation(),i},n.prototype.pipe=function(t){return this._eventOutput.pipe(t)},n.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},n.prototype.render=function(){return this.id};var d;d=p?function(t,e){t.style.webkitTransform=o(e)}:function(t,e){t.style.transform=o(e)};var f=p?function(t,e){t.style.webkitTransformOrigin=a(e)}:function(t,e){t.style.transformOrigin=a(e)},_=p?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0};n.prototype.commit=function(t){var e=this._element;if(e){{var i=t.transform,n=t.opacity,r=t.origin;t.size}if(!i&&this._matrix)return this._matrix=null,this._opacity=0,void _(e);if(u(this._origin,r)&&(this._originDirty=!0),h.notEquals(this._matrix,i)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==n&&(this._opacity=n,e.style.opacity=n>=1?"0.999999":n),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(r?(this._origin||(this._origin=[0,0]),this._origin[0]=r[0],this._origin[1]=r[1]):this._origin=null,f(e,this._origin),this._originDirty=!1),i||(i=h.identity),this._matrix=i;var s=this._size?h.thenMove(i,[-this._size[0]*r[0],-this._size[1]*r[1],0]):i;d(e,s),this._transformDirty=!1}}},n.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},n.prototype.attach=function(t){this._element=t,r.call(this,t)},n.prototype.detach=function(){var t=this._element;return t&&(s.call(this,t),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,t},i.exports=n}),i("famous/core/Surface",["require","exports","module","./ElementOutput"],function(t,e,i){function n(t){l.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],t&&this.setOptions(t),this._currentTarget=null}function r(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function s(t){for(var e in this.properties)t.style[e]=this.properties[e]}function o(t){for(var e in this.properties)t.style[e]=""}function a(t){for(var e in this.attributes)t.setAttribute(e,this.attributes[e])}function u(t){for(var e in this.attributes)t.removeAttribute(e)}function c(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var l=t("./ElementOutput");n.prototype=Object.create(l.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.setAttributes=function(t){for(var e in t){if("style"===e)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[e]=t[e]}this._attributesDirty=!0},n.prototype.getAttributes=function(){return this.attributes},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];return this._stylesDirty=!0,this},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){return this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0),this},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);return e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0),this},n.prototype.toggleClass=function(t){var e=this.classList.indexOf(t);return e>=0?this.removeClass(t):this.addClass(t),this},n.prototype.setClasses=function(t){var e=0,i=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&i.push(this.classList[e]);for(e=0;e<i.length;e++)this.removeClass(i[e]);for(e=0;e<t.length;e++)this.addClass(t[e]);return this},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){return this.content!==t&&(this.content=t,this._contentDirty=!0),this},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){return t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.attributes&&this.setAttributes(t.attributes),t.content&&this.setContent(t.content),this},n.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);e.style.display="",this.attach(e),this._opacity=null,this._currentTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},n.prototype.commit=function(t){this._currentTarget||this.setup(t.allocator);var e=this._currentTarget,i=t.size;if(this._classesDirty){r.call(this,e);for(var n=this.getClassList(),o=0;o<n.length;o++)e.classList.add(n[o]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(s.call(this,e),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(a.call(this,e),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var u=t.size;if(i=[this.size[0],this.size[1]],void 0===i[0]&&(i[0]=u[0]),void 0===i[1]&&(i[1]=u[1]),i[0]===!0||i[1]===!0){if(i[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var h=e.offsetWidth;this._size&&this._size[0]!==h&&(this._size[0]=h,this._sizeDirty=!0),i[0]=h}else this._size&&(i[0]=this._size[0]);if(i[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var p=e.offsetHeight;this._size&&this._size[1]!==p&&(this._size[1]=p,this._sizeDirty=!0),i[1]=p}else this._size&&(i[1]=this._size[1]);this._trueSizeCheck=!1}}c(this._size,i)&&(this._size||(this._size=[0,0]),this._size[0]=i[0],this._size[1]=i[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(e.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",e.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(e),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),l.prototype.commit.call(this,t)},n.prototype.cleanup=function(t){var e=0,i=this._currentTarget;this._eventOutput.emit("recall"),this.recall(i),i.style.display="none",i.style.opacity="",i.style.width="",i.style.height="",o.call(this,i),u.call(this,i);var n=this.getClassList();for(r.call(this,i),e=0;e<n.length;e++)i.classList.remove(n[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)i.classList.remove(this.elementClass[e]);else i.classList.remove(this.elementClass);this.detach(i),this._currentTarget=null,t.deallocate(i)},n.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},n.prototype.getSize=function(){return this._size?this._size:this.size},n.prototype.setSize=function(t){return this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0,this},i.exports=n}),i("famous/surfaces/ImageSurface",["require","exports","module","../core/Surface"],function(t,e,i){function n(){this._imageUrl=void 0,r.apply(this,arguments)}var r=t("../core/Surface"),s=[],o=[],a=[],u=!0;n.enableCache=function(){u=!0},n.disableCache=function(){u=!1},n.clearCache=function(){s=[],o=[],a=[]},n.getCache=function(){return{urlCache:s,countCache:o,nodeCache:a}},n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.elementType="img",n.prototype.elementClass="famous-surface",n.prototype.setContent=function(t){var e=s.indexOf(this._imageUrl);-1!==e&&(1===o[e]?(s.splice(e,1),o.splice(e,1),a.splice(e,1)):o[e]--),e=s.indexOf(t),-1===e?(s.push(t),o.push(1)):o[e]++,this._imageUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){var e=s.indexOf(this._imageUrl);if(void 0===a[e]&&u){var i=new Image;i.src=this._imageUrl||"",a[e]=i}t.src=this._imageUrl||""},n.prototype.recall=function(t){t.src=""},i.exports=n}),i("helpers/MathFunctions",["require","exports","module"],function(t,e,i){function n(){}n.prototype.constructor=n,n.prototype.sinFunction=function(t,e){return Math.sin(t)*e},n.prototype.sinFunction.period=2*Math.PI,n.prototype.halfOneSinFunction=function(t,e){return(Math.sin(t)+1)/2*e},n.prototype.halfOneSinFunction.period=2*Math.PI,n.prototype.cosFunction=function(t,e){return(1-Math.cos(2*Math.PI*t))/2*e},n.prototype.cosFunction.period=1,n.prototype.absSinFunction=function(t,e){return-Math.abs(Math.sin(t))*e},n.prototype.absSinFunction.period=Math.PI,n.prototype.triangleFunction=function(t,e){return 2/Math.PI*Math.asin(Math.sin(t))*e},n.prototype.triangleFunction.period=2*Math.PI,n.prototype.sawToothFunction=function(t,e){return e*(t-Math.floor(t))},n.prototype.sawToothFunction.period=1,n.prototype.periodChangedFunction=function(t,e){var i=function(i,n){return t(e*i,n)};return i.period=t.period/e,i},n.prototype.cutFunction=function(t,e,i,n){var r=this,s=100/(i-e),o=function(o,a){var u=n*e/100,c=n*i/100,l=o%n;if(u>l||l>c)return 0;var h=r.periodChangedFunction(t,s);return h(l-u,a)};return o.period=t.period/s,o},i.exports=n}),i("helpers/ConfigParser",["require","exports","module","helpers/MathFunctions"],function(t,e,i){function n(){}var r=t("helpers/MathFunctions");n.prototype.constructor=n,n.prototype.parseConfig=function(t,e){var i={};return i.name=t.name,i.pageSpeed=parseFloat(e.page.speed)||1,i.x=parseFloat(t.initialX),i.y=parseFloat(t.initialY),i.scale=parseFloat(t.scale),i.xyRatio=parseFloat(t.xyRatio),i.timeOffset=parseFloat(t.timeOffset),i.translateXSpeed=i.pageSpeed*parseFloat(t.translateXSpeed),i.translateYSpeed=i.pageSpeed*parseFloat(t.translateYSpeed),i.translateX=parseFloat(t.translateX),i.translateY=parseFloat(t.translateY),i.rotateSpeed=i.pageSpeed*parseFloat(t.rotateSpeed),i.rotateAngle=parseFloat(t.rotateAngle),i.skewSpeedX=i.pageSpeed*parseFloat(t.skewSpeedX),i.skewAmountX=parseFloat(t.skewAmountX),i.skewSpeedY=i.pageSpeed*parseFloat(t.skewSpeedY),i.skewAmountY=parseFloat(t.skewAmountY),i.zoomSpeed=i.pageSpeed*parseFloat(t.zoomSpeed),i.zoomAmount=parseFloat(t.zoomAmount),i.zoomCutStart=parseFloat(t.zoomCutStart),i.zoomCutEnd=parseFloat(t.zoomCutEnd),i.translateCutStart=parseFloat(t.translateCutStart),i.translateCutEnd=parseFloat(t.translateCutEnd),i.height=parseFloat(t.height),i.cameraBoundOffset=parseFloat(t.cameraBoundOffset),i.zoomRelativeMultiplier=parseFloat(t.zoomRelativeMultiplier),i.animationSpeed=i.pageSpeed*parseFloat(t.animationSpeed)||100,i.numFrames=parseFloat(t.numFrames),i.motionType=t.motionType,i.zoomType=t.zoomType,i.rotateType=t.rotateType,i.zoomTypeCut=t.zoomTypeCut,i.translateTypeCut=t.translateTypeCut,i.translateFunction=void 0,i.zoomFunction=void 0,i.rotateFunction=void 0,i.skewFunction=void 0,i.animationFunction=r.prototype.sawToothFunction,i.translate=t.translate,i.accel=t.accel,i.accelAmount=parseFloat(t.accelAmount)||1,i.accelRotate=t.accelRotate,i.accelRotateAmount=parseFloat(t.accelRotateAmount)||1,i.rotate=t.rotate,i.skew=t.skew,i.zoom=t.zoom,i.zoomRelativeTranslate=t.zoomRelativeTranslate,i.animation=t.animation,i.cameraBound=t.cameraBound,i.translateFunction="triangle"===i.motionType?r.prototype.triangleFunction:"sawtooth"===i.motionType?r.prototype.sawToothFunction:"cos"===i.motionType?r.prototype.cosFunction:r.prototype.sinFunction,i.zoomFunction="triangle"===i.zoomType?r.prototype.triangleFunction:"sin"===i.zoomType?r.prototype.sinFunction:"cos"===i.zoomType?r.prototype.cosFunction:r.prototype.sawToothFunction,i.rotateFunction="triangle"===i.rotateType?r.prototype.triangleFunction:"sawToothFunction"===i.rotateType?r.prototype.sawToothFunction:"cos"===i.rotateType?r.prototype.cosFunction:r.prototype.sinFunction,i.skewFunction=r.prototype.cosFunction,i.zoomTypeCut&&(i.zoomFunction=r.prototype.cutFunction(i.zoomFunction,i.zoomCutStart,i.zoomCutEnd,i.zoomFunction.period)),i.translateTypeCut&&(i.translateFunction=r.prototype.cutFunction(i.translateFunction,i.translateCutStart,i.translateCutEnd,i.translateFunction.period)),i},i.exports=n}),i("helpers/ParameterTransformer",["require","exports","module","famous/core/Transform","helpers/ConfigParser"],function(t,e,i){function n(t,e){this.model=e,this.parsedConfig=s.prototype.parseConfig(t,e),this.initialTransform=r.thenMove(r.thenScale(r.identity,[this.parsedConfig.scale*this.parsedConfig.xyRatio,this.parsedConfig.scale,1]),[this.parsedConfig.x,this.parsedConfig.y,this.parsedConfig.height])}var r=t("famous/core/Transform"),s=t("helpers/ConfigParser");n.prototype.constructor=n,n.prototype.calculateTransform=function(){var t=parseFloat(Date.now()),e=0,i=0,n=0,s=0,o=0,a=1,u=1,c=1,l=0;if(this.parsedConfig.translate&&(e+=this.parsedConfig.translateFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.translateXSpeed,this.parsedConfig.translateX),i+=this.parsedConfig.translateFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.translateYSpeed,this.parsedConfig.translateY)),this.parsedConfig.accel&&(e+=window.orientationDifference[1]*this.parsedConfig.accelAmount,i+=window.orientationDifference[0]*this.parsedConfig.accelAmount),this.parsedConfig.accelRotate&&(n+=window.orientationDifference[0]*this.parsedConfig.accelRotateAmount,s+=window.orientationDifference[1]*this.parsedConfig.accelRotateAmount),this.parsedConfig.rotate&&(o=this.parsedConfig.rotateFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.rotateSpeed,1/this.parsedConfig.rotateAngle)),this.parsedConfig.skew&&(a=1+this.parsedConfig.skewFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.skewSpeedX,this.parsedConfig.skewAmountX),u=1+this.parsedConfig.skewFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.skewSpeedY,this.parsedConfig.skewAmountY)),this.parsedConfig.zoom&&(c=this.parsedConfig.zoomRelativeTranslate?1+this.parsedConfig.zoomFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.zoomSpeed,this.parsedConfig.zoomRelativeMultiplier/this.parsedConfig.translateY):1+this.parsedConfig.zoomFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.zoomSpeed,this.parsedConfig.zoomAmount)),this.parsedConfig.animation){var h=Math.floor(this.parsedConfig.animationFunction((t+this.parsedConfig.timeOffset)/this.parsedConfig.animationSpeed,this.parsedConfig.numFrames));i-=h*this.model.page.y*this.parsedConfig.scale}this.parsedConfig.cameraBound&&(l=window.mainContext.getPerspective()+this.parsedConfig.cameraBoundOffset);var p=r.thenMove(r.thenScale(r.multiply(r.rotate(n,s,o),this.initialTransform),[c*a,c*u,1]),[e,i,l]);return p},i.exports=n}),i("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","../core/Transform","../utilities/Utility"],function(t,e,i){function n(t){this._final=a.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new o(this._finalTranslate),this.rotate=new o(this._finalRotate),this.skew=new o(this._finalSkew),this.scale=new o(this._finalScale),t&&this.set(t)}function r(){return a.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function s(){return a.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var o=t("./Transitionable"),a=t("../core/Transform"),u=t("../utilities/Utility");n.prototype.setTranslate=function(t,e,i){return this._finalTranslate=t,this._final=s.call(this),this.translate.set(t,e,i),this},n.prototype.setScale=function(t,e,i){return this._finalScale=t,this._final=s.call(this),this.scale.set(t,e,i),this},n.prototype.setRotate=function(t,e,i){return this._finalRotate=t,this._final=s.call(this),this.rotate.set(t,e,i),this},n.prototype.setSkew=function(t,e,i){return this._finalSkew=t,this._final=s.call(this),this.skew.set(t,e,i),this},n.prototype.set=function(t,e,i){var n=a.interpret(t);this._finalTranslate=n.translate,this._finalRotate=n.rotate,this._finalSkew=n.skew,this._finalScale=n.scale,this._final=t;var r=i?u.after(4,i):null;return this.translate.set(n.translate,e,r),this.rotate.set(n.rotate,e,r),this.skew.set(n.skew,e,r),this.scale.set(n.scale,e,r),this},n.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},n.prototype.get=function(){return this.isActive()?r.call(this):this._final},n.prototype.getFinal=function(){return this._final},n.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},n.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},i.exports=n}),i("famous/core/Modifier",["require","exports","module","./Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:s.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size),t.proportions&&this.proportionsFrom(t.proportions))}function r(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var s=t("./Transform"),o=t("../transitions/Transitionable"),a=t("../transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.proportionsFrom=function(t){return t instanceof Function?this._proportionGetter=t:t instanceof Object&&t.get?this._proportionGetter=t.get.bind(t):(this._proportionGetter=null,this._output.proportions=t),this},n.prototype.setTransform=function(t,e,i){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,i),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,e,i){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new o(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,i)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,e,i){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new o(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,i),this):this.originFrom(t)},n.prototype.setAlign=function(t,e,i){return e||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new o(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,e,i),this):this.alignFrom(t)},n.prototype.setSize=function(t,e,i){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new o(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,i),this):this.sizeFrom(t)},n.prototype.setProportions=function(t,e,i){return t&&(e||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new o(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(t,e,i),this):this.proportionsFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getAlign=function(){return this._alignGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},n.prototype.modify=function(t){return r.call(this),this._output.target=t,this._output},i.exports=n}),i("views/PopupView",["require","exports","module","famous/surfaces/ImageSurface","famous/core/Surface","famous/core/View","helpers/ParameterTransformer","famous/core/Modifier","helpers/MathFunctions"],function(t,e,i){function n(){var t=this,e=new u(t.config,t.model);this.modifier=new c({origin:function(){var e=parseFloat(t.config.xOrigin)||0,i=parseFloat(t.config.yOrigin)||0;return[e,i]},transform:function(){t.needsUpdating&&t.updateContent(),"singalong"===t.config.surfaceType?t.updateSingalongText():"highlight"===t.config.surfaceType&&t.updateHighlightText();var i=e.calculateTransform();return i},opacity:function(){return parseFloat(t.config.opacity)||1},align:[0,0]});var i=this.model.page.x,n=this.model.page.y;this.config.animation&&this.config.numFrames?n=this.model.page.y*this.config.numFrames:this.config.sizeX&&this.config.sizeY&&(i=parseFloat(this.config.sizeX),n=parseFloat(this.config.sizeY));var r,a=o,l=[i,n];"plain"===this.config.surfaceType?r='<div class="overlay-text">'+this.config.text+"</div>":"repeatingImage"===this.config.surfaceType?r='<div class="repeating-image"></div>':"singalong"===this.config.surfaceType?(this.textLines=this.config.text.split("\n"),this.currentLine=0,r='<div class="overlay-text"><span class="highlight-text gradient-shadow singalong" title="'+this.textLines[this.currentLine]+'"><div class="highlight-text-div">'+this.textLines[this.currentLine]+"</div></span></div>"):"highlight"===this.config.surfaceType?(this.textLines=this.config.text.split("\n"),this.currentLine=0,this.linesHtml=this.textLines.map(function(t){var e='<span class="highlight-text gradient-shadow" title="'+t+'"><div class="highlight-text-div hightlight-inactive">'+t+"</div></span>";return e}),r='<div class="overlay-text">'+this.linesHtml.join("")+"</div>"):"transparency"===this.config.surfaceType?r='<div class="overlay-text overlay-transparency"></div>':(a=s,r=this.config.url);var h;h=this.config.surfaceClasses?this.config.surfaceClasses.split(" "):[],this.surface=new a({content:r,size:l,classes:h}),this._add(this.modifier).add(this.surface)}function r(t,e){a.apply(this,arguments),this.config=t,this.model=e,n.call(this);var i=this;this.contentInserted=function(){i.needsUpdating=!0,this.updateContent()},this.updateContent=function(){"singalong"===i.config.surfaceType&&i.surface._currTarget?(i.refreshGradient(0),i.needsUpdating=!1):"highlight"===i.config.surfaceType&&i.surface._currTarget?(i.clearGradients(),i.refreshGradient(i.currentLine),i.needsUpdating=!1):"repeatingImage"===i.config.surfaceType&&i.surface._currTarget&&(i.updateBackground(),i.needsUpdating=!1)},this.updateSingalongText=function(){var t=parseFloat(Date.now()),e=parseFloat(i.config.timeOffset),n=parseFloat(i.model.page.speed)||1,r=(parseFloat(i.config.singSpeed)||1)*n,s=Math.floor(l.prototype.sawToothFunction((t+e)/r,i.textLines.length));s!==i.currentLine&&(i.currentLine=s,i.surface.setContent('<div class="overlay-text"><span class="highlight-text gradient-shadow singalong" title="'+i.textLines[i.currentLine]+'"><div class="highlight-text-div">'+i.textLines[i.currentLine]+"</div></span></div>"),i.needsUpdating=!0)},this.updateHighlightText=function(){var t=parseFloat(Date.now()),e=parseFloat(i.config.timeOffset),n=parseFloat(i.model.page.speed)||1,r=(parseFloat(i.config.singSpeed)||1)*n,s=Math.floor(l.prototype.sawToothFunction((t+e)/r,i.textLines.length));s!==i.currentLine&&(i.currentLine=s,i.needsUpdating=!0)},this.updateBackground=function(){var t=i.surface._currTarget.getElementsByClassName("repeating-image")[0];t.setAttribute("style",'background-image:url("'+i.config.url+'");')},this.refreshGradient=function(t){var e=i.surface._currTarget.getElementsByClassName("highlight-text-div")[t],n=e.getBoundingClientRect().width,r=n+80,s=r+80,o=s+80,a=2*n+240,u=n/270;e.setAttribute("style","background-size: "+a+"px 3px;background-image: -webkit-linear-gradient(left, white 0px,white "+n+"px,rgb(53, 205, 247) "+r+"px,rgb(53, 205, 247) "+s+"px,white "+o+"px);-webkit-animation: stripes "+u+"s linear infinite;")},this.clearGradients=function(){var t=i.surface._currTarget.getElementsByClassName("highlight-text-div"),e=Array.prototype.slice.call(t);e.forEach(function(t){t.setAttribute("style","background-size: 100% 100%;background-image: -webkit-linear-gradient(white 0%,white 100%);")})}}var s=t("famous/surfaces/ImageSurface"),o=t("famous/core/Surface"),a=t("famous/core/View"),u=t("helpers/ParameterTransformer"),c=t("famous/core/Modifier"),l=t("helpers/MathFunctions");r.prototype=Object.create(a.prototype),r.prototype.constructor=r,i.exports=r}),i("views/PopupPageView",["require","exports","module","famous/core/View","views/PopupView"],function(t,e,i){function n(){var t=this;this.popupViews=[],this.popups.forEach(function(e){var i=new o(e,t.model);t.popupViews.push(i),t.add(i)})}function r(t){s.apply(this,arguments),this.popups=t.popups,this.model=t,n.call(this);var e=this;this.contentInserted=function(){e.popupViews.forEach(function(t){t.contentInserted()})}}var s=t("famous/core/View"),o=t("views/PopupView");r.prototype=Object.create(s.prototype),r.prototype.constructor=r,i.exports=r}),i("famous/views/Lightbox",["require","exports","module","../core/Transform","../core/Modifier","../core/RenderNode","../utilities/Utility","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var r=t("../core/Transform"),s=t("../core/Modifier"),o=t("../core/RenderNode"),a=t("../utilities/Utility"),u=t("../core/OptionsManager"),c=t("../transitions/Transitionable"),l=t("../transitions/TransitionableTransform");n.DEFAULT_OPTIONS={inTransform:r.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:r.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:r.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},n.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,e,i));this.hide()}this._showing=!0;var n={transform:new l(this.options.inTransform),origin:new c(this.options.inOrigin),align:new c(this.options.inAlign),opacity:new c(this.options.inOpacity)},r=new s({transform:n.transform,opacity:n.opacity,origin:n.origin,align:n.align}),u=new o;u.add(r).add(t),this.nodes.push(u),this.states.push(n),this.transforms.push(r);var h=i?a.after(3,i):void 0;e||(e=this.options.inTransition),n.transform.set(this.options.showTransform,e,h),n.opacity.set(this.options.showOpacity,e,h),n.origin.set(this.options.showOrigin,e,h),n.align.set(this.options.showAlign,e,h)},n.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var i=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],r=this.states[this.states.length-1],s=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(i),1),this.states.splice(this.states.indexOf(r),1),this.transforms.splice(this.transforms.indexOf(n),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),r.transform.set(this.options.outTransform,t,s),r.opacity.set(this.options.outOpacity,t,s),r.origin.set(this.options.outOrigin,t,s),r.align.set(this.options.outAlign,t,s)}},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=n}),i("views/AppView",["require","exports","module","famous/core/View","views/PopupPageView","famous/views/Lightbox","famous/core/Modifier","helpers/ParameterTransformer","helpers/MathFunctions"],function(t,e,i){function n(){r.apply(this,arguments);var t=new a({align:[.5,.5]});window.cameraModifier=t,this.lightbox=new o({}),this.add(t).add(this.lightbox)}var r=t("famous/core/View"),s=t("views/PopupPageView"),o=t("famous/views/Lightbox"),a=t("famous/core/Modifier"),u=t("helpers/ParameterTransformer"),c=t("helpers/MathFunctions");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.createAndShowPage=function(t){window.mainContext.setPerspective(parseFloat(t.page.perspective)),this.contentView=new s(t);
var e=new u(t.camera,t),i=function(){var e=parseFloat(t.camera.xOrigin)||.5,i=parseFloat(t.camera.yOrigin)||.5;return[e,i]},n=function(){var i,n=e.calculateTransform(),r=parseFloat(t.page.speed)||1,s=r*parseFloat(t.camera.perspectiveZoomSpeed),o=parseFloat(t.camera.perspectiveZoomAmount),a=parseFloat(t.camera.perspectiveZoomCutStart),u=parseFloat(t.camera.perspectiveZoomCutEnd);if(i="triangle"===t.camera.perspectiveZoomType?c.prototype.triangleFunction:"sawtooth"===t.camera.perspectiveZoomType?c.prototype.sawToothFunction:"cos"===t.camera.perspectiveZoomType?c.prototype.cosFunction:c.prototype.sinFunction,t.camera.perspectiveZoomCut&&(i=c.prototype.cutFunction(i,a,u,i.period)),t.camera.perspectiveZoom){var l=parseFloat(Date.now())%r,h=parseFloat(t.camera.timeOffset),p=t.page.perspective-i((l+h)/s,o);window.mainContext.setPerspective(p)}return n};window.cameraModifier.setOrigin(i),window.cameraModifier.setTransform(n),this.lightbox.show(this.contentView,null,this.contentView.contentInserted)},n.DEFAULT_OPTIONS={},i.exports=n}),this.createjs=this.createjs||{},function(){var t=createjs.SoundJS=createjs.SoundJS||{};t.version="0.6.0",t.buildDate="Thu, 11 Dec 2014 23:32:09 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n){i[(e+="_")+"constructor"]=n.constructor;for(var r in n)i.hasOwnProperty(r)&&"function"==typeof n[r]&&(i[e+r]=n[r])}return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){for(var i=0,n=t.length;n>i;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},function(){var t=Object.defineProperty?!0:!1,e={};try{Object.defineProperty(e,"bar",{get:function(){return this._bar},set:function(t){this._bar=t}})}catch(i){t=!1}createjs.definePropertySupported=t}(),this.createjs=this.createjs||{},function(){function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var r=n[t];return r&&this.removeEventListener(t,e,i),r=n[t],r?r.push(e):n[t]=[e],e},e.on=function(t,e,i,n,r,s){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,r),n&&t.remove()},s)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var r=n[t];if(r)for(var s=0,o=r.length;o>s;s++)if(r[s]==e){1==o?delete n[t]:r.splice(s,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t){if("string"==typeof t){var e=this._listeners;if(!e||!e[t])return!1;t=new createjs.Event(t)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(i){}if(t.bubbles&&this.parent){for(var n=this,r=[n];n.parent;)r.push(n=n.parent);var s,o=r.length;for(s=o-1;s>=0&&!t.propagationStopped;s--)r[s]._dispatchEvent(t,1+(0==s));for(s=1;o>s&&!t.propagationStopped;s++)r[s]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n=1==e?this._captureListeners:this._listeners;if(t&&n){var r=n[t.type];if(!r||!(i=r.length))return;try{t.currentTarget=this}catch(s){}try{t.eventPhase=e}catch(s){}t.removed=!1,r=r.slice();for(var o=0;i>o&&!t.immediatePropagationStopped;o++){var a=r[o];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(t,"Event")}(window),this.createjs=this.createjs||{},function(){function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin="Anonymous",this.loadTimeout=8e3}var e=t.prototype={},i=t;i.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof i)return e;if(e instanceof Object)return e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=i}(),function(){var t={};t.ABSOLUTE_PATT=/^(?:\w+:)?\/{2}/i,t.RELATIVE_PATT=/^[./]*?\//i,t.EXTENSION_PATT=/\/?[^/]+\.(\w{1,5})$/i,t.parseURI=function(e){var i={absolute:!1,relative:!1};if(null==e)return i;var n=e.indexOf("?");n>-1&&(e=e.substr(0,n));var r;return t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(r=e.match(t.EXTENSION_PATT))&&(i.extension=r[1].toLowerCase()),i},t.formatQueryString=function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},t.buildPath=function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var r=t.slice(n+1);i=i.concat(r.split("&"))}return-1!=n?t.slice(0,n)+"?"+this._formatQueryString(e,i):t+"?"+this._formatQueryString(e,i)},t.isCrossDomain=function(t){var e=document.createElement("a");e.href=t.src;var i=document.createElement("a");i.href=location.href;var n=""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname);return n},t.isLocal=function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},t.isBinary=function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},t.isImageTag=function(t){return t instanceof HTMLImageElement},t.isAudioTag=function(t){return window.HTMLAudioElement?t instanceof HTMLAudioElement:!1},t.isVideoTag=function(t){return window.HTMLVideoElement?t instanceof HTMLVideoElement:void 0},t.isText=function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:return!0;default:return!1}},t.getTypeByExtension=function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}},createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;i.POST="POST",i.GET="GET",i.BINARY="binary",i.CSS="css",i.IMAGE="image",i.JAVASCRIPT="javascript",i.JSON="json",i.JSONP="jsonp",i.MANIFEST="manifest",i.SOUND="sound",i.VIDEO="video",i.SPRITESHEET="spritesheet",i.SVG="svg",i.TEXT="text",i.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return null==window.createjs||this.canceled?!0:!1},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this),i=this;e instanceof Function?e(function(t){i._result=t,i._sendComplete()}):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(t.type)}},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0),this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._tag[this._tagSrcAttribute]=this._item.src},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){this._tag.onstalled=createjs.proxy(this._handleStalled,this),this._tag.onprogress=createjs.proxy(this._handleProgress,this),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._tag.onprogress=null,this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),!this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null==this._request)return void this._handleError();this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}},e.setResponseType=function(t){this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(){if(!this.loaded){this.loaded=!0;var t=this._checkError();if(t)return void this._handleError(t);this._response=this._getResponse(),this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);switch(t){case 404:case 0:return new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),i={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var r=0,o=s.ACTIVEX_VERSIONS.length;o>r;r++){s.ACTIVEX_VERSIONS[r];try{n=new ActiveXObject(axVersions);break}catch(a){}}if(null==n)return!1}t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;var u=null;if(u=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,n.open(t.method||createjs.AbstractLoader.GET,u,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var c in t.headers)i[c]=t.headers[c];for(c in i)n.setRequestHeader(c,i[c]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){function t(){throw"Sound cannot be instantiated"}function e(t,e){this.init(t,e)}var i=t;i.INTERRUPT_ANY="any",i.INTERRUPT_EARLY="early",i.INTERRUPT_LATE="late",i.INTERRUPT_NONE="none",i.PLAY_INITED="playInited",i.PLAY_SUCCEEDED="playSucceeded",i.PLAY_INTERRUPTED="playInterrupted",i.PLAY_FINISHED="playFinished",i.PLAY_FAILED="playFailed",i.SUPPORTED_EXTENSIONS=["mp3","ogg","mpeg","wav","m4a","mp4","aiff","wma","mid"],i.EXTENSION_MAP={m4a:"mp4"},i.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([/.]*?(?:[^?]+)?\/)?((?:[^/?]+)\.(\w+))(?:\?(\S+)?)?$/,i.defaultInterruptBehavior=i.INTERRUPT_NONE,i.alternateExtensions=[],i.activePlugin=null,i._pluginsRegistered=!1,i._lastID=0,i._masterVolume=1,i._masterMute=!1,i._instances=[],i._idHash={},i._preloadHash={},i.addEventListener=null,i.removeEventListener=null,i.removeAllEventListeners=null,i.dispatchEvent=null,i.hasEventListener=null,i._listeners=null,createjs.EventDispatcher.initialize(i),i.getPreloadHandlers=function(){return{callback:createjs.proxy(i.initLoad,i),types:["sound"],extensions:i.SUPPORTED_EXTENSIONS}},i._handleLoadComplete=function(t){var e=t.target.getItem().src;if(i._preloadHash[e])for(var n=0,r=i._preloadHash[e].length;r>n;n++){var s=i._preloadHash[e][n];if(i._preloadHash[e][n]=!0,i.hasEventListener("fileload")){var t=new createjs.Event("fileload");t.src=s.src,t.id=s.id,t.data=s.data,t.sprite=s.sprite,i.dispatchEvent(t)}}},i._handleLoadError=function(t){var e=t.target.getItem().src;if(i._preloadHash[e])for(var n=0,r=i._preloadHash[e].length;r>n;n++){var s=i._preloadHash[e][n];if(i._preloadHash[e][n]=!1,i.hasEventListener("fileerror")){var t=new createjs.Event("fileerror");t.src=s.src,t.id=s.id,t.data=s.data,t.sprite=s.sprite,i.dispatchEvent(t)}}},i._registerPlugin=function(t){return t.isSupported()?(i.activePlugin=new t,!0):!1},i.registerPlugins=function(t){i._pluginsRegistered=!0;for(var e=0,n=t.length;n>e;e++)if(i._registerPlugin(t[e]))return!0;return!1},i.initializeDefaultPlugins=function(){return null!=i.activePlugin?!0:i._pluginsRegistered?!1:i.registerPlugins([createjs.WebAudioPlugin,createjs.HTMLAudioPlugin])?!0:!1},i.isReady=function(){return null!=i.activePlugin},i.getCapabilities=function(){return null==i.activePlugin?null:i.activePlugin._capabilities},i.getCapability=function(t){return null==i.activePlugin?null:i.activePlugin._capabilities[t]},i.initLoad=function(t){return i._registerSound(t)},i._registerSound=function(t){if(!i.initializeDefaultPlugins())return!1;var n=i._parsePath(t.src);if(null==n)return!1;t.src=n.src,t.type="sound";var r=t.data,s=i.activePlugin.defaultNumChannels||null;if(null!=r&&(isNaN(r.channels)?isNaN(r)||(s=parseInt(r)):s=parseInt(r.channels),r.audioSprite))for(var o,a=r.audioSprite.length;a--;)o=r.audioSprite[a],i._idHash[o.id]={src:t.src,startTime:parseInt(o.startTime),duration:parseInt(o.duration)};null!=t.id&&(i._idHash[t.id]={src:t.src});var u=i.activePlugin.register(t,s);return e.create(t.src,s),null!=r&&isNaN(r)?t.data.channels=s||e.maxPerChannel():t.data=s||e.maxPerChannel(),u.type&&(t.type=u.type),u},i.registerSound=function(t,e,n,r){var s={src:t,id:e,data:n};t instanceof Object&&(r=e,s=t),s=createjs.LoadItem.create(s),null!=r&&(s.src=r+t);var o=i._registerSound(s);if(!o)return!1;if(i._preloadHash[s.src]||(i._preloadHash[s.src]=[]),i._preloadHash[s.src].push(s),1==i._preloadHash[s.src].length)o.on("complete",createjs.proxy(this._handleLoadComplete,this)),o.on("error",createjs.proxy(this._handleLoadError,this)),i.activePlugin.preload(o);else if(1==i._preloadHash[s.src][0])return!0;return s},i.registerSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path);for(var n=0,r=t.length;r>n;n++)i[n]=createjs.Sound.registerSound(t[n].src,t[n].id,t[n].data,e);return i},i.registerManifest=function(t,e){try{console.log("createjs.Sound.registerManifest is deprecated, please use createjs.Sound.registerSounds.")}catch(i){}return this.registerSounds(t,e)},i.removeSound=function(t,n){if(null==i.activePlugin)return!1;t instanceof Object&&(t=t.src),t=i._getSrcById(t).src,null!=n&&(t=n+t);var r=i._parsePath(t);if(null==r)return!1;t=r.src;for(var s in i._idHash)i._idHash[s].src==t&&delete i._idHash[s];return e.removeSrc(t),delete i._preloadHash[t],i.activePlugin.removeSound(t),!0},i.removeSounds=function(t,e){var i=[];t.path&&(e?e+=t.path:e=t.path);for(var n=0,r=t.length;r>n;n++)i[n]=createjs.Sound.removeSound(t[n].src,e);return i},i.removeManifest=function(t,e){try{console.log("createjs.Sound.removeManifest is deprecated, please use createjs.Sound.removeSounds.")}catch(n){}return i.removeSounds(t,e)},i.removeAllSounds=function(){i._idHash={},i._preloadHash={},e.removeAll(),i.activePlugin&&i.activePlugin.removeAllSounds()},i.loadComplete=function(t){if(!i.isReady())return!1;var e=i._parsePath(t);return t=e?i._getSrcById(e.src).src:i._getSrcById(t).src,1==i._preloadHash[t][0]},i._parsePath=function(t){"string"!=typeof t&&(t=t.toString());var e=t.match(i.FILE_PATTERN);if(null==e)return!1;for(var n=e[4],r=e[5],s=i.getCapabilities(),o=0;!s[r];)if(r=i.alternateExtensions[o++],o>i.alternateExtensions.length)return null;t=t.replace("."+e[5],"."+r);var a={name:n,src:t,extension:r};return a},i.play=function(t,e,n,r,s,o,a,u,c){e instanceof Object&&(n=e.delay,r=e.offset,s=e.loop,o=e.volume,a=e.pan,u=e.startTime,c=e.duration,e=e.interrupt);var l=i.createInstance(t,u,c),h=i._playInstance(l,e,n,r,s,o,a);return h||l._playFailed(),l},i.createInstance=function(t,n,r){if(!i.initializeDefaultPlugins())return new createjs.DefaultSoundInstance(t,n,r);t=i._getSrcById(t);var s=i._parsePath(t.src),o=null;return null!=s&&null!=s.src?(e.create(s.src),null==n&&(n=t.startTime),o=i.activePlugin.create(s.src,n,r||t.duration)):o=new createjs.DefaultSoundInstance(t,n,r),o.uniqueId=i._lastID++,o},i.setVolume=function(t){if(null==Number(t))return!1;if(t=Math.max(0,Math.min(1,t)),i._masterVolume=t,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(t))for(var e=this._instances,n=0,r=e.length;r>n;n++)e[n].setMasterVolume(t)},i.getVolume=function(){return i._masterVolume},i.setMute=function(t){if(null==t)return!1;if(this._masterMute=t,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(t))for(var e=this._instances,i=0,n=e.length;n>i;i++)e[i].setMasterMute(t);return!0},i.getMute=function(){return this._masterMute},i.stop=function(){for(var t=this._instances,e=t.length;e--;)t[e].stop()},i._playInstance=function(t,e,n,r,s,o,a){if(e instanceof Object&&(n=e.delay,r=e.offset,s=e.loop,o=e.volume,a=e.pan,e=e.interrupt),e=e||i.defaultInterruptBehavior,null==n&&(n=0),null==r&&(r=t.getPosition()),null==s&&(s=t.loop),null==o&&(o=t.volume),null==a&&(a=t.pan),0==n){var u=i._beginPlaying(t,e,r,s,o,a);if(!u)return!1}else{var c=setTimeout(function(){i._beginPlaying(t,e,r,s,o,a)},n);t.delayTimeoutId=c}return this._instances.push(t),!0},i._beginPlaying=function(t,i,n,r,s,o){if(!e.add(t,i))return!1;var a=t._beginPlaying(n,r,s,o);if(!a){var u=createjs.indexOf(this._instances,t);return u>-1&&this._instances.splice(u,1),!1}return!0},i._getSrcById=function(t){return i._idHash[t]||{src:t}},i._playFinished=function(t){e.remove(t);var i=createjs.indexOf(this._instances,t);i>-1&&this._instances.splice(i,1)},createjs.Sound=t,e.channels={},e.create=function(t,i){var n=e.get(t);return null==n?(e.channels[t]=new e(t,i),!0):!1},e.removeSrc=function(t){var i=e.get(t);return null==i?!1:(i._removeAll(),delete e.channels[t],!0)},e.removeAll=function(){for(var t in e.channels)e.channels[t]._removeAll();e.channels={}},e.add=function(t,i){var n=e.get(t.src);return null==n?!1:n._add(t,i)},e.remove=function(t){var i=e.get(t.src);return null==i?!1:(i._remove(t),!0)},e.maxPerChannel=function(){return n.maxDefault},e.get=function(t){return e.channels[t]};var n=e.prototype;n.constructor=e,n.src=null,n.max=null,n.maxDefault=100,n.length=0,n.init=function(t,e){this.src=t,this.max=e||this.maxDefault,-1==this.max&&(this.max=this.maxDefault),this._instances=[]},n._get=function(t){return this._instances[t]},n._add=function(t,e){return this._getSlot(e,t)?(this._instances.push(t),this.length++,!0):!1},n._remove=function(t){var e=createjs.indexOf(this._instances,t);return-1==e?!1:(this._instances.splice(e,1),this.length--,!0)},n._removeAll=function(){for(var t=this.length-1;t>=0;t--)this._instances[t].stop()},n._getSlot=function(e){var i,n;if(e!=t.INTERRUPT_NONE&&(n=this._get(0),null==n))return!0;for(var r=0,s=this.max;s>r;r++){if(i=this._get(r),null==i)return!0;if(i.playState==t.PLAY_FINISHED||i.playState==t.PLAY_INTERRUPTED||i.playState==t.PLAY_FAILED){n=i;break}e!=t.INTERRUPT_NONE&&(e==t.INTERRUPT_EARLY&&i.getPosition()<n.getPosition()||e==t.INTERRUPT_LATE&&i.getPosition()>n.getPosition())&&(n=i)}return null!=n?(n._interrupt(),this._remove(n),!0):!1},n.toString=function(){return"[Sound SoundChannel]"}}(),this.createjs=this.createjs||{},function(){var t=function(t,e,i,n){this.EventDispatcher_constructor(),this.src=t,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._startTime=Math.max(0,e||0),this._volume=1,createjs.definePropertySupported&&Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this._pan=0,createjs.definePropertySupported&&Object.defineProperty(this,"pan",{get:this.getPan,set:this.setPan}),this._duration=Math.max(0,i||0),createjs.definePropertySupported&&Object.defineProperty(this,"duration",{get:this.getDuration,set:this.setDuration}),this._playbackResource=null,createjs.definePropertySupported&&Object.defineProperty(this,"playbackResource",{get:this.getPlaybackResource,set:this.setPlaybackResource}),n!==!1&&n!==!0&&this.setPlaybackResource(n),this._position=0,createjs.definePropertySupported&&Object.defineProperty(this,"position",{get:this.getPosition,set:this.setPosition}),this._loop=0,createjs.definePropertySupported&&Object.defineProperty(this,"loop",{get:this.getLoop,set:this.setLoop}),this._muted=!1,createjs.definePropertySupported&&Object.defineProperty(this,"muted",{get:this.getMuted,set:this.setMuted}),this._paused=!1,createjs.definePropertySupported&&Object.defineProperty(this,"paused",{get:this.getPaused,set:this.setPaused})
},e=createjs.extend(t,createjs.EventDispatcher);e.play=function(t,e,i,n,r,s){return this.playState==createjs.Sound.PLAY_SUCCEEDED?(t instanceof Object&&(i=t.offset,n=t.loop,r=t.volume,s=t.pan),null!=i&&this.setPosition(i),null!=n&&this.setLoop(n),null!=r&&this.setVolume(r),null!=s&&this.setPan(s),void(this._paused&&this.setPaused(!1))):(this._cleanUp(),createjs.Sound._playInstance(this,t,e,i,n,r,s),this)},e.pause=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED?!1:(this.setPaused(!0),!0)},e.resume=function(){return this._paused?(this.setPaused(!1),!0):!1},e.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,this},e.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},e.toString=function(){return"[AbstractSoundInstance]"},e.getPaused=function(){return this._paused},e.setPaused=function(t){return t!==!0&&t!==!1||this._paused==t||1==t&&this.playState!=createjs.Sound.PLAY_SUCCEEDED?void 0:(this._paused=t,t?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this)},e.setVolume=function(t){return t==this._volume?this:(this._volume=Math.max(0,Math.min(1,t)),this._muted||this._updateVolume(),this)},e.getVolume=function(){return this._volume},e.setMute=function(t){this.setMuted(t)},e.getMute=function(){return this._muted},e.setMuted=function(t){return t===!0||t===!1?(this._muted=t,this._updateVolume(),this):void 0},e.getMuted=function(){return this._muted},e.setPan=function(t){return t==this._pan?this:(this._pan=Math.max(-1,Math.min(1,t)),this._updatePan(),this)},e.getPan=function(){return this._pan},e.getPosition=function(){return this._paused||this.playState!=createjs.Sound.PLAY_SUCCEEDED?this._position:this._calculateCurrentPosition()},e.setPosition=function(t){return this._position=Math.max(0,t),this.playState==createjs.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},e.getDuration=function(){return this._duration},e.setDuration=function(t){return t==this._duration?this:(this._duration=Math.max(0,t||0),this._updateDuration(),this)},e.setPlaybackResource=function(t){return this._playbackResource=t,0==this._duration&&this._setDurationFromSource(),this},e.getPlaybackResource=function(){return this._playbackResource},e.getLoop=function(){return this._loop},e.setLoop=function(t){null!=this._playbackResource&&(0!=this._loop&&0==t&&this._removeLooping(t),0==this._loop&&0!=t&&this._addLooping(t)),this._loop=t},e._sendEvent=function(t){var e=new createjs.Event(t);this.dispatchEvent(e)},e._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,createjs.Sound._playFinished(this)},e._interrupt=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},e._beginPlaying=function(t,e,i,n){return this.setPosition(t),this.setLoop(e),this.setVolume(i),this.setPan(n),null!=this._playbackResource&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=createjs.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},e._playFailed=function(){this._cleanUp(),this.playState=createjs.Sound.PLAY_FAILED,this._sendEvent("failed")},e._handleSoundComplete=function(){return this._position=0,0!=this._loop?(this._loop--,this._handleLoop(),void this._sendEvent("loop")):(this._cleanUp(),this.playState=createjs.Sound.PLAY_FINISHED,void this._sendEvent("complete"))},e._handleSoundReady=function(){},e._updateVolume=function(){},e._updatePan=function(){},e._updateDuration=function(){},e._setDurationFromSource=function(){},e._calculateCurrentPosition=function(){},e._updatePosition=function(){},e._removeLooping=function(){},e._addLooping=function(){},e._pause=function(){},e._resume=function(){},e._handleStop=function(){},e._handleCleanUp=function(){},e._handleLoop=function(){},createjs.AbstractSoundInstance=createjs.promote(t,"EventDispatcher"),createjs.DefaultSoundInstance=createjs.AbstractSoundInstance}(),this.createjs=this.createjs||{},function(){var t=function(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._loaderClass,this._soundInstanceClass},e=t.prototype;t._capabilities=null,t.isSupported=function(){return!0},e.register=function(t){if(this._audioSources[t.src]=!0,this._soundInstances[t.src]=[],this._loaders[t.src])return this._loaders[t.src];var e=new this._loaderClass(t);return e.on("complete",createjs.proxy(this._handlePreloadComplete,this)),this._loaders[t.src]=e,e},e.preload=function(t){t.on("error",createjs.proxy(this._handlePreloadError,this)),t.load()},e.isPreloadStarted=function(t){return null!=this._audioSources[t]},e.isPreloadComplete=function(t){return!(null==this._audioSources[t]||1==this._audioSources[t])},e.removeSound=function(t){if(this._soundInstances[t]){for(var e=this._soundInstances[t].length;e--;){var i=this._soundInstances[t][e];i.destroy()}delete this._soundInstances[t],delete this._audioSources[t],this._loaders[t]&&this._loaders[t].destroy(),delete this._loaders[t]}},e.removeAllSounds=function(){for(var t in this._audioSources)this.removeSound(t)},e.create=function(t,e,i){this.isPreloadStarted(t)||this.preload(this.register(t));var n=new this._soundInstanceClass(t,e,i,this._audioSources[t]);return this._soundInstances[t].push(n),n},e.setVolume=function(t){return this._volume=t,this._updateVolume(),!0},e.getVolume=function(){return this._volume},e.setMute=function(){return this._updateVolume(),!0},e.toString=function(){return"[AbstractPlugin]"},e._handlePreloadComplete=function(t){var e=t.target.getItem().src;this._audioSources[e]=t.result;for(var i=0,n=this._soundInstances[e].length;n>i;i++){var r=this._soundInstances[e][i];r.setPlaybackResource(this._audioSources[e])}},e._handlePreloadError=function(){},e._updateVolume=function(){},createjs.AbstractPlugin=t}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.SOUND)}var e=createjs.extend(t,createjs.AbstractLoader);t.context=null,e.toString=function(){return"[WebAudioLoader]"},e._createRequest=function(){this._request=new createjs.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},e._sendComplete=function(){t.context.decodeAudioData(this._rawResult,createjs.proxy(this._handleAudioDecoded,this),createjs.proxy(this._handleError,this))},e._handleAudioDecoded=function(t){this._result=t,this.AbstractLoader__sendComplete()},createjs.WebAudioLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e,n,r){this.AbstractSoundInstance_constructor(t,e,n,r),this.gainNode=i.context.createGain(),this.panNode=i.context.createPanner(),this.panNode.panningModel=i._panningModel,this.panNode.connect(this.gainNode),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=createjs.proxy(this._handleSoundComplete,this)}var e=createjs.extend(t,createjs.AbstractSoundInstance),i=t;i.context=null,i.destinationNode=null,i._panningModel="equalpower",e.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},e.toString=function(){return"[WebAudioSoundInstance]"},e._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},e._removeLooping=function(){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},e._addLooping=function(){this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},e._handleCleanUp=function(){this.sourceNode&&this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},e._cleanUpAudioNode=function(t){return t&&(t.stop(0),t.disconnect(0),t=null),t},e._handleSoundReady=function(){this.gainNode.connect(i.destinationNode);var t=.001*this._duration,e=.001*this._position;this.sourceNode=this._createAndPlayAudioNode(i.context.currentTime-t,e),this._playbackStartTime=this.sourceNode.startTime-e,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(t-e)),0!=this._loop&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},e._createAndPlayAudioNode=function(t,e){var n=i.context.createBufferSource();n.buffer=this.playbackResource,n.connect(this.panNode);var r=.001*this._duration;return n.startTime=t+r,n.start(n.startTime,e+.001*this._startTime,r-e),n},e._pause=function(){this._position=1e3*(i.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),0!=this.gainNode.numberOfOutputs&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},e._resume=function(){this._handleSoundReady()},e._updateVolume=function(){var t=this._muted?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},e._calculateCurrentPosition=function(){return 1e3*(i.context.currentTime-this._playbackStartTime)},e._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},e._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},e._updateDuration=function(){this._pause(),this._resume()},createjs.WebAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this._panningModel=i._panningModel,this._volume=1,this.context=i.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),createjs.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=i._capabilities,this._loaderClass=createjs.WebAudioLoader,this._soundInstanceClass=createjs.WebAudioSoundInstance,this._addPropsToClasses()}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i._capabilities=null,i._panningModel="equalpower",i.context=null,i.isSupported=function(){var t=createjs.BrowserDetect.isIOS||createjs.BrowserDetect.isAndroid||createjs.BrowserDetect.isBlackberry;return"file:"!=location.protocol||t||this._isFileXHRSupported()?(i._generateCapabilities(),null==i.context?!1:!0):!1},i.playEmptySound=function(){var t=i.context.createBufferSource();t.buffer=i.context.createBuffer(1,1,22050),t.connect(i.context.destination),t.start(0,0,0)},i._isFileXHRSupported=function(){var t=!0,e=new XMLHttpRequest;try{e.open("GET","WebAudioPluginTest.fail",!1)}catch(i){return t=!1}e.onerror=function(){t=!1},e.onload=function(){t=404==this.status||200==this.status||0==this.status&&""!=this.response};try{e.send()}catch(i){t=!1}return t},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;if(null==i.context)if(window.AudioContext)i.context=new AudioContext;else{if(!window.webkitAudioContext)return null;i.context=new webkitAudioContext}i._compatibilitySetUp(),i.playEmptySound(),i._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,r=0,s=e.length;s>r;r++){var o=e[r],a=n[o]||o;i._capabilities[o]="no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}i.context.destination.numberOfChannels<2&&(i._capabilities.panning=!1)}},i._compatibilitySetUp=function(){if(i._panningModel="equalpower",!i.context.createGain){i.context.createGain=i.context.createGainNode;var t=i.context.createBufferSource();t.__proto__.start=t.__proto__.noteGrainOn,t.__proto__.stop=t.__proto__.noteOff,i._panningModel=0}},e.toString=function(){return"[WebAudioPlugin]"},e._addPropsToClasses=function(){var t=this._soundInstanceClass;t.context=this.context,t.destinationNode=this.gainNode,t._panningModel=this._panningModel,this._loaderClass.context=this.context},e._updateVolume=function(){var t=createjs.Sound._masterMute?0:this._volume;t!=this.gainNode.gain.value&&(this.gainNode.gain.value=t)},createjs.WebAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),this.createjs=this.createjs||{},function(){function t(t){this.src=t,this.length=0,this.available=0,this.tags=[],this.duration=0}var e=t.prototype;e.constructor=t;var i=t;i.tags={},i.get=function(e){var n=i.tags[e];return null==n&&(n=i.tags[e]=new t(e)),n},i.remove=function(t){var e=i.tags[t];return null==e?!1:(e.removeAll(),delete i.tags[t],!0)},i.getInstance=function(t){var e=i.tags[t];return null==e?null:e.get()},i.setInstance=function(t,e){var n=i.tags[t];return null==n?null:n.set(e)},i.getDuration=function(t){var e=i.tags[t];return null==e?0:e.getDuration()},e.add=function(t){this.tags.push(t),this.length++,this.available++},e.removeAll=function(){for(var t;this.length--;)t=this.tags[this.length],t.parentNode&&t.parentNode.removeChild(t),delete this.tags[this.length];this.src=null,this.tags.length=0},e.get=function(){if(0==this.tags.length)return null;this.available=this.tags.length;var t=this.tags.pop();return null==t.parentNode&&document.body.appendChild(t),t},e.set=function(t){var e=createjs.indexOf(this.tags,t);-1==e&&this.tags.push(t),this.available=this.tags.length},e.getDuration=function(){return this.duration||(this.duration=1e3*this.tags[this.tags.length-1].duration),this.duration},e.toString=function(){return"[HTMLAudioTagPool]"},createjs.HTMLAudioTagPool=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.AbstractSoundInstance_constructor(t,e,i,n),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=createjs.proxy(this._handleSoundComplete,this),this._readyHandler=createjs.proxy(this._handleTagReady,this),this._stalledHandler=createjs.proxy(this.playFailed,this),this._audioSpriteEndHandler=createjs.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=createjs.proxy(this._handleSoundComplete,this),i?this._audioSpriteStopTime=.001*(e+i):this._duration=createjs.HTMLAudioTagPool.getDuration(this.src)}var e=createjs.extend(t,createjs.AbstractSoundInstance);e.setMasterVolume=function(){this._updateVolume()},e.setMasterMute=function(){this._updateVolume()},e.toString=function(){return"[HTMLAudioSoundInstance]"},e._removeLooping=function(){null!=this._playbackResource&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._addLooping=function(){null==this._playbackResource||this._audioSpriteStopTime||(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},e._handleCleanUp=function(){var t=this._playbackResource;if(null!=t){t.pause(),t.loop=!1,t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),t.removeEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{t.currentTime=this._startTime}catch(e){}createjs.HTMLAudioTagPool.setInstance(this.src,t),this._playbackResource=null}},e._beginPlaying=function(t,e,i,n){return this._playbackResource=createjs.HTMLAudioTagPool.getInstance(this.src),this.AbstractSoundInstance__beginPlaying(t,e,i,n)},e._handleSoundReady=function(){if(4!==this._playbackResource.readyState){var t=this._playbackResource;return t.addEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),t.addEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),t.preload="auto",void t.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),0!=this._loop&&(this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},e._handleTagReady=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},e._pause=function(){this._playbackResource.pause()},e._resume=function(){this._playbackResource.play()},e._updateVolume=function(){if(null!=this._playbackResource){var t=this._muted||createjs.Sound._masterMute?0:this._volume*createjs.Sound._masterVolume;t!=this._playbackResource.volume&&(this._playbackResource.volume=t)}},e._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},e._updatePosition=function(){this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(t){this._handleSetPositionSeek(null)}},e._handleSetPositionSeek=function(){null!=this._playbackResource&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._handleAudioSpriteLoop=function(){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),0==this._loop?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},e._handleLoop=function(){0==this._loop&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},e._updateDuration=function(){this._audioSpriteStopTime=.001*(startTime+duration),this.playState==createjs.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(createjs.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(createjs.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},createjs.HTMLAudioSoundInstance=createjs.promote(t,"AbstractSoundInstance")}(),this.createjs=this.createjs||{},function(){function t(){this.AbstractPlugin_constructor(),this.defaultNumChannels=2,this._capabilities=i._capabilities,this._loaderClass=createjs.SoundLoader,this._soundInstanceClass=createjs.HTMLAudioSoundInstance}var e=createjs.extend(t,createjs.AbstractPlugin),i=t;i.MAX_INSTANCES=30,i._AUDIO_READY="canplaythrough",i._AUDIO_ENDED="ended",i._AUDIO_SEEKED="seeked",i._AUDIO_STALLED="stalled",i._TIME_UPDATE="timeupdate",i._capabilities=null,i.enableIOS=!1,i.isSupported=function(){return i._generateCapabilities(),null==i._capabilities?!1:!0},i._generateCapabilities=function(){if(null==i._capabilities){var t=document.createElement("audio");if(null==t.canPlayType)return null;i._capabilities={panning:!0,volume:!0,tracks:-1};for(var e=createjs.Sound.SUPPORTED_EXTENSIONS,n=createjs.Sound.EXTENSION_MAP,r=0,s=e.length;s>r;r++){var o=e[r],a=n[o]||o;i._capabilities[o]="no"!=t.canPlayType("audio/"+o)&&""!=t.canPlayType("audio/"+o)||"no"!=t.canPlayType("audio/"+a)&&""!=t.canPlayType("audio/"+a)}}},e.register=function(t,e){for(var i=createjs.HTMLAudioTagPool.get(t.src),n=null,r=0;e>r;r++)n=this._createTag(t.src),i.add(n);var s=this.AbstractPlugin_register(t,e);return s.setTag(n),s},e.removeSound=function(t){this.AbstractPlugin_removeSound(t),createjs.HTMLAudioTagPool.remove(t)},e.create=function(t,e,i){var n=this.AbstractPlugin_create(t,e,i);return n.setPlaybackResource(null),n},e.toString=function(){return"[HTMLAudioPlugin]"},e.setVolume=e.getVolume=e.setMute=null,e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.HTMLAudioPlugin=createjs.promote(t,"AbstractPlugin")}(),i("soundjs",function(t){return function(){var e;return e||t.createjs.Sound}}(this)),i("BlankyApp",["require","exports","module","famous/core/Engine","views/AppView","soundjs"],function(t,e,i){function n(){window.blanky=this,this.Engine=t("famous/core/Engine"),this.AppView=t("views/AppView"),this.Sound=t("soundjs"),this.Engine.setOptions({appMode:!1}),this.initialPageId="gBqF9PtfBm",window.initialPageId=this.initialPageId,this.mainContext=this.Engine.createContext(document.getElementById("device-screen")),this.mainContext.setPerspective(100),window.mainContext=this.mainContext,window.Engine=this.Engine,this.appView=new this.AppView,this.mainContext.add(this.appView),window.appView=this.appView,this.createMotionBindings()}n.prototype.clearPage=function(){window.appView.lightbox.hide(),this.Sound.removeAllSounds()},n.prototype.loadPage=function(t){var e=window.pagesModel.pages.filter(function(e){return e.objectId===t})[0];window.pageModel=e,window.appView.createAndShowPage(e);var i="content/sounds/",n=window.pageModel.sounds;if(n){this.Sound.alternateExtensions=["mp3"];var r=function(t){var e=window.pageModel.sounds.filter(function(e){return t.src===i+e.src})[0];window.blanky.Sound.play(i+e.src,{loop:e.loop,volume:e.volume})};this.Sound.addEventListener("fileload",r),this.Sound.registerSounds(n,i)}},n.prototype.createMotionBindings=function(){window.DeviceOrientationEvent&&(window.originalOrientation=!1,window.orientationDifference=[0,0,0],window.addEventListener("deviceorientation",function(t){var e=-t.gamma,i=t.beta,n=t.alpha;window.originalOrientation||(window.originalOrientation=[e,i,n]);var r=e-window.originalOrientation[0],s=i-window.originalOrientation[1],o=n-window.originalOrientation[2];r>30&&(r=30),s>30&&(s=30),-30>r&&(r=-30),-30>s&&(s=-30),-30>o&&(s=-30),-30>o&&(s=-30),window.orientationDifference=[r,s,o]},!1))},i.exports=n}),!function(t){t.Parse=t.Parse||{},t.Parse.VERSION="js1.3.2"}(this),function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,s=Function.prototype,o=n.push,a=n.slice,u=n.concat,c=r.toString,l=r.hasOwnProperty,h=n.forEach,p=n.map,d=n.reduce,f=n.reduceRight,_=n.filter,m=n.every,g=n.some,v=n.indexOf,y=n.lastIndexOf,b=Array.isArray,w=Object.keys,E=s.bind,S=function(t){return t instanceof S?t:this instanceof S?void(this._wrapped=t):new S(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):t._=S,S.VERSION="1.4.4";var x=S.each=S.forEach=function(t,e,n){if(null!=t)if(h&&t.forEach===h)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var o in t)if(S.has(t,o)&&e.call(n,t[o],o,t)===i)return};S.map=S.collect=function(t,e,i){var n=[];return null==t?n:p&&t.map===p?t.map(e,i):(x(t,function(t,r,s){n[n.length]=e.call(i,t,r,s)}),n)};var P="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return n&&(e=S.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(x(t,function(t,s,o){r?i=e.call(n,i,t,s,o):(i=t,r=!0)}),!r)throw new TypeError(P);return i},S.reduceRight=S.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=S.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var o=S.keys(t);s=o.length}if(x(t,function(a,u,c){u=o?o[--s]:--s,r?i=e.call(n,i,t[u],u,c):(i=t[u],r=!0)}),!r)throw new TypeError(P);return i},S.find=S.detect=function(t,e,i){var n;return A(t,function(t,r,s){return e.call(i,t,r,s)?(n=t,!0):void 0}),n},S.filter=S.select=function(t,e,i){var n=[];return null==t?n:_&&t.filter===_?t.filter(e,i):(x(t,function(t,r,s){e.call(i,t,r,s)&&(n[n.length]=t)}),n)},S.reject=function(t,e,i){return S.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},S.every=S.all=function(t,e,n){e||(e=S.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):(x(t,function(t,s,o){return(r=r&&e.call(n,t,s,o))?void 0:i}),!!r)};var A=S.some=S.any=function(t,e,n){e||(e=S.identity);var r=!1;return null==t?r:g&&t.some===g?t.some(e,n):(x(t,function(t,s,o){return r||(r=e.call(n,t,s,o))?i:void 0}),!!r)};S.contains=S.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):A(t,function(t){return t===e})},S.invoke=function(t,e){var i=a.call(arguments,2),n=S.isFunction(e);return S.map(t,function(t){return(n?e:t[e]).apply(t,i)})},S.pluck=function(t,e){return S.map(t,function(t){return t[e]})},S.where=function(t,e,i){return S.isEmpty(e)?i?null:[]:S[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},S.findWhere=function(t,e){return S.where(t,e,!0)},S.max=function(t,e,i){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&S.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return x(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o>=n.computed&&(n={value:t,computed:o})}),n.value},S.min=function(t,e,i){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&S.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return x(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o<n.computed&&(n={value:t,computed:o})}),n.value},S.shuffle=function(t){var e,i=0,n=[];return x(t,function(t){e=S.random(i++),n[i-1]=n[e],n[e]=t}),n};var T=function(t){return S.isFunction(t)?t:function(e){return e[t]}};S.sortBy=function(t,e,i){var n=T(e);return S.pluck(S.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index<e.index?-1:1}),"value")};var O=function(t,e,i,n){var r={},s=T(e||S.identity);return x(t,function(e,o){var a=s.call(i,e,o,t);n(r,a,e)}),r};S.groupBy=function(t,e,i){return O(t,e,i,function(t,e,i){(S.has(t,e)?t[e]:t[e]=[]).push(i)})},S.countBy=function(t,e,i){return O(t,e,i,function(t,e){S.has(t,e)||(t[e]=0),t[e]++})},S.sortedIndex=function(t,e,i,n){i=null==i?S.identity:T(i);for(var r=i.call(n,e),s=0,o=t.length;o>s;){var a=s+o>>>1;i.call(n,t[a])<r?s=a+1:o=a}return s},S.toArray=function(t){return t?S.isArray(t)?a.call(t):t.length===+t.length?S.map(t,S.identity):S.values(t):[]},S.size=function(t){return null==t?0:t.length===+t.length?t.length:S.keys(t).length},S.first=S.head=S.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},S.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},S.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},S.rest=S.tail=S.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},S.compact=function(t){return S.filter(t,S.identity)};var j=function(t,e,i){return x(t,function(t){S.isArray(t)?e?o.apply(i,t):j(t,e,i):i.push(t)}),i};S.flatten=function(t,e){return j(t,e,[])},S.without=function(t){return S.difference(t,a.call(arguments,1))},S.uniq=S.unique=function(t,e,i,n){S.isFunction(e)&&(n=i,i=e,e=!1);var r=i?S.map(t,i,n):t,s=[],o=[];return x(r,function(i,n){(e?n&&o[o.length-1]===i:S.contains(o,i))||(o.push(i),s.push(t[n]))}),s},S.union=function(){return S.uniq(u.apply(n,arguments))},S.intersection=function(t){var e=a.call(arguments,1);return S.filter(S.uniq(t),function(t){return S.every(e,function(e){return S.indexOf(e,t)>=0})})},S.difference=function(t){var e=u.apply(n,a.call(arguments,1));return S.filter(t,function(t){return!S.contains(e,t)})},S.zip=function(){for(var t=a.call(arguments),e=S.max(S.pluck(t,"length")),i=new Array(e),n=0;e>n;n++)i[n]=S.pluck(t,""+n);return i},S.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},S.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=S.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(v&&t.indexOf===v)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},S.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(y&&t.lastIndexOf===y)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},S.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,s=new Array(n);n>r;)s[r++]=t,t+=i;return s},S.bind=function(t,e){if(t.bind===E&&E)return E.apply(t,a.call(arguments,1));var i=a.call(arguments,2);return function(){return t.apply(e,i.concat(a.call(arguments)))}},S.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},S.bindAll=function(t){var e=a.call(arguments,1);return 0===e.length&&(e=S.functions(t)),x(e,function(e){t[e]=S.bind(t[e],t)}),t},S.memoize=function(t,e){var i={};return e||(e=S.identity),function(){var n=e.apply(this,arguments);return S.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},S.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},S.defer=function(t){return S.delay.apply(S,[t,1].concat(a.call(arguments,1)))},S.throttle=function(t,e){var i,n,r,s,o=0,a=function(){o=new Date,r=null,s=t.apply(i,n)};return function(){var u=new Date,c=e-(u-o);return i=this,n=arguments,0>=c?(clearTimeout(r),r=null,o=u,s=t.apply(i,n)):r||(r=setTimeout(a,c)),s}},S.debounce=function(t,e,i){var n,r;return function(){var s=this,o=arguments,a=function(){n=null,i||(r=t.apply(s,o))},u=i&&!n;return clearTimeout(n),n=setTimeout(a,e),u&&(r=t.apply(s,o)),r}},S.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},S.wrap=function(t,e){return function(){var i=[t];return o.apply(i,arguments),e.apply(this,i)}},S.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},S.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},S.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)S.has(t,i)&&(e[e.length]=i);return e},S.values=function(t){var e=[];for(var i in t)S.has(t,i)&&e.push(t[i]);return e},S.pairs=function(t){var e=[];for(var i in t)S.has(t,i)&&e.push([i,t[i]]);return e},S.invert=function(t){var e={};for(var i in t)S.has(t,i)&&(e[t[i]]=i);return e},S.functions=S.methods=function(t){var e=[];for(var i in t)S.isFunction(t[i])&&e.push(i);return e.sort()},S.extend=function(t){return x(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},S.pick=function(t){var e={},i=u.apply(n,a.call(arguments,1));return x(i,function(i){i in t&&(e[i]=t[i])}),e},S.omit=function(t){var e={},i=u.apply(n,a.call(arguments,1));for(var r in t)S.contains(i,r)||(e[r]=t[r]);return e},S.defaults=function(t){return x(a.call(arguments,1),function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])}),t},S.clone=function(t){return S.isObject(t)?S.isArray(t)?t.slice():S.extend({},t):t},S.tap=function(t,e){return e(t),t};var C=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;
t instanceof S&&(t=t._wrapped),e instanceof S&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;i.push(t),n.push(e);var o=0,a=!0;if("[object Array]"==r){if(o=t.length,a=o==e.length)for(;o--&&(a=C(t[o],e[o],i,n)););}else{var u=t.constructor,l=e.constructor;if(u!==l&&!(S.isFunction(u)&&u instanceof u&&S.isFunction(l)&&l instanceof l))return!1;for(var h in t)if(S.has(t,h)&&(o++,!(a=S.has(e,h)&&C(t[h],e[h],i,n))))break;if(a){for(h in e)if(S.has(e,h)&&!o--)break;a=!o}}return i.pop(),n.pop(),a};S.isEqual=function(t,e){return C(t,e,[],[])},S.isEmpty=function(t){if(null==t)return!0;if(S.isArray(t)||S.isString(t))return 0===t.length;for(var e in t)if(S.has(t,e))return!1;return!0},S.isElement=function(t){return!(!t||1!==t.nodeType)},S.isArray=b||function(t){return"[object Array]"==c.call(t)},S.isObject=function(t){return t===Object(t)},x(["Arguments","Function","String","Number","Date","RegExp"],function(t){S["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),S.isArguments(arguments)||(S.isArguments=function(t){return!(!t||!S.has(t,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(t){return"function"==typeof t}),S.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},S.isNaN=function(t){return S.isNumber(t)&&t!=+t},S.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},S.isNull=function(t){return null===t},S.isUndefined=function(t){return void 0===t},S.has=function(t,e){return l.call(t,e)},S.noConflict=function(){return t._=e,this},S.identity=function(t){return t},S.times=function(t,e,i){for(var n=Array(t),r=0;t>r;r++)n[r]=e.call(i,r);return n},S.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};R.unescape=S.invert(R.escape);var N={escape:new RegExp("["+S.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(R.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(t){S[t]=function(e){return null==e?"":(""+e).replace(N[t],function(e){return R[t][e]})}}),S.result=function(t,e){if(null==t)return null;var i=t[e];return S.isFunction(i)?i.call(t):i},S.mixin=function(t){x(S.functions(t),function(e){var i=S[e]=t[e];S.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),D.call(this,i.apply(S,t))}})};var I=0;S.uniqueId=function(t){var e=++I+"";return t?t+e:e},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(t,e,i){var n;i=S.defaults({},i,S.templateSettings);var r=new RegExp([(i.escape||L).source,(i.interpolate||L).source,(i.evaluate||L).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(r,function(e,i,n,r,a){return o+=t.slice(s,a).replace(M,function(t){return"\\"+k[t]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+e.length,e}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return n(e,S);var u=function(t){return n.call(this,t,S)};return u.source="function("+(i.variable||"obj")+"){\n"+o+"}",u},S.chain=function(t){return S(t).chain()};var D=function(t){return this._chain?S(t).chain():t};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];S.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],D.call(this,i)}}),x(["concat","join","slice"],function(t){var e=n[t];S.prototype[t]=function(){return D.call(this,e.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(t){t.Parse=t.Parse||{};var i=t.Parse;"undefined"!=typeof exports&&exports._?(i._=exports._.noConflict(),i.localStorage=e("localStorage"),i.XMLHttpRequest=e("xmlhttprequest").XMLHttpRequest,exports.Parse=i):(i._=_.noConflict(),"undefined"!=typeof localStorage&&(i.localStorage=localStorage),"undefined"!=typeof XMLHttpRequest&&(i.XMLHttpRequest=XMLHttpRequest)),"undefined"!=typeof $&&(i.$=$);var n=function(){},r=function(t,e,r){var s;return s=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},i._.extend(s,t),n.prototype=t.prototype,s.prototype=new n,e&&i._.extend(s.prototype,e),r&&i._.extend(s,r),s.prototype.constructor=s,s.__super__=t.prototype,s};i.serverURL="https://api.parse.com","undefined"!=typeof process&&process.versions&&process.versions.node&&(i._isNode=!0),i.initialize=function(t,e,n){if(n)throw"Parse.initialize() was passed a Master Key, which is only allowed from within Node.js.";i._initialize(t,e)},i._initialize=function(t,e,n){i.applicationId=t,i.javaScriptKey=e,i.masterKey=n,i._useMasterKey=!1},i._isNode&&(i.initialize=i._initialize,i.Cloud=i.Cloud||{},i.Cloud.useMasterKey=function(){i._useMasterKey=!0}),i._getParsePath=function(t){if(!i.applicationId)throw"You need to call Parse.initialize before using Parse.";if(t||(t=""),!i._.isString(t))throw"Tried to get a localStorage path that wasn't a String.";return"/"===t[0]&&(t=t.substring(1)),"Parse/"+i.applicationId+"/"+t},i._installationId=null,i._getInstallationId=function(){if(i._installationId)return i._installationId;var t=i._getParsePath("installationId");if(i._installationId=i.localStorage.getItem(t),!i._installationId||""===i._installationId){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};i._installationId=e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e(),i.localStorage.setItem(t,i._installationId)}return i._installationId},i._parseDate=function(t){var e=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$"),i=e.exec(t);if(!i)return null;var n=i[1]||0,r=(i[2]||1)-1,s=i[3]||0,o=i[4]||0,a=i[5]||0,u=i[6]||0,c=i[8]||0;return new Date(Date.UTC(n,r,s,o,a,u,c))},i._ajaxIE8=function(t,e,n){var r=new i.Promise,s=new XDomainRequest;return s.onload=function(){var t;try{t=JSON.parse(s.responseText)}catch(e){r.reject(e)}t&&r.resolve(t)},s.onerror=s.ontimeout=function(){var t={responseText:JSON.stringify({code:i.Error.X_DOMAIN_REQUEST,error:"IE's XDomainRequest does not supply error info."})};r.reject(t)},s.onprogress=function(){},s.open(t,e),s.send(n),r},i._useXDomainRequest=function(){return"undefined"!=typeof XDomainRequest?"withCredentials"in new XMLHttpRequest?!1:!0:!1},i._ajax=function(t,e,n,r,s){var o={success:r,error:s};if(i._useXDomainRequest())return i._ajaxIE8(t,e,n)._thenRunCallbacks(o);var a=new i.Promise,u=!1,c=new i.XMLHttpRequest;return c.onreadystatechange=function(){if(4===c.readyState){if(u)return;if(u=!0,c.status>=200&&c.status<300){var t;try{t=JSON.parse(c.responseText)}catch(e){a.reject(e)}t&&a.resolve(t,c.status,c)}else a.reject(c)}},c.open(t,e,!0),c.setRequestHeader("Content-Type","text/plain"),i._isNode&&c.setRequestHeader("User-Agent","Parse/"+i.VERSION+" (NodeJS "+process.versions.node+")"),c.send(n),a._thenRunCallbacks(o)},i._extend=function(t,e){var i=r(this,t,e);return i.extend=this.extend,i},i._request=function(t){var e=t.route,n=t.className,r=t.objectId,s=t.method,o=t.useMasterKey,a=t.sessionToken,u=t.data;if(!i.applicationId)throw"You must specify your applicationId using Parse.initialize.";if(!i.javaScriptKey&&!i.masterKey)throw"You must specify a key using Parse.initialize.";if(!a){var c=i.User.current();c&&c._sessionToken&&(a=c._sessionToken)}if("batch"!==e&&"classes"!==e&&"events"!==e&&"files"!==e&&"functions"!==e&&"login"!==e&&"push"!==e&&"requestPasswordReset"!==e&&"rest_verify_analytics"!==e&&"users"!==e&&"jobs"!==e&&"config"!==e)throw"Bad route: '"+e+"'.";var l=i.serverURL;"/"!==l.charAt(l.length-1)&&(l+="/"),l+="1/"+e,n&&(l+="/"+n),r&&(l+="/"+r),u=i._.clone(u||{}),"POST"!==s&&(u._method=s,s="POST"),i._.isUndefined(o)&&(o=i._useMasterKey),u._ApplicationId=i.applicationId,o?u._MasterKey=i.masterKey:u._JavaScriptKey=i.javaScriptKey,u._ClientVersion=i.VERSION,u._InstallationId=i._getInstallationId(),a&&(u._SessionToken=a);var h=JSON.stringify(u);return i._ajax(s,l,h).then(null,function(t){var e;if(t&&t.responseText)try{var n=JSON.parse(t.responseText);e=new i.Error(n.code,n.error)}catch(r){e=new i.Error(i.Error.INVALID_JSON,"Received an error with invalid JSON from Parse: "+t.responseText)}else e=new i.Error(i.Error.CONNECTION_FAILED,"XMLHttpRequest failed: "+JSON.stringify(t));return i.Promise.error(e)})},i._getValue=function(t,e){return t&&t[e]?i._.isFunction(t[e])?t[e]():t[e]:null},i._encode=function(t,e,n){var r=i._;if(t instanceof i.Object){if(n)throw"Parse.Objects not allowed here";if(!e||r.include(e,t)||!t._hasData)return t._toPointer();if(!t.dirty())return e=e.concat(t),i._encode(t._toFullJSON(e),e,n);throw"Tried to save an object with a pointer to a new, unsaved object."}if(t instanceof i.ACL)return t.toJSON();if(r.isDate(t))return{__type:"Date",iso:t.toJSON()};if(t instanceof i.GeoPoint)return t.toJSON();if(r.isArray(t))return r.map(t,function(t){return i._encode(t,e,n)});if(r.isRegExp(t))return t.source;if(t instanceof i.Relation)return t.toJSON();if(t instanceof i.Op)return t.toJSON();if(t instanceof i.File){if(!t.url())throw"Tried to save an object containing an unsaved file.";return{__type:"File",name:t.name(),url:t.url()}}if(r.isObject(t)){var s={};return i._objectEach(t,function(t,r){s[r]=i._encode(t,e,n)}),s}return t},i._decode=function(t,e){var n=i._;if(!n.isObject(e))return e;if(n.isArray(e))return i._arrayEach(e,function(t,n){e[n]=i._decode(n,t)}),e;if(e instanceof i.Object)return e;if(e instanceof i.File)return e;if(e instanceof i.Op)return e;if(e.__op)return i.Op._decode(e);if("Pointer"===e.__type&&e.className){var r=i.Object._create(e.className);return r._finishFetch({objectId:e.objectId},!1),r}if("Object"===e.__type&&e.className){var s=e.className;delete e.__type,delete e.className;var o=i.Object._create(s);return o._finishFetch(e,!0),o}if("Date"===e.__type)return i._parseDate(e.iso);if("GeoPoint"===e.__type)return new i.GeoPoint({latitude:e.latitude,longitude:e.longitude});if("ACL"===t)return e instanceof i.ACL?e:new i.ACL(e);if("Relation"===e.__type){var a=new i.Relation(null,t);return a.targetClassName=e.className,a}if("File"===e.__type){var u=new i.File(e.name);return u._url=e.url,u}return i._objectEach(e,function(t,n){e[n]=i._decode(n,t)}),e},i._arrayEach=i._.each,i._traverse=function(t,e,n){if(t instanceof i.Object){if(n=n||[],i._.indexOf(n,t)>=0)return;return n.push(t),i._traverse(t.attributes,e,n),e(t)}return t instanceof i.Relation||t instanceof i.File?e(t):i._.isArray(t)?(i._.each(t,function(r,s){var o=i._traverse(r,e,n);o&&(t[s]=o)}),e(t)):i._.isObject(t)?(i._each(t,function(r,s){var o=i._traverse(r,e,n);o&&(t[s]=o)}),e(t)):e(t)},i._objectEach=i._each=function(t,e){var n=i._;n.isObject(t)?n.each(n.keys(t),function(i){e(t[i],i)}):n.each(t,e)},i._isNullOrUndefined=function(t){return i._.isNull(t)||i._.isUndefined(t)}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Analytics=e.Analytics||{},i.extend(e.Analytics,{track:function(t,n,r){if(t=t||"",t=t.replace(/^\s*/,""),t=t.replace(/\s*$/,""),0===t.length)throw"A name for the custom event must be provided";return i.each(n,function(t,e){if(!i.isString(e)||!i.isString(t))throw'track() dimensions expects keys and values of type "string".'}),r=r||{},e._request({route:"events",className:t,method:"POST",data:{dimensions:n}})._thenRunCallbacks(r)}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Config=function(){this.attributes={},this._escapedAttributes={}},e.Config.current=function(){if(e.Config._currentConfig)return e.Config._currentConfig;var t=e.localStorage.getItem(e._getParsePath(e.Config._CURRENT_CONFIG_KEY)),i=new e.Config;return t&&(i._finishFetch(JSON.parse(t)),e.Config._currentConfig=i),i},e.Config.get=function(t){t=t||{};var i=e._request({route:"config",method:"GET"});return i.then(function(t){if(!t||!t.params){var i=new e.Error(e.Error.INVALID_JSON,"Config JSON response invalid.");return e.Promise.error(i)}var n=new e.Config;return n._finishFetch(t),e.Config._currentConfig=n,n})._thenRunCallbacks(t)},e.Config.prototype={escape:function(t){var n=this._escapedAttributes[t];if(n)return n;var r,s=this.attributes[t];return r=e._isNullOrUndefined(s)?"":i.escape(s.toString()),this._escapedAttributes[t]=r,r},get:function(t){return this.attributes[t]},_finishFetch:function(t){this.attributes=e._decode(null,i.clone(t.params)),e.localStorage.setItem(e._getParsePath(e.Config._CURRENT_CONFIG_KEY),JSON.stringify(t))}},e.Config._currentConfig=null,e.Config._CURRENT_CONFIG_KEY="currentConfig"}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Error=function(t,e){this.code=t,this.message=e},i.extend(e.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,MISSING_CONTENT_TYPE:126,MISSING_CONTENT_LENGTH:127,INVALID_CONTENT_LENGTH:128,FILE_TOO_LARGE:129,FILE_SAVE_ERROR:130,FILE_DELETE_ERROR:153,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,SCRIPT_FAILED:141,VALIDATION_ERROR:142,INVALID_IMAGE_DATA:150,UNSAVED_FILE_ERROR:151,INVALID_PUSH_TIME_ERROR:152,INVALID_EVENT_NAME:160,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252,AGGREGATE_ERROR:600,FILE_READ_ERROR:601,X_DOMAIN_REQUEST:602})}(this),function(){var t=this,e=t.Parse||(t.Parse={}),i=/\s+/,n=Array.prototype.slice;e.Events={on:function(t,e,n){var r,s,o,a,u;if(!e)return this;for(t=t.split(i),r=this._callbacks||(this._callbacks={}),s=t.shift();s;)u=r[s],o=u?u.tail:{},o.next=a={},o.context=n,o.callback=e,r[s]={tail:a,next:u?u.next:o},s=t.shift();return this},off:function(t,e,n){var r,s,o,a,u,c;if(s=this._callbacks){if(!(t||e||n))return delete this._callbacks,this;for(t=t?t.split(i):_.keys(s),r=t.shift();r;)if(o=s[r],delete s[r],o&&(e||n)){for(a=o.tail,o=o.next;o!==a;)u=o.callback,c=o.context,(e&&u!==e||n&&c!==n)&&this.on(r,u,c),o=o.next;r=t.shift()}else r=t.shift();return this}},trigger:function(t){var e,r,s,o,a,u,c;if(!(s=this._callbacks))return this;for(u=s.all,t=t.split(i),c=n.call(arguments,1),e=t.shift();e;){if(r=s[e])for(o=r.tail;(r=r.next)!==o;)r.callback.apply(r.context||this,c);if(r=u)for(o=r.tail,a=[e].concat(c);(r=r.next)!==o;)r.callback.apply(r.context||this,a);e=t.shift()}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off}.call(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.GeoPoint=function(t,n){i.isArray(t)?(e.GeoPoint._validate(t[0],t[1]),this.latitude=t[0],this.longitude=t[1]):i.isObject(t)?(e.GeoPoint._validate(t.latitude,t.longitude),this.latitude=t.latitude,this.longitude=t.longitude):i.isNumber(t)&&i.isNumber(n)?(e.GeoPoint._validate(t,n),this.latitude=t,this.longitude=n):(this.latitude=0,this.longitude=0);var r=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=this.longitude,this.__defineGetter__("latitude",function(){return r._latitude}),this.__defineGetter__("longitude",function(){return r._longitude}),this.__defineSetter__("latitude",function(t){e.GeoPoint._validate(t,r.longitude),r._latitude=t}),this.__defineSetter__("longitude",function(t){e.GeoPoint._validate(r.latitude,t),r._longitude=t}))},e.GeoPoint._validate=function(t,e){if(-90>t)throw"Parse.GeoPoint latitude "+t+" < -90.0.";if(t>90)throw"Parse.GeoPoint latitude "+t+" > 90.0.";if(-180>e)throw"Parse.GeoPoint longitude "+e+" < -180.0.";if(e>180)throw"Parse.GeoPoint longitude "+e+" > 180.0."},e.GeoPoint.current=function(t){var i=new e.Promise;return navigator.geolocation.getCurrentPosition(function(t){i.resolve(new e.GeoPoint({latitude:t.coords.latitude,longitude:t.coords.longitude}))},function(t){i.reject(t)}),i._thenRunCallbacks(t)},e.GeoPoint.prototype={toJSON:function(){return e.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(t){var e=Math.PI/180,i=this.latitude*e,n=this.longitude*e,r=t.latitude*e,s=t.longitude*e,o=i-r,a=n-s,u=Math.sin(o/2),c=Math.sin(a/2),l=u*u+Math.cos(i)*Math.cos(r)*c*c;return l=Math.min(1,l),2*Math.asin(Math.sqrt(l))},kilometersTo:function(t){return 6371*this.radiansTo(t)},milesTo:function(t){return 3958.8*this.radiansTo(t)}}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._,n="*";e.ACL=function(t){var n=this;if(n.permissionsById={},i.isObject(t))if(t instanceof e.User)n.setReadAccess(t,!0),n.setWriteAccess(t,!0);else{if(i.isFunction(t))throw"Parse.ACL() called with a function.  Did you forget ()?";e._objectEach(t,function(t,r){if(!i.isString(r))throw"Tried to create an ACL with an invalid userId.";n.permissionsById[r]={},e._objectEach(t,function(t,e){if("read"!==e&&"write"!==e)throw"Tried to create an ACL with an invalid permission type.";if(!i.isBoolean(t))throw"Tried to create an ACL with an invalid permission value.";n.permissionsById[r][e]=t})})}},e.ACL.prototype.toJSON=function(){return i.clone(this.permissionsById)},e.ACL.prototype._setAccess=function(t,n,r){if(n instanceof e.User?n=n.id:n instanceof e.Role&&(n="role:"+n.getName()),!i.isString(n))throw"userId must be a string.";if(!i.isBoolean(r))throw"allowed must be either true or false.";var s=this.permissionsById[n];if(!s){if(!r)return;s={},this.permissionsById[n]=s}r?this.permissionsById[n][t]=!0:(delete s[t],i.isEmpty(s)&&delete s[n])},e.ACL.prototype._getAccess=function(t,i){i instanceof e.User?i=i.id:i instanceof e.Role&&(i="role:"+i.getName());var n=this.permissionsById[i];return n&&n[t]?!0:!1},e.ACL.prototype.setReadAccess=function(t,e){this._setAccess("read",t,e)},e.ACL.prototype.getReadAccess=function(t){return this._getAccess("read",t)},e.ACL.prototype.setWriteAccess=function(t,e){this._setAccess("write",t,e)},e.ACL.prototype.getWriteAccess=function(t){return this._getAccess("write",t)},e.ACL.prototype.setPublicReadAccess=function(t){this.setReadAccess(n,t)},e.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess(n)},e.ACL.prototype.setPublicWriteAccess=function(t){this.setWriteAccess(n,t)},e.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess(n)},e.ACL.prototype.getRoleReadAccess=function(t){if(t instanceof e.Role&&(t=t.getName()),i.isString(t))return this.getReadAccess("role:"+t);throw"role must be a Parse.Role or a String"},e.ACL.prototype.getRoleWriteAccess=function(t){if(t instanceof e.Role&&(t=t.getName()),i.isString(t))return this.getWriteAccess("role:"+t);throw"role must be a Parse.Role or a String"},e.ACL.prototype.setRoleReadAccess=function(t,n){if(t instanceof e.Role&&(t=t.getName()),i.isString(t))return void this.setReadAccess("role:"+t,n);throw"role must be a Parse.Role or a String"},e.ACL.prototype.setRoleWriteAccess=function(t,n){if(t instanceof e.Role&&(t=t.getName()),i.isString(t))return void this.setWriteAccess("role:"+t,n);throw"role must be a Parse.Role or a String"}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Op=function(){this._initialize.apply(this,arguments)},e.Op.prototype={_initialize:function(){}},i.extend(e.Op,{_extend:e._extend,_opDecoderMap:{},_registerDecoder:function(t,i){e.Op._opDecoderMap[t]=i},_decode:function(t){var i=e.Op._opDecoderMap[t.__op];return i?i(t):void 0}}),e.Op._registerDecoder("Batch",function(t){var i=null;return e._arrayEach(t.ops,function(t){t=e.Op._decode(t),i=t._mergeWithPrevious(i)}),i}),e.Op.Set=e.Op._extend({_initialize:function(t){this._value=t},value:function(){return this._value},toJSON:function(){return e._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}}),e.Op._UNSET={},e.Op.Unset=e.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return e.Op._UNSET}}),e.Op._registerDecoder("Delete",function(){return new e.Op.Unset}),e.Op.Increment=e.Op._extend({_initialize:function(t){this._amount=t},amount:function(){return this._amount},toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(t){if(t){if(t instanceof e.Op.Unset)return new e.Op.Set(this.amount());if(t instanceof e.Op.Set)return new e.Op.Set(t.value()+this.amount());if(t instanceof e.Op.Increment)return new e.Op.Increment(this.amount()+t.amount());throw"Op is invalid after previous op."}return this},_estimate:function(t){return t?t+this.amount():this.amount()}}),e.Op._registerDecoder("Increment",function(t){return new e.Op.Increment(t.amount)}),e.Op.Add=e.Op._extend({_initialize:function(t){this._objects=t},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:e._encode(this.objects())}},_mergeWithPrevious:function(t){if(t){if(t instanceof e.Op.Unset)return new e.Op.Set(this.objects());if(t instanceof e.Op.Set)return new e.Op.Set(this._estimate(t.value()));if(t instanceof e.Op.Add)return new e.Op.Add(t.objects().concat(this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(t){return t?t.concat(this.objects()):i.clone(this.objects())}}),e.Op._registerDecoder("Add",function(t){return new e.Op.Add(e._decode(void 0,t.objects))}),e.Op.AddUnique=e.Op._extend({_initialize:function(t){this._objects=i.uniq(t)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:e._encode(this.objects())}},_mergeWithPrevious:function(t){if(t){if(t instanceof e.Op.Unset)return new e.Op.Set(this.objects());if(t instanceof e.Op.Set)return new e.Op.Set(this._estimate(t.value()));if(t instanceof e.Op.AddUnique)return new e.Op.AddUnique(this._estimate(t.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(t){if(t){var n=i.clone(t);return e._arrayEach(this.objects(),function(t){if(t instanceof e.Object&&t.id){var r=i.find(n,function(i){return i instanceof e.Object&&i.id===t.id});if(r){var s=i.indexOf(n,r);n[s]=t}else n.push(t)}else i.contains(n,t)||n.push(t)}),n}return i.clone(this.objects())}}),e.Op._registerDecoder("AddUnique",function(t){return new e.Op.AddUnique(e._decode(void 0,t.objects))}),e.Op.Remove=e.Op._extend({_initialize:function(t){this._objects=i.uniq(t)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:e._encode(this.objects())}},_mergeWithPrevious:function(t){if(t){if(t instanceof e.Op.Unset)return t;if(t instanceof e.Op.Set)return new e.Op.Set(this._estimate(t.value()));if(t instanceof e.Op.Remove)return new e.Op.Remove(i.union(t.objects(),this.objects()));throw"Op is invalid after previous op."}return this},_estimate:function(t){if(t){var n=i.difference(t,this.objects());return e._arrayEach(this.objects(),function(t){t instanceof e.Object&&t.id&&(n=i.reject(n,function(i){return i instanceof e.Object&&i.id===t.id}))}),n}return[]}}),e.Op._registerDecoder("Remove",function(t){return new e.Op.Remove(e._decode(void 0,t.objects))}),e.Op.Relation=e.Op._extend({_initialize:function(t,n){this._targetClassName=null;var r=this,s=function(t){if(t instanceof e.Object){if(!t.id)throw"You can't add an unsaved Parse.Object to a relation.";if(r._targetClassName||(r._targetClassName=t.className),r._targetClassName!==t.className)throw"Tried to create a Parse.Relation with 2 different types: "+r._targetClassName+" and "+t.className+".";return t.id}return t};this.relationsToAdd=i.uniq(i.map(t,s)),this.relationsToRemove=i.uniq(i.map(n,s))},added:function(){var t=this;return i.map(this.relationsToAdd,function(i){var n=e.Object._create(t._targetClassName);return n.id=i,n})},removed:function(){var t=this;return i.map(this.relationsToRemove,function(i){var n=e.Object._create(t._targetClassName);return n.id=i,n})},toJSON:function(){var t=null,e=null,n=this,r=function(t){return{__type:"Pointer",className:n._targetClassName,objectId:t}},s=null;return this.relationsToAdd.length>0&&(s=i.map(this.relationsToAdd,r),t={__op:"AddRelation",objects:s}),this.relationsToRemove.length>0&&(s=i.map(this.relationsToRemove,r),e={__op:"RemoveRelation",objects:s}),t&&e?{__op:"Batch",ops:[t,e]}:t||e||{}},_mergeWithPrevious:function(t){if(t){if(t instanceof e.Op.Unset)throw"You can't modify a relation after deleting it.";if(t instanceof e.Op.Relation){if(t._targetClassName&&t._targetClassName!==this._targetClassName)throw"Related object must be of class "+t._targetClassName+", but "+this._targetClassName+" was passed in.";var n=i.union(i.difference(t.relationsToAdd,this.relationsToRemove),this.relationsToAdd),r=i.union(i.difference(t.relationsToRemove,this.relationsToAdd),this.relationsToRemove),s=new e.Op.Relation(n,r);return s._targetClassName=this._targetClassName,s}throw"Op is invalid after previous op."}return this},_estimate:function(t,i,n){if(t){if(t instanceof e.Relation){if(this._targetClassName)if(t.targetClassName){if(t.targetClassName!==this._targetClassName)throw"Related object must be a "+t.targetClassName+", but a "+this._targetClassName+" was passed in."}else t.targetClassName=this._targetClassName;return t}throw"Op is invalid after previous op."}var r=new e.Relation(i,n);r.targetClassName=this._targetClassName}}),e.Op._registerDecoder("AddRelation",function(t){return new e.Op.Relation(e._decode(void 0,t.objects),[])}),e.Op._registerDecoder("RemoveRelation",function(t){return new e.Op.Relation([],e._decode(void 0,t.objects))})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Relation=function(t,e){this.parent=t,this.key=e,this.targetClassName=null},e.Relation.prototype={_ensureParentAndKey:function(t,e){if(this.parent=this.parent||t,this.key=this.key||e,this.parent!==t)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==e)throw"Internal Error. Relation retrieved from two different keys."},add:function(t){i.isArray(t)||(t=[t]);var n=new e.Op.Relation(t,[]);this.parent.set(this.key,n),this.targetClassName=n._targetClassName},remove:function(t){i.isArray(t)||(t=[t]);var n=new e.Op.Relation([],t);this.parent.set(this.key,n),this.targetClassName=n._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var t,i;return this.targetClassName?(t=e.Object._getSubclass(this.targetClassName),i=new e.Query(t)):(t=e.Object._getSubclass(this.parent.className),i=new e.Query(t),i._extraOptions.redirectClassNameForKey=this.key),i._addCondition("$relatedTo","object",this.parent._toPointer()),i._addCondition("$relatedTo","key",this.key),i}}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Promise=function(){this._resolved=!1,this._rejected=!1,this._resolvedCallbacks=[],this._rejectedCallbacks=[]},i.extend(e.Promise,{_isPromisesAPlusCompliant:!1,is:function(t){return t&&t.then&&i.isFunction(t.then)},as:function(){var t=new e.Promise;return t.resolve.apply(t,arguments),t},error:function(){var t=new e.Promise;return t.reject.apply(t,arguments),t},when:function(t){var i;i=t&&e._isNullOrUndefined(t.length)?arguments:t;var n=i.length,r=!1,s=[],o=[];if(s.length=i.length,o.length=i.length,0===n)return e.Promise.as.apply(this,s);var a=new e.Promise,u=function(){n-=1,0===n&&(r?a.reject(o):a.resolve.apply(a,s))};return e._arrayEach(i,function(t,i){e.Promise.is(t)?t.then(function(t){s[i]=t,u()},function(t){o[i]=t,r=!0,u()}):(s[i]=t,u())}),a},_continueWhile:function(t,i){return t()?i().then(function(){return e.Promise._continueWhile(t,i)}):e.Promise.as()}}),i.extend(e.Promise.prototype,{resolve:function(){if(this._resolved||this._rejected)throw"A promise was resolved even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._resolved=!0,this._result=arguments;var t=arguments;e._arrayEach(this._resolvedCallbacks,function(e){e.apply(this,t)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},reject:function(t){if(this._resolved||this._rejected)throw"A promise was rejected even though it had already been "+(this._resolved?"resolved":"rejected")+".";this._rejected=!0,this._error=t,e._arrayEach(this._rejectedCallbacks,function(e){e(t)}),this._resolvedCallbacks=[],this._rejectedCallbacks=[]},then:function(t,i){var n=new e.Promise,r=function(){var i=arguments;if(t)if(e.Promise._isPromisesAPlusCompliant)try{i=[t.apply(this,i)]}catch(r){i=[e.Promise.error(r)]}else i=[t.apply(this,i)];1===i.length&&e.Promise.is(i[0])?i[0].then(function(){n.resolve.apply(n,arguments)},function(t){n.reject(t)}):n.resolve.apply(n,i)},s=function(t){var r=[];if(i){if(e.Promise._isPromisesAPlusCompliant)try{r=[i(t)]}catch(s){r=[e.Promise.error(s)]}else r=[i(t)];1===r.length&&e.Promise.is(r[0])?r[0].then(function(){n.resolve.apply(n,arguments)},function(t){n.reject(t)}):e.Promise._isPromisesAPlusCompliant?n.resolve.apply(n,r):n.reject(r[0])}else n.reject(t)},o=function(t){t.call()};e.Promise._isPromisesAPlusCompliant&&("undefined"!=typeof window&&window.setTimeout?o=function(t){window.setTimeout(t,0)}:"undefined"!=typeof process&&process.nextTick&&(o=function(t){process.nextTick(t)}));var a=this;return this._resolved?o(function(){r.apply(a,a._result)}):this._rejected?o(function(){s(a._error)}):(this._resolvedCallbacks.push(r),this._rejectedCallbacks.push(s)),n},always:function(t){return this.then(t,t)},done:function(t){return this.then(t)},fail:function(t){return this.then(null,t)},_thenRunCallbacks:function(t,n){var r;if(i.isFunction(t)){var s=t;r={success:function(t){s(t,null)},error:function(t){s(null,t)}}}else r=i.clone(t);return r=r||{},this.then(function(t){return r.success?r.success.apply(this,arguments):n&&n.trigger("sync",n,t,r),e.Promise.as.apply(e.Promise,arguments)},function(t){return r.error?i.isUndefined(n)?r.error(t):r.error(n,t):n&&n.trigger("error",n,t,r),e.Promise.error(t)})},_continueWith:function(t){return this.then(function(){return t(arguments,null)},function(e){return t(null,e)})}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._,n=function(t){if(26>t)return String.fromCharCode(65+t);if(52>t)return String.fromCharCode(97+(t-26));if(62>t)return String.fromCharCode(48+(t-52));if(62===t)return"+";if(63===t)return"/";throw"Tried to encode large digit "+t+" in base64."},r=function(t){var e=[];return e.length=Math.ceil(t.length/3),i.times(e.length,function(i){var r=t[3*i],s=t[3*i+1]||0,o=t[3*i+2]||0,a=3*i+1<t.length,u=3*i+2<t.length;e[i]=[n(63&r>>2),n(48&r<<4|15&s>>4),a?n(60&s<<2|3&o>>6):"=",u?n(63&o):"="].join("")}),e.join("")},s={ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",asc:"text/plain",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bcpio:"application/x-bcpio",bin:"application/octet-stream",bmp:"image/bmp",cdf:"application/x-netcdf",cgm:"image/cgm","class":"application/octet-stream",cpio:"application/x-cpio",cpt:"application/mac-compactpro",csh:"application/x-csh",css:"text/css",dcr:"application/x-director",dif:"video/x-dv",dir:"application/x-director",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docm:"application/vnd.ms-word.document.macroEnabled.12",dotm:"application/vnd.ms-word.template.macroEnabled.12",dtd:"application/xml-dtd",dv:"video/x-dv",dvi:"application/x-dvi",dxr:"application/x-director",eps:"application/postscript",etx:"text/x-setext",exe:"application/octet-stream",ez:"application/andrew-inset",gif:"image/gif",gram:"application/srgs",grxml:"application/srgs+xml",gtar:"application/x-gtar",hdf:"application/x-hdf",hqx:"application/mac-binhex40",htm:"text/html",html:"text/html",ice:"x-conference/x-cooltalk",ico:"image/x-icon",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",jnlp:"application/x-java-jnlp-file",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",kar:"audio/midi",latex:"application/x-latex",lha:"application/octet-stream",lzh:"application/octet-stream",m3u:"audio/x-mpegurl",m4a:"audio/mp4a-latm",m4b:"audio/mp4a-latm",m4p:"audio/mp4a-latm",m4u:"video/vnd.mpegurl",m4v:"video/x-m4v",mac:"image/x-macpaint",man:"application/x-troff-man",mathml:"application/mathml+xml",me:"application/x-troff-me",mesh:"model/mesh",mid:"audio/midi",midi:"audio/midi",mif:"application/vnd.mif",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",ms:"application/x-troff-ms",msh:"model/mesh",mxu:"video/vnd.mpegurl",nc:"application/x-netcdf",oda:"application/oda",ogg:"application/ogg",pbm:"image/x-portable-bitmap",pct:"image/pict",pdb:"chemical/x-pdb",pdf:"application/pdf",pgm:"image/x-portable-graymap",pgn:"application/x-chess-pgn",pic:"image/pict",pict:"image/pict",png:"image/png",pnm:"image/x-portable-anymap",pnt:"image/x-macpaint",pntg:"image/x-macpaint",ppm:"image/x-portable-pixmap",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppam:"application/vnd.ms-powerpoint.addin.macroEnabled.12",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",potm:"application/vnd.ms-powerpoint.template.macroEnabled.12",ppsm:"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",ps:"application/postscript",qt:"video/quicktime",qti:"image/x-quicktime",qtif:"image/x-quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rdf:"application/rdf+xml",rgb:"image/x-rgb",rm:"application/vnd.rn-realmedia",roff:"application/x-troff",rtf:"text/rtf",rtx:"text/richtext",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",shar:"application/x-shar",silo:"model/mesh",sit:"application/x-stuffit",skd:"application/x-koan",skm:"application/x-koan",skp:"application/x-koan",skt:"application/x-koan",smi:"application/smil",smil:"application/smil",snd:"audio/basic",so:"application/octet-stream",spl:"application/x-futuresplash",src:"application/x-wais-source",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",svg:"image/svg+xml",swf:"application/x-shockwave-flash",t:"application/x-troff",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",tsv:"text/tab-separated-values",txt:"text/plain",ustar:"application/x-ustar",vcd:"application/x-cdlink",vrml:"model/vrml",vxml:"application/voicexml+xml",wav:"audio/x-wav",wbmp:"image/vnd.wap.wbmp",wbmxl:"application/vnd.wap.wbxml",wml:"text/vnd.wap.wml",wmlc:"application/vnd.wap.wmlc",wmls:"text/vnd.wap.wmlscript",wmlsc:"application/vnd.wap.wmlscriptc",wrl:"model/vrml",xbm:"image/x-xbitmap",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xml:"application/xml",xpm:"image/x-xpixmap",xsl:"application/xml",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xltm:"application/vnd.ms-excel.template.macroEnabled.12",xlam:"application/vnd.ms-excel.addin.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xslt:"application/xslt+xml",xul:"application/vnd.mozilla.xul+xml",xwd:"image/x-xwindowdump",xyz:"chemical/x-xyz",zip:"application/zip"},o=function(t,i){var n=new e.Promise;
if("undefined"==typeof FileReader)return e.Promise.error(new e.Error(e.Error.FILE_READ_ERROR,"Attempted to use a FileReader on an unsupported browser."));var r=new FileReader;return r.onloadend=function(){if(2!==r.readyState)return void n.reject(new e.Error(e.Error.FILE_READ_ERROR,"Error reading file."));var t=r.result,s=/^data:([^;]*);base64,(.*)$/.exec(t);return s?void n.resolve(s[2],i||s[1]):void n.reject(new e.Error(e.Error.FILE_READ_ERROR,"Unable to interpret data URL: "+t))},r.readAsDataURL(t),n};e.File=function(t,n,a){this._name=t;var u=/\.([^.]*)$/.exec(t);u&&(u=u[1].toLowerCase());var c=a||s[u]||"text/plain";if(i.isArray(n))this._source=e.Promise.as(r(n),c);else if(n&&n.base64){var l=/^data:([a-zA-Z]*\/[a-zA-Z+.-]*);(charset=[a-zA-Z0-9\-\/\s]*,)?base64,(\S+)/,h=l.exec(n.base64);this._source=h&&h.length>0?e.Promise.as(4===h.length?h[3]:h[2],h[1]):e.Promise.as(n.base64,c)}else if("undefined"!=typeof File&&n instanceof File)this._source=o(n,a);else if(i.isString(n))throw"Creating a Parse.File from a String is not yet supported."},e.File.prototype={name:function(){return this._name},url:function(){return this._url},save:function(t){t=t||{};var i=this;return i._previousSave||(i._previousSave=i._source.then(function(n,r){var s={base64:n,_ContentType:r};return e._request({route:"files",className:i._name,method:"POST",data:s,useMasterKey:t.useMasterKey})}).then(function(t){return i._name=t.name,i._url=t.url,i})),i._previousSave._thenRunCallbacks(t)}}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Object=function(t,n){if(i.isString(t))return e.Object._create.apply(this,arguments);t=t||{},n&&n.parse&&(t=this.parse(t));var r=e._getValue(this,"defaults");if(r&&(t=i.extend({},r,t)),n&&n.collection&&(this.collection=n.collection),this._serverData={},this._opSetQueue=[{}],this.attributes={},this._hashedJSON={},this._escapedAttributes={},this.cid=i.uniqueId("c"),this.changed={},this._silent={},this._pending={},!this.set(t,{silent:!0}))throw new Error("Can't create an invalid Parse.Object");this.changed={},this._silent={},this._pending={},this._hasData=!0,this._previousAttributes=i.clone(this.attributes),this.initialize.apply(this,arguments)},e.Object.saveAll=function(t,i){return i=i||{},e.Object._deepSaveAsync(t,{useMasterKey:i.useMasterKey})._thenRunCallbacks(i)},e.Object.destroyAll=function(t,n){n=n||{};var r=function(t){t.trigger("destroy",t,t.collection,n)},s=[],o=function(t){var o=e.Promise.as();return t.length>0&&(o=o.then(function(){return e._request({route:"batch",method:"POST",useMasterKey:n.useMasterKey,data:{requests:i.map(t,function(t){return{method:"DELETE",path:"/1/classes/"+t.className+"/"+t.id}})}})}).then(function(i){e._arrayEach(t,function(t,o){if(i[o].success&&n.wait)r(t);else if(i[o].error){var a=new e.Error(i[o].error.code,i[o].error.error);a.object=t,s.push(a)}})})),o},a=e.Promise.as(),u=[];return e._arrayEach(t,function(e,i){if(e.id&&n.wait||r(e),e.id&&u.push(e),20===u.length||i+1===t.length){var s=u;u=[],a=a.then(function(){return o(s)})}}),a.then(function(){if(0===s.length)return!0;var t=new e.Error(e.Error.AGGREGATE_ERROR,"Error deleting an object in destroyAll");return t.errors=s,e.Promise.error(t)})._thenRunCallbacks(n)},e.Object.fetchAll=function(t,i){return e.Object._fetchAll(t,!0)._thenRunCallbacks(i)},e.Object.fetchAllIfNeeded=function(t,i){return e.Object._fetchAll(t,!1)._thenRunCallbacks(i)},i.extend(e.Object.prototype,e.Events,{_existed:!1,initialize:function(){},toJSON:function(){var t=this._toFullJSON();return e._arrayEach(["__type","className"],function(e){delete t[e]}),t},_toFullJSON:function(t){var n=i.clone(this.attributes);return e._objectEach(n,function(i,r){n[r]=e._encode(i,t)}),e._objectEach(this._operations,function(t,e){n[e]=t}),i.has(this,"id")&&(n.objectId=this.id),i.has(this,"createdAt")&&(n.createdAt=i.isDate(this.createdAt)?this.createdAt.toJSON():this.createdAt),i.has(this,"updatedAt")&&(n.updatedAt=i.isDate(this.updatedAt)?this.updatedAt.toJSON():this.updatedAt),n.__type="Object",n.className=this.className,n},_refreshCache:function(){var t=this;t._refreshingCache||(t._refreshingCache=!0,e._objectEach(this.attributes,function(n,r){n instanceof e.Object?n._refreshCache():i.isObject(n)&&t._resetCacheForKey(r)&&t.set(r,new e.Op.Set(n),{silent:!0})}),delete t._refreshingCache)},dirty:function(t){this._refreshCache();var e=i.last(this._opSetQueue);return t?e[t]?!0:!1:this.id?i.keys(e).length>0?!0:!1:!0},dirtyKeys:function(){return i.keys(i.last(this._opSetQueue))},_toPointer:function(){if(!this.id)throw new Error("Can't serialize an unsaved Parse.Object");return{__type:"Pointer",className:this.className,objectId:this.id}},get:function(t){return this.attributes[t]},relation:function(t){var i=this.get(t);if(i){if(!(i instanceof e.Relation))throw"Called relation() on non-relation field "+t;return i._ensureParentAndKey(this,t),i}return new e.Relation(this,t)},escape:function(t){var n=this._escapedAttributes[t];if(n)return n;var r,s=this.attributes[t];return r=e._isNullOrUndefined(s)?"":i.escape(s.toString()),this._escapedAttributes[t]=r,r},has:function(t){return!e._isNullOrUndefined(this.attributes[t])},_mergeMagicFields:function(t){var n=this,r=["id","objectId","createdAt","updatedAt"];e._arrayEach(r,function(r){t[r]&&("objectId"===r?n.id=t[r]:n[r]="createdAt"!==r&&"updatedAt"!==r||i.isDate(t[r])?t[r]:e._parseDate(t[r]),delete t[r])})},_copyServerData:function(t){var i={};e._objectEach(t,function(t,n){i[n]=e._decode(n,t)}),this._serverData=i,this._rebuildAllEstimatedData(),this._refreshCache(),this._opSetQueue=[{}],this._rebuildAllEstimatedData()},_mergeFromObject:function(t){t&&(this.id=t.id,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this._copyServerData(t._serverData),this._hasData=!0)},_startSave:function(){this._opSetQueue.push({})},_cancelSave:function(){var t=i.first(this._opSetQueue);this._opSetQueue=i.rest(this._opSetQueue);var n=i.first(this._opSetQueue);e._objectEach(t,function(e,i){var r=t[i],s=n[i];r&&s?n[i]=s._mergeWithPrevious(r):r&&(n[i]=r)}),this._saving=this._saving-1},_finishSave:function(t){var n={};e._traverse(this.attributes,function(t){t instanceof e.Object&&t.id&&t._hasData&&(n[t.id]=t)});var r=i.first(this._opSetQueue);this._opSetQueue=i.rest(this._opSetQueue),this._applyOpSet(r,this._serverData),this._mergeMagicFields(t);var s=this;e._objectEach(t,function(t,i){s._serverData[i]=e._decode(i,t);var r=e._traverse(s._serverData[i],function(t){return t instanceof e.Object&&n[t.id]?n[t.id]:void 0});r&&(s._serverData[i]=r)}),this._rebuildAllEstimatedData(),this._saving=this._saving-1},_finishFetch:function(t,e){this._opSetQueue=[{}],this._mergeMagicFields(t),this._copyServerData(t),this._hasData=e},_applyOpSet:function(t,i){var n=this;e._objectEach(t,function(t,r){i[r]=t._estimate(i[r],n,r),i[r]===e.Op._UNSET&&delete i[r]})},_resetCacheForKey:function(t){var n=this.attributes[t];if(!(!i.isObject(n)||n instanceof e.Object||n instanceof e.File)){n=n.toJSON?n.toJSON():n;var r=JSON.stringify(n);if(this._hashedJSON[t]!==r){var s=!!this._hashedJSON[t];return this._hashedJSON[t]=r,s}}return!1},_rebuildEstimatedDataForKey:function(t){var i=this;delete this.attributes[t],this._serverData[t]&&(this.attributes[t]=this._serverData[t]),e._arrayEach(this._opSetQueue,function(n){var r=n[t];r&&(i.attributes[t]=r._estimate(i.attributes[t],i,t),i.attributes[t]===e.Op._UNSET?delete i.attributes[t]:i._resetCacheForKey(t))})},_rebuildAllEstimatedData:function(){var t=this,n=i.clone(this.attributes);this.attributes=i.clone(this._serverData),e._arrayEach(this._opSetQueue,function(i){t._applyOpSet(i,t.attributes),e._objectEach(i,function(e,i){t._resetCacheForKey(i)})}),e._objectEach(n,function(e,i){t.attributes[i]!==e&&t.trigger("change:"+i,t,t.attributes[i],{})}),e._objectEach(this.attributes,function(e,r){i.has(n,r)||t.trigger("change:"+r,t,e,{})})},set:function(t,n,r){var s;if(i.isObject(t)||e._isNullOrUndefined(t)?(s=t,e._objectEach(s,function(t,i){s[i]=e._decode(i,t)}),r=n):(s={},s[t]=e._decode(t,n)),r=r||{},!s)return this;s instanceof e.Object&&(s=s.attributes),r.unset&&e._objectEach(s,function(t,i){s[i]=new e.Op.Unset});var o=i.clone(s),a=this;if(e._objectEach(o,function(t,i){t instanceof e.Op&&(o[i]=t._estimate(a.attributes[i],a,i),o[i]===e.Op._UNSET&&delete o[i])}),!this._validate(s,r))return!1;this._mergeMagicFields(s),r.changes={};var u=this._escapedAttributes;return this._previousAttributes||{},e._arrayEach(i.keys(s),function(t){var n=s[t];n instanceof e.Relation&&(n.parent=a),n instanceof e.Op||(n=new e.Op.Set(n));var o=!0;n instanceof e.Op.Set&&i.isEqual(a.attributes[t],n.value)&&(o=!1),o&&(delete u[t],r.silent?a._silent[t]=!0:r.changes[t]=!0);var c=i.last(a._opSetQueue);c[t]=n._mergeWithPrevious(c[t]),a._rebuildEstimatedDataForKey(t),o?(a.changed[t]=a.attributes[t],r.silent||(a._pending[t]=!0)):(delete a.changed[t],delete a._pending[t])}),r.silent||this.change(r),this},unset:function(t,e){return e=e||{},e.unset=!0,this.set(t,null,e)},increment:function(t,n){return(i.isUndefined(n)||i.isNull(n))&&(n=1),this.set(t,new e.Op.Increment(n))},add:function(t,i){return this.set(t,new e.Op.Add([i]))},addUnique:function(t,i){return this.set(t,new e.Op.AddUnique([i]))},remove:function(t,i){return this.set(t,new e.Op.Remove([i]))},op:function(t){return i.last(this._opSetQueue)[t]},clear:function(t){t=t||{},t.unset=!0;var e=i.extend(this.attributes,this._operations);return this.set(e,t)},_getSaveJSON:function(){var t=i.clone(i.first(this._opSetQueue));return e._objectEach(t,function(e,i){t[i]=e.toJSON()}),t},_canBeSerialized:function(){return e.Object._canBeSerializedAsValue(this.attributes)},fetch:function(t){var i=this;t=t||{};var n=e._request({method:"GET",route:"classes",className:this.className,objectId:this.id,useMasterKey:t.useMasterKey});return n.then(function(t,e,n){return i._finishFetch(i.parse(t,e,n),!0),i})._thenRunCallbacks(t,this)},save:function(t,n,r){var s,o,a;if(i.isObject(t)||e._isNullOrUndefined(t)?(s=t,a=n):(s={},s[t]=n,a=r),!a&&s){var u=i.reject(s,function(t,e){return i.include(["success","error","wait"],e)});if(0===u.length){var c=!0;if(i.has(s,"success")&&!i.isFunction(s.success)&&(c=!1),i.has(s,"error")&&!i.isFunction(s.error)&&(c=!1),c)return this.save(null,s)}}a=i.clone(a)||{},a.wait&&(o=i.clone(this.attributes));var l=i.clone(a)||{};l.wait&&(l.silent=!0);var h;if(l.error=function(t,e){h=e},s&&!this.set(s,l))return e.Promise.error(h)._thenRunCallbacks(a,this);var p=this;p._refreshCache();var d=[],f=[];return e.Object._findUnsavedChildren(p.attributes,d,f),d.length+f.length>0?e.Object._deepSaveAsync(this.attributes,{useMasterKey:a.useMasterKey}).then(function(){return p.save(null,a)},function(t){return e.Promise.error(t)._thenRunCallbacks(a,p)}):(this._startSave(),this._saving=(this._saving||0)+1,this._allPreviousSaves=this._allPreviousSaves||e.Promise.as(),this._allPreviousSaves=this._allPreviousSaves._continueWith(function(){var t=p.id?"PUT":"POST",n=p._getSaveJSON(),r="classes",u=p.className;"_User"!==p.className||p.id||(r="users",u=null);var c=e._request({route:r,className:u,objectId:p.id,method:t,useMasterKey:a.useMasterKey,data:n});return c=c.then(function(t,e,n){var r=p.parse(t,e,n);return a.wait&&(r=i.extend(s||{},r)),p._finishSave(r),a.wait&&p.set(o,l),p},function(t){return p._cancelSave(),e.Promise.error(t)})._thenRunCallbacks(a,p)}),this._allPreviousSaves)},destroy:function(t){t=t||{};var i=this,n=function(){i.trigger("destroy",i,i.collection,t)};if(!this.id)return n();t.wait||n();var r=e._request({route:"classes",className:this.className,objectId:this.id,method:"DELETE",useMasterKey:t.useMasterKey});return r.then(function(){return t.wait&&n(),i})._thenRunCallbacks(t,this)},parse:function(t,n){var r=i.clone(t);return i(["createdAt","updatedAt"]).each(function(t){r[t]&&(r[t]=e._parseDate(r[t]))}),r.updatedAt||(r.updatedAt=r.createdAt),n&&(this._existed=201!==n),r},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.id},change:function(t){t=t||{};var n=this._changing;this._changing=!0;var r=this;e._objectEach(this._silent,function(t){r._pending[t]=!0});var s=i.extend({},t.changes,this._silent);if(this._silent={},e._objectEach(s,function(e,i){r.trigger("change:"+i,r,r.get(i),t)}),n)return this;for(var o=function(t,e){r._pending[e]||r._silent[e]||delete r.changed[e]};!i.isEmpty(this._pending);)this._pending={},this.trigger("change",this,t),e._objectEach(this.changed,o),r._previousAttributes=i.clone(this.attributes);return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(t){return arguments.length?this.changed&&i.has(this.changed,t):!i.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var n={},r=this._previousAttributes;return e._objectEach(t,function(t,e){i.isEqual(r[e],t)||(n[e]=t)}),n},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},validate:function(t){if(i.has(t,"ACL")&&!(t.ACL instanceof e.ACL))return new e.Error(e.Error.OTHER_CAUSE,"ACL must be a Parse.ACL.");var n=!0;return e._objectEach(t,function(t,e){/^[A-Za-z][0-9A-Za-z_]*$/.test(e)||(n=!1)}),n?!1:new e.Error(e.Error.INVALID_KEY_NAME)},_validate:function(t,e){if(e.silent||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validate(t,e);return n?(e&&e.error?e.error(this,n,e):this.trigger("error",this,n,e),!1):!0},getACL:function(){return this.get("ACL")},setACL:function(t,e){return this.set("ACL",t,e)}}),e.Object._getSubclass=function(t){if(!i.isString(t))throw"Parse.Object._getSubclass requires a string argument.";var n=e.Object._classMap[t];return n||(n=e.Object.extend(t),e.Object._classMap[t]=n),n},e.Object._create=function(t,i,n){var r=e.Object._getSubclass(t);return new r(i,n)},e.Object._toObjectIdArray=function(t,i){if(0===t.length)return e.Promise.as(t);for(var n,r=t[0].className,s=[],o=0;o<t.length;o++){var a=t[o];if(r!==a.className)return n=new e.Error(e.Error.INVALID_CLASS_NAME,"All objects should be of the same class"),e.Promise.error(n);if(!a.id)return n=new e.Error(e.Error.MISSING_OBJECT_ID,"All objects must have an ID"),e.Promise.error(n);i&&a._hasData||s.push(a.id)}return e.Promise.as(s)},e.Object._updateWithFetchedResults=function(t,i,n){var r={};e._arrayEach(i,function(t){r[t.id]=t});for(var s=0;s<t.length;s++){var o=t[s],a=r[o.id];if(!a&&n){var u=new e.Error(e.Error.OBJECT_NOT_FOUND,"All objects must exist on the server");return e.Promise.error(u)}o._mergeFromObject(a)}return e.Promise.as(t)},e.Object._fetchAll=function(t,i){if(0===t.length)return e.Promise.as(t);var n=!i;return e.Object._toObjectIdArray(t,n).then(function(i){var n=t[0].className,r=new e.Query(n);return r.containedIn("objectId",i),r.limit=i.length,r.find()}).then(function(n){return e.Object._updateWithFetchedResults(t,n,i)})},e.Object._classMap={},e.Object._extend=e._extend,e.Object.extend=function(t,n,r){if(!i.isString(t)){if(t&&i.has(t,"className"))return e.Object.extend(t.className,t,n);throw new Error("Parse.Object.extend's first argument should be the className.")}"User"===t&&e.User._performUserRewrite&&(t="_User"),n=n||{},n.className=t;var s=null;if(i.has(e.Object._classMap,t)){var o=e.Object._classMap[t];s=o._extend(n,r)}else s=this._extend(n,r);return s.extend=function(n){if(i.isString(n)||n&&i.has(n,"className"))return e.Object.extend.apply(s,arguments);var r=[t].concat(e._.toArray(arguments));return e.Object.extend.apply(s,r)},e.Object._classMap[t]=s,s},e.Object._findUnsavedChildren=function(t,i,n){e._traverse(t,function(t){return t instanceof e.Object?(t._refreshCache(),void(t.dirty()&&i.push(t))):t instanceof e.File?void(t.url()||n.push(t)):void 0})},e.Object._canBeSerializedAsValue=function(t){if(t instanceof e.Object)return!!t.id;if(t instanceof e.File)return!0;var n=!0;return i.isArray(t)?e._arrayEach(t,function(t){e.Object._canBeSerializedAsValue(t)||(n=!1)}):i.isObject(t)&&e._objectEach(t,function(t){e.Object._canBeSerializedAsValue(t)||(n=!1)}),n},e.Object._deepSaveAsync=function(t,n){var r=[],s=[];e.Object._findUnsavedChildren(t,r,s);var o=e.Promise.as();i.each(s,function(t){o=o.then(function(){return t.save(n)})});var a=i.uniq(r),u=i.uniq(a);return o.then(function(){return e.Promise._continueWhile(function(){return u.length>0},function(){var t=[],r=[];if(e._arrayEach(u,function(e){return t.length>20?void r.push(e):void(e._canBeSerialized()?t.push(e):r.push(e))}),u=r,0===t.length)return e.Promise.error(new e.Error(e.Error.OTHER_CAUSE,"Tried to save a batch with a cycle."));var s=e.Promise.when(i.map(t,function(t){return t._allPreviousSaves||e.Promise.as()})),o=new e.Promise;return e._arrayEach(t,function(t){t._allPreviousSaves=o}),s._continueWith(function(){return e._request({route:"batch",method:"POST",useMasterKey:n.useMasterKey,data:{requests:i.map(t,function(t){var e=t._getSaveJSON(),i="POST",n="/1/classes/"+t.className;return t.id&&(n=n+"/"+t.id,i="PUT"),t._startSave(),{method:i,path:n,body:e}})}}).then(function(i,n,r){var s;return e._arrayEach(t,function(t,e){i[e].success?t._finishSave(t.parse(i[e].success,n,r)):(s=s||i[e].error,t._cancelSave())}),s?e.Promise.error(new e.Error(s.code,s.error)):void 0}).then(function(t){return o.resolve(t),t},function(t){return o.reject(t),e.Promise.error(t)})})})}).then(function(){return t})}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Role=e.Object.extend("_Role",{constructor:function(t,n){i.isString(t)&&n instanceof e.ACL?(e.Object.prototype.constructor.call(this,null,null),this.setName(t),this.setACL(n)):e.Object.prototype.constructor.call(this,t,n)},getName:function(){return this.get("name")},setName:function(t,e){return this.set("name",t,e)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(t,n){if("name"in t&&t.name!==this.getName()){var r=t.name;if(this.id&&this.id!==t.objectId)return new e.Error(e.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!i.isString(r))return new e.Error(e.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[0-9a-zA-Z\-_ ]+$/.test(r))return new e.Error(e.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return e.Object.prototype.validate?e.Object.prototype.validate.call(this,t,n):!1}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Collection=function(t,e){e=e||{},e.comparator&&(this.comparator=e.comparator),e.model&&(this.model=e.model),e.query&&(this.query=e.query),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})},i.extend(e.Collection.prototype,e.Events,{model:e.Object,initialize:function(){},toJSON:function(){return this.map(function(t){return t.toJSON()})},add:function(t,n){var r,s,o,a,u,c,l={},h={};for(n=n||{},t=i.isArray(t)?t.slice():[t],r=0,o=t.length;o>r;r++){if(t[r]=this._prepareModel(t[r],n),a=t[r],!a)throw new Error("Can't add an invalid model to a collection");if(u=a.cid,l[u]||this._byCid[u])throw new Error("Duplicate cid: can't add the same model to a collection twice");if(c=a.id,!e._isNullOrUndefined(c)&&(h[c]||this._byId[c]))throw new Error("Duplicate id: can't add the same model to a collection twice");h[c]=a,l[u]=a}for(r=0;o>r;r++)(a=t[r]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,a.id&&(this._byId[a.id]=a);if(this.length+=o,s=e._isNullOrUndefined(n.at)?this.models.length:n.at,this.models.splice.apply(this.models,[s,0].concat(t)),this.comparator&&this.sort({silent:!0}),n.silent)return this;for(r=0,o=this.models.length;o>r;r++)a=this.models[r],l[a.cid]&&(n.index=r,a.trigger("add",a,this,n));return this},remove:function(t,e){var n,r,s,o;for(e=e||{},t=i.isArray(t)?t.slice():[t],n=0,r=t.length;r>n;n++)o=this.getByCid(t[n])||this.get(t[n]),o&&(delete this._byId[o.id],delete this._byCid[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,e.silent||(e.index=s,o.trigger("remove",o,this,e)),this._removeReference(o));return this},get:function(t){return t&&this._byId[t.id||t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},sort:function(t){if(t=t||{},!this.comparator)throw new Error("Cannot sort a set without a comparator");var e=i.bind(this.comparator,this);return 1===this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return i.map(this.models,function(e){return e.get(t)})},reset:function(t,i){var n=this;return t=t||[],i=i||{},e._arrayEach(this.models,function(t){n._removeReference(t)}),this._reset(),this.add(t,{silent:!0,parse:i.parse}),i.silent||this.trigger("reset",this,i),this},fetch:function(t){t=i.clone(t)||{},void 0===t.parse&&(t.parse=!0);var n=this,r=this.query||new e.Query(this.model);return r.find({useMasterKey:t.useMasterKey}).then(function(e){return t.add?n.add(e,t):n.reset(e,t),n})._thenRunCallbacks(t,this)},create:function(t,e){var n=this;if(e=e?i.clone(e):{},t=this._prepareModel(t,e),!t)return!1;e.wait||n.add(t,e);var r=e.success;return e.success=function(i,s){e.wait&&n.add(i,e),r?r(i,s):i.trigger("sync",t,s,e)},t.save(null,e),t},parse:function(t){return t},chain:function(){return i(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,i){if(t instanceof e.Object)t.collection||(t.collection=this);else{var n=t;i.collection=this,t=new this.model(n,i),t._validate(t.attributes,i)||(t=!1)}return t},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&"change:objectId"===t&&(delete this._byId[e.previous("objectId")],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});var n=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];e._arrayEach(n,function(t){e.Collection.prototype[t]=function(){return i[t].apply(i,[this.models].concat(i.toArray(arguments)))}}),e.Collection.extend=e._extend}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.View=function(t){this.cid=i.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var n=/^(\S+)\s*(.*)$/,r=["model","collection","el","id","attributes","className","tagName"];i.extend(e.View.prototype,e.Events,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,i,n){var r=document.createElement(t);return i&&e.$(r).attr(i),n&&e.$(r).html(n),r},setElement:function(t,i){return this.$el=e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t=t||e._getValue(this,"events")){this.undelegateEvents();var r=this;e._objectEach(t,function(e,s){if(i.isFunction(e)||(e=r[t[s]]),!e)throw new Error('Event "'+t[s]+'" does not exist');var o=s.match(n),a=o[1],u=o[2];e=i.bind(e,r),a+=".delegateEvents"+r.cid,""===u?r.$el.bind(a,e):r.$el.delegate(u,a,e)})}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=i.extend({},this.options,t));var e=this;i.each(r,function(i){t[i]&&(e[i]=t[i])}),this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=e._getValue(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}}),e.View.extend=e._extend}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.User=e.Object.extend("_User",{_isCurrentUser:!1,_mergeFromObject:function(t){t.getSessionToken()&&(this._sessionToken=t.getSessionToken()),e.User.__super__._mergeFromObject.call(this,t)},_mergeMagicFields:function(t){t.sessionToken&&(this._sessionToken=t.sessionToken,delete t.sessionToken),e.User.__super__._mergeMagicFields.call(this,t)},_cleanupAuthData:function(){if(this.isCurrent()){var t=this.get("authData");t&&e._objectEach(this.get("authData"),function(e,i){t[i]||delete t[i]})}},_synchronizeAllAuthData:function(){var t=this.get("authData");if(t){var i=this;e._objectEach(this.get("authData"),function(t,e){i._synchronizeAuthData(e)})}},_synchronizeAuthData:function(t){if(this.isCurrent()){var n;i.isString(t)?(n=t,t=e.User._authProviders[n]):n=t.getAuthType();var r=this.get("authData");if(r&&t){var s=t.restoreAuthentication(r[n]);s||this._unlinkFrom(t)}}},_handleSaveResult:function(t){t&&(this._isCurrentUser=!0),this._cleanupAuthData(),this._synchronizeAllAuthData(),delete this._serverData.password,this._rebuildEstimatedDataForKey("password"),this._refreshCache(),(t||this.isCurrent())&&e.User._saveCurrentUser(this)},_linkWith:function(t,n){var r;if(i.isString(t)?(r=t,t=e.User._authProviders[t]):r=t.getAuthType(),i.has(n,"authData")){var s=this.get("authData")||{};s[r]=n.authData,this.set("authData",s);var o=i.clone(n)||{};return o.success=function(t){t._handleSaveResult(!0),n.success&&n.success.apply(this,arguments)},this.save({authData:s},o)}var a=this,u=new e.Promise;return t.authenticate({success:function(t,e){a._linkWith(t,{authData:e,success:n.success,error:n.error}).then(function(){u.resolve(a)})},error:function(t,e){n.error&&n.error(a,e),u.reject(e)}}),u},_unlinkFrom:function(t,n){var r;i.isString(t)?(r=t,t=e.User._authProviders[t]):r=t.getAuthType();var s=i.clone(n),o=this;return s.authData=null,s.success=function(){o._synchronizeAuthData(t),n.success&&n.success.apply(this,arguments)},this._linkWith(t,s)},_isLinked:function(t){var e;e=i.isString(t)?t:t.getAuthType();var n=this.get("authData")||{};return!!n[e]},_logOutWithAll:function(){var t=this.get("authData");if(t){var i=this;e._objectEach(this.get("authData"),function(t,e){i._logOutWith(e)})}},_logOutWith:function(t){this.isCurrent()&&(i.isString(t)&&(t=e.User._authProviders[t]),t&&t.deauthenticate&&t.deauthenticate())},signUp:function(t,n){var r;n=n||{};var s=t&&t.username||this.get("username");if(!s||""===s)return r=new e.Error(e.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),n&&n.error&&n.error(this,r),e.Promise.error(r);var o=t&&t.password||this.get("password");if(!o||""===o)return r=new e.Error(e.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),n&&n.error&&n.error(this,r),e.Promise.error(r);var a=i.clone(n);return a.success=function(t){t._handleSaveResult(!0),n.success&&n.success.apply(this,arguments)},this.save(t,a)},logIn:function(t){var i=this;t=t||{};var n=e._request({route:"login",method:"GET",useMasterKey:t.useMasterKey,data:this.toJSON()});return n.then(function(t,e,n){var r=i.parse(t,e,n);return i._finishFetch(r),i._handleSaveResult(!0),i})._thenRunCallbacks(t,this)},save:function(t,n,r){var s,o;i.isObject(t)||i.isNull(t)||i.isUndefined(t)?(s=t,o=n):(s={},s[t]=n,o=r),o=o||{};var a=i.clone(o);return a.success=function(t){t._handleSaveResult(!1),o.success&&o.success.apply(this,arguments)},e.Object.prototype.save.call(this,s,a)},fetch:function(t){var n=t?i.clone(t):{};return n.success=function(e){e._handleSaveResult(!1),t&&t.success&&t.success.apply(this,arguments)},e.Object.prototype.fetch.call(this,n)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},setUsername:function(t,e){return this.set("username",t,e)},setPassword:function(t,e){return this.set("password",t,e)},getEmail:function(){return this.get("email")},setEmail:function(t,e){return this.set("email",t,e)},authenticated:function(){return!!this._sessionToken&&e.User.current()&&e.User.current().id===this.id},getSessionToken:function(){return this._sessionToken}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},_performUserRewrite:!0,signUp:function(t,i,n,r){n=n||{},n.username=t,n.password=i;var s=e.Object._create("_User");return s.signUp(n,r)},logIn:function(t,i,n){var r=e.Object._create("_User");return r._finishFetch({username:t,password:i}),r.logIn(n)},become:function(t,i){i=i||{};var n=e.Object._create("_User");return e._request({route:"users",className:"me",method:"GET",useMasterKey:i.useMasterKey,sessionToken:t}).then(function(t,e,i){var r=n.parse(t,e,i);return n._finishFetch(r),n._handleSaveResult(!0),n})._thenRunCallbacks(i,n)},logOut:function(){null!==e.User._currentUser&&(e.User._currentUser._logOutWithAll(),e.User._currentUser._isCurrentUser=!1),e.User._currentUserMatchesDisk=!0,e.User._currentUser=null,e.localStorage.removeItem(e._getParsePath(e.User._CURRENT_USER_KEY))},requestPasswordReset:function(t,i){i=i||{};var n=e._request({route:"requestPasswordReset",method:"POST",useMasterKey:i.useMasterKey,data:{email:t}});return n._thenRunCallbacks(i)},current:function(){if(e.User._currentUser)return e.User._currentUser;if(e.User._currentUserMatchesDisk)return e.User._currentUser;e.User._currentUserMatchesDisk=!0;var t=e.localStorage.getItem(e._getParsePath(e.User._CURRENT_USER_KEY));if(!t)return null;e.User._currentUser=e.Object._create("_User"),e.User._currentUser._isCurrentUser=!0;var i=JSON.parse(t);return e.User._currentUser.id=i._id,delete i._id,e.User._currentUser._sessionToken=i._sessionToken,delete i._sessionToken,e.User._currentUser._finishFetch(i),e.User._currentUser._synchronizeAllAuthData(),e.User._currentUser._refreshCache(),e.User._currentUser._opSetQueue=[{}],e.User._currentUser},allowCustomUserClass:function(t){this._performUserRewrite=!t},_saveCurrentUser:function(t){e.User._currentUser!==t&&e.User.logOut(),t._isCurrentUser=!0,e.User._currentUser=t,e.User._currentUserMatchesDisk=!0;var i=t.toJSON();i._id=t.id,i._sessionToken=t._sessionToken,e.localStorage.setItem(e._getParsePath(e.User._CURRENT_USER_KEY),JSON.stringify(i))},_registerAuthenticationProvider:function(t){e.User._authProviders[t.getAuthType()]=t,e.User.current()&&e.User.current()._synchronizeAuthData(t.getAuthType())},_logInWith:function(t,i){var n=e.Object._create("_User");return n._linkWith(t,i)}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Query=function(t){i.isString(t)&&(t=e.Object._getSubclass(t)),this.objectClass=t,this.className=t.prototype.className,this._where={},this._include=[],this._limit=-1,this._skip=0,this._extraOptions={}},e.Query.or=function(){var t=i.toArray(arguments),n=null;e._arrayEach(t,function(t){if(i.isNull(n)&&(n=t.className),n!==t.className)throw"All queries must be for the same class"});var r=new e.Query(n);return r._orQuery(t),r},e.Query.prototype={get:function(t,n){var r=this;r.equalTo("objectId",t);var s={};return n&&i.has(n,"useMasterKey")&&(s={useMasterKey:n.useMasterKey}),r.first(s).then(function(t){if(t)return t;var i=new e.Error(e.Error.OBJECT_NOT_FOUND,"Object not found.");return e.Promise.error(i)})._thenRunCallbacks(n,null)},toJSON:function(){var t={where:this._where};return this._include.length>0&&(t.include=this._include.join(",")),this._select&&(t.keys=this._select.join(",")),this._limit>=0&&(t.limit=this._limit),this._skip>0&&(t.skip=this._skip),void 0!==this._order&&(t.order=this._order.join(",")),e._objectEach(this._extraOptions,function(e,i){t[i]=e}),t},find:function(t){var n=this;t=t||{};var r=e._request({route:"classes",className:this.className,method:"GET",useMasterKey:t.useMasterKey,data:this.toJSON()});return r.then(function(t){return i.map(t.results,function(i){var r;return r=t.className?new e.Object(t.className):new n.objectClass,r._finishFetch(i,!0),r})})._thenRunCallbacks(t)},count:function(t){var i=this;t=t||{};var n=this.toJSON();n.limit=0,n.count=1;var r=e._request({route:"classes",className:i.className,method:"GET",useMasterKey:t.useMasterKey,data:n});
return r.then(function(t){return t.count})._thenRunCallbacks(t)},first:function(t){var n=this;t=t||{};var r=this.toJSON();r.limit=1;var s=e._request({route:"classes",className:this.className,method:"GET",useMasterKey:t.useMasterKey,data:r});return s.then(function(t){return i.map(t.results,function(i){var r;return r=t.className?new e.Object(t.className):new n.objectClass,r._finishFetch(i,!0),r})[0]})._thenRunCallbacks(t)},collection:function(t,n){return n=n||{},new e.Collection(t,i.extend(n,{model:this.objectClass,query:this}))},skip:function(t){return this._skip=t,this},limit:function(t){return this._limit=t,this},equalTo:function(t,n){return i.isUndefined(n)?this.doesNotExist(t):(this._where[t]=e._encode(n),this)},_addCondition:function(t,i,n){return this._where[t]||(this._where[t]={}),this._where[t][i]=e._encode(n),this},notEqualTo:function(t,e){return this._addCondition(t,"$ne",e),this},lessThan:function(t,e){return this._addCondition(t,"$lt",e),this},greaterThan:function(t,e){return this._addCondition(t,"$gt",e),this},lessThanOrEqualTo:function(t,e){return this._addCondition(t,"$lte",e),this},greaterThanOrEqualTo:function(t,e){return this._addCondition(t,"$gte",e),this},containedIn:function(t,e){return this._addCondition(t,"$in",e),this},notContainedIn:function(t,e){return this._addCondition(t,"$nin",e),this},containsAll:function(t,e){return this._addCondition(t,"$all",e),this},exists:function(t){return this._addCondition(t,"$exists",!0),this},doesNotExist:function(t){return this._addCondition(t,"$exists",!1),this},matches:function(t,e,i){return this._addCondition(t,"$regex",e),i||(i=""),e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),i&&i.length&&this._addCondition(t,"$options",i),this},matchesQuery:function(t,e){var i=e.toJSON();return i.className=e.className,this._addCondition(t,"$inQuery",i),this},doesNotMatchQuery:function(t,e){var i=e.toJSON();return i.className=e.className,this._addCondition(t,"$notInQuery",i),this},matchesKeyInQuery:function(t,e,i){var n=i.toJSON();return n.className=i.className,this._addCondition(t,"$select",{key:e,query:n}),this},doesNotMatchKeyInQuery:function(t,e,i){var n=i.toJSON();return n.className=i.className,this._addCondition(t,"$dontSelect",{key:e,query:n}),this},_orQuery:function(t){var e=i.map(t,function(t){return t.toJSON().where});return this._where.$or=e,this},_quote:function(t){return"\\Q"+t.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(t,e){return this._addCondition(t,"$regex",this._quote(e)),this},startsWith:function(t,e){return this._addCondition(t,"$regex","^"+this._quote(e)),this},endsWith:function(t,e){return this._addCondition(t,"$regex",this._quote(e)+"$"),this},ascending:function(){return this._order=[],this.addAscending.apply(this,arguments)},addAscending:function(){var t=this;return this._order||(this._order=[]),e._arrayEach(arguments,function(e){Array.isArray(e)&&(e=e.join()),t._order=t._order.concat(e.replace(/\s/g,"").split(","))}),this},descending:function(){return this._order=[],this.addDescending.apply(this,arguments)},addDescending:function(){var t=this;return this._order||(this._order=[]),e._arrayEach(arguments,function(e){Array.isArray(e)&&(e=e.join()),t._order=t._order.concat(i.map(e.replace(/\s/g,"").split(","),function(t){return"-"+t}))}),this},near:function(t,i){return i instanceof e.GeoPoint||(i=new e.GeoPoint(i)),this._addCondition(t,"$nearSphere",i),this},withinRadians:function(t,e,i){return this.near(t,e),this._addCondition(t,"$maxDistance",i),this},withinMiles:function(t,e,i){return this.withinRadians(t,e,i/3958.8)},withinKilometers:function(t,e,i){return this.withinRadians(t,e,i/6371)},withinGeoBox:function(t,i,n){return i instanceof e.GeoPoint||(i=new e.GeoPoint(i)),n instanceof e.GeoPoint||(n=new e.GeoPoint(n)),this._addCondition(t,"$within",{$box:[i,n]}),this},include:function(){var t=this;return e._arrayEach(arguments,function(e){i.isArray(e)?t._include=t._include.concat(e):t._include.push(e)}),this},select:function(){var t=this;return this._select=this._select||[],e._arrayEach(arguments,function(e){i.isArray(e)?t._select=t._select.concat(e):t._select.push(e)}),this},each:function(t,n){if(n=n||{},this._order||this._skip||this._limit>=0){var r="Cannot iterate on a query with sort, skip, or limit.";return e.Promise.error(r)._thenRunCallbacks(n)}new e.Promise;var s=new e.Query(this.objectClass);s._limit=n.batchSize||100,s._where=i.clone(this._where),s._include=i.clone(this._include),s.ascending("objectId");var o={};i.has(n,"useMasterKey")&&(o.useMasterKey=n.useMasterKey);var a=!1;return e.Promise._continueWhile(function(){return!a},function(){return s.find(o).then(function(i){var n=e.Promise.as();return e._.each(i,function(e){n=n.then(function(){return t(e)})}),n.then(function(){i.length>=s._limit?s.greaterThan("objectId",i[i.length-1].id):a=!0})})})._thenRunCallbacks(n)}}}(this),function(t){t.Parse=t.Parse||{};var e,i,n=t.Parse,r=n._,s=!1,o={authenticate:function(t){var i=this;FB.login(function(e){e.authResponse?t.success&&t.success(i,{id:e.authResponse.userID,access_token:e.authResponse.accessToken,expiration_date:new Date(1e3*e.authResponse.expiresIn+(new Date).getTime()).toJSON()}):t.error&&t.error(i,e)},{scope:e})},restoreAuthentication:function(t){if(t){var e={userID:t.id,accessToken:t.access_token,expiresIn:(n._parseDate(t.expiration_date).getTime()-(new Date).getTime())/1e3},s=r.clone(i);s.authResponse=e,s.status=!1;var o=FB.getAuthResponse();o&&o.userID!==e.userID&&FB.logout(),FB.init(s)}return!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null)}};n.FacebookUtils={init:function(t){if("undefined"==typeof FB)throw"The Facebook JavaScript SDK must be loaded before calling init.";if(i=r.clone(t)||{},i.status&&"undefined"!=typeof console){var e=console.warn||console.log||function(){};e.call(console,"The 'status' flag passed into FB.init, when set to true, can interfere with Parse Facebook integration, so it has been suppressed. Please call FB.getLoginStatus() explicitly if you require this behavior.")}i.status=!1,FB.init(i),n.User._registerAuthenticationProvider(o),s=!0},isLinked:function(t){return t._isLinked("facebook")},logIn:function(t,i){if(!t||r.isString(t)){if(!s)throw"You must initialize FacebookUtils before calling logIn.";return e=t,n.User._logInWith("facebook",i)}var o=r.clone(i)||{};return o.authData=t,n.User._logInWith("facebook",o)},link:function(t,i,n){if(!i||r.isString(i)){if(!s)throw"You must initialize FacebookUtils before calling link.";return e=i,t._linkWith("facebook",n)}var o=r.clone(n)||{};return o.authData=i,t._linkWith("facebook",o)},unlink:function(t,e){if(!s)throw"You must initialize FacebookUtils before calling unlink.";return t._unlinkFrom("facebook",e)}}}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl")};var n=/^[#\/]/,r=/msie [\w.]+/;e.History.started=!1,i.extend(e.History.prototype,e.Events,{interval:50,getHash:function(t){var e=t?t.location:window.location,i=e.href.match(/#(.*)$/);return i?i[1]:""},getFragment:function(t,i){if(e._isNullOrUndefined(t))if(this._hasPushState||i){t=window.location.pathname;var r=window.location.search;r&&(t+=r)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(n,"")},start:function(t){if(e.History.started)throw new Error("Parse.history has already been started");e.History.started=!0,this.options=i.extend({},{root:"/"},this.options,t),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var s=this.getFragment(),o=document.documentMode,a=r.exec(navigator.userAgent.toLowerCase())&&(!o||7>=o);a&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(s)),this._hasPushState?e.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?e.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval)),this.fragment=s;var u=window.location,c=u.pathname===this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!c?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&c&&u.hash&&(this.fragment=this.getHash().replace(n,""),window.history.replaceState({},document.title,u.protocol+"//"+u.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),window.clearInterval(this._checkUrlInterval),e.History.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,i){if(!e.History.started)return!1;i&&i!==!0||(i={trigger:i});var r=(t||"").replace(n,"");if(this.fragment!==r){if(this._hasPushState){0!==r.indexOf(this.options.root)&&(r=this.options.root+r),this.fragment=r;var s=i.replace?"replaceState":"pushState";window.history[s]({},document.title,r)}else this._wantsHashChange?(this.fragment=r,this._updateHash(window.location,r,i.replace),this.iframe&&r!==this.getFragment(this.getHash(this.iframe))&&(i.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,r,i.replace))):window.location.assign(this.options.root+t);i.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,i){if(i){var n=t.toString().replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash=e}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Router=function(t){t=t||{},t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var n=/:\w+/g,r=/\*\w+/g,s=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;i.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(t,n,r){return e.history=e.history||new e.History,i.isRegExp(t)||(t=this._routeToRegExp(t)),r||(r=this[n]),e.history.route(t,i.bind(function(i){var s=this._extractParameters(t,i);r&&r.apply(this,s),this.trigger.apply(this,["route:"+n].concat(s)),e.history.trigger("route",this,n,s)},this)),this},navigate:function(t,i){e.history.navigate(t,i)},_bindRoutes:function(){if(this.routes){var t=[];for(var e in this.routes)this.routes.hasOwnProperty(e)&&t.unshift([e,this.routes[e]]);for(var i=0,n=t.length;n>i;i++)this.route(t[i][0],t[i][1],this[t[i][1]])}},_routeToRegExp:function(t){return t=t.replace(s,"\\$&").replace(n,"([^/]+)").replace(r,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}}),e.Router.extend=e._extend}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse,i=e._;e.Cloud=e.Cloud||{},i.extend(e.Cloud,{run:function(t,i,n){n=n||{};var r=e._request({route:"functions",className:t,method:"POST",useMasterKey:n.useMasterKey,data:e._encode(i,null,!0)});return r.then(function(t){return e._decode(null,t).result})._thenRunCallbacks(n)}})}(this),function(t){t.Parse=t.Parse||{};var e=t.Parse;e.Installation=e.Object.extend("_Installation"),e.Push=e.Push||{},e.Push.send=function(t,i){if(i=i||{},t.where&&(t.where=t.where.toJSON().where),t.push_time&&(t.push_time=t.push_time.toJSON()),t.expiration_time&&(t.expiration_time=t.expiration_time.toJSON()),t.expiration_time&&t.expiration_interval)throw"Both expiration_time and expiration_interval can't be set";var n=e._request({route:"push",method:"POST",data:t,useMasterKey:i.useMasterKey});return n._thenRunCallbacks(i)}}(this),i("parse",function(t){return function(){var e;return e||t.Parse}}(this)),function(){function t(t,i,n,r){return new e(t,i,n,r)}function e(t,e,i,r){this.options=r||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=i,this.objectPath=[],this.parse(),n(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function n(t){return"object"==typeof t&&null!==t}function r(t){throw new Error("[sightglass] "+t)}t.adapters={},e.tokenize=function(t,e,i){var n,r,s=[],o={i:i,path:""};for(n=0;n<t.length;n++)r=t.charAt(n),~e.indexOf(r)?(s.push(o),o={i:r,path:""}):o.path+=r;return s.push(o),s},e.prototype.parse=function(){var i,n,s=this.interfaces();s.length||r("Must define at least one adapter interface."),~s.indexOf(this.keypath[0])?(i=this.keypath[0],n=this.keypath.substr(1)):("undefined"==typeof(i=this.options.root||t.root)&&r("Must define a default root adapter."),n=this.keypath),this.tokens=e.tokenize(n,s,i),this.key=this.tokens.pop()},e.prototype.realize=function(){var t,e=this.obj,i=!1;return this.tokens.forEach(function(r,s){n(e)?("undefined"!=typeof this.objectPath[s]?e!==(t=this.objectPath[s])&&(this.set(!1,r,t,this.update.bind(this)),this.set(!0,r,e,this.update.bind(this)),this.objectPath[s]=e):(this.set(!0,r,e,this.update.bind(this)),this.objectPath[s]=e),e=this.get(r,e)):(i===!1&&(i=s),(t=this.objectPath[s])&&this.set(!1,r,t,this.update.bind(this)))},this),i!==!1&&this.objectPath.splice(i),e},e.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(n(this.target)&&this.set(!1,this.key,this.target,this.callback),n(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,this.value()!==e&&this.callback())},e.prototype.value=function(){return n(this.target)?this.get(this.key,this.target):void 0},e.prototype.setValue=function(t){n(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},e.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},e.prototype.set=function(t,e,i,n){var r=t?"observe":"unobserve";this.adapter(e)[r](i,e.path,n)},e.prototype.interfaces=function(){var e=Object.keys(this.options.adapters);return Object.keys(t.adapters).forEach(function(t){~e.indexOf(t)||e.push(t)}),e},e.prototype.adapter=function(e){return this.options.adapters[e.i]||t.adapters[e.i]},e.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,i){(t=this.objectPath[i])&&this.set(!1,e,t,this.update.bind(this))},this),n(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof i&&i.amd?i("sightglass",[],function(){return this.sightglass=t}):this.sightglass=t}.call(this),function(){var t,n,r,s,o=function(t,e){return function(){return t.apply(e,arguments)}},a=[].slice,u={}.hasOwnProperty,c=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};t={options:["prefix","templateDelimiters","rootInterface","preloadData","handler"],extensions:["binders","formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(t,e,i){return this.call(t,e,i.view.models)},configure:function(e){var i,n,r,s;null==e&&(e={});for(r in e)if(s=e[r],"binders"===r||"components"===r||"formatters"===r||"adapters"===r)for(n in s)i=s[n],t[r][n]=i;else t["public"][r]=s},bind:function(e,i,n){var r;return null==i&&(i={}),null==n&&(n={}),r=new t.View(e,i,n),r.bind(),r}}},window.jQuery||window.$?(s="on"in jQuery.prototype?["on","off"]:["bind","unbind"],n=s[0],r=s[1],t.Util={bindEvent:function(t,e,i){return jQuery(t)[n](e,i)},unbindEvent:function(t,e,i){return jQuery(t)[r](e,i)},getInputValue:function(t){var e;return e=jQuery(t),"checkbox"===e.attr("type")?e.is(":checked"):e.val()}}):t.Util={bindEvent:function(){return"addEventListener"in window?function(t,e,i){return t.addEventListener(e,i,!1)}:function(t,e,i){return t.attachEvent("on"+e,i)}}(),unbindEvent:function(){return"removeEventListener"in window?function(t,e,i){return t.removeEventListener(e,i,!1)}:function(t,e,i){return t.detachEvent("on"+e,i)}}(),getInputValue:function(t){var e,i,n,r;if("checkbox"===t.type)return t.checked;if("select-multiple"===t.type){for(r=[],i=0,n=t.length;n>i;i++)e=t[i],e.selected&&r.push(e.value);return r}return t.value}},t.TypeParser=function(){function t(){}return t.types={primitive:0,keypath:1},t.parse=function(t){return/^'.*'$|^".*"$/.test(t)?{type:this.types.primitive,value:t.slice(1,-1)}:"true"===t?{type:this.types.primitive,value:!0}:"false"===t?{type:this.types.primitive,value:!1}:"null"===t?{type:this.types.primitive,value:null}:"undefined"===t?{type:this.types.primitive,value:void 0}:isNaN(Number(t))===!1?{type:this.types.primitive,value:Number(t)}:{type:this.types.keypath,value:t}},t}(),t.TextTemplateParser=function(){function t(){}return t.types={text:0,binding:1},t.parse=function(t,e){var i,n,r,s,o,a,u;for(a=[],s=t.length,i=0,n=0;s>n;){if(i=t.indexOf(e[0],n),0>i){a.push({type:this.types.text,value:t.slice(n)});break}if(i>0&&i>n&&a.push({type:this.types.text,value:t.slice(n,i)}),n=i+e[0].length,i=t.indexOf(e[1],n),0>i){o=t.slice(n-e[1].length),r=a[a.length-1],(null!=r?r.type:void 0)===this.types.text?r.value+=o:a.push({type:this.types.text,value:o});break}u=t.slice(n,i).trim(),a.push({type:this.types.binding,value:u}),n=i+e[1].length}return a},t}(),t.View=function(){function e(e,i,n){var r,s,a,u,c,l,h,p,d,f,_,m;for(this.els=e,this.models=i,null==n&&(n={}),this.update=o(this.update,this),this.publish=o(this.publish,this),this.sync=o(this.sync,this),this.unbind=o(this.unbind,this),this.bind=o(this.bind,this),this.select=o(this.select,this),this.build=o(this.build,this),this.componentRegExp=o(this.componentRegExp,this),this.bindingRegExp=o(this.bindingRegExp,this),this.options=o(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),d=t.extensions,c=0,h=d.length;h>c;c++){if(s=d[c],this[s]={},n[s]){f=n[s];for(r in f)a=f[r],this[s][r]=a}_=t["public"][s];for(r in _)a=_[r],null==(u=this[s])[r]&&(u[r]=a)}for(m=t.options,l=0,p=m.length;p>l;l++)s=m[l],this[s]=n[s]||t["public"][s];this.build()}return e.prototype.options=function(){var e,i,n,r,s;for(i={},s=t.extensions.concat(t.options),n=0,r=s.length;r>n;n++)e=s[n],i[e]=this[e];return i},e.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},e.prototype.componentRegExp=function(){return new RegExp("^"+this.prefix.toUpperCase()+"-")},e.prototype.build=function(){var e,i,n,r,s,o,a,u;for(this.bindings=[],e=this.bindingRegExp(),n=this.componentRegExp(),i=function(e){return function(i,n,r,s){var o,a,u,c,l,h,p;return l={},p=function(){var t,e,i,n;for(i=s.split("|"),n=[],t=0,e=i.length;e>t;t++)h=i[t],n.push(h.trim());return n}(),o=function(){var t,e,i,n;for(i=p.shift().split("<"),n=[],t=0,e=i.length;e>t;t++)a=i[t],n.push(a.trim());return n}(),c=o.shift(),l.formatters=p,(u=o.shift())&&(l.dependencies=u.split(/\s+/)),e.bindings.push(new t[i](e,n,r,c,l))}}(this),s=function(r){return function(o){var a,u,c,l,h,p,d,f,_,m,g,v,y,b,w,E,S,x,P,A,T,O,j,C,R,N,I,L;if(3===o.nodeType){if(_=t.TextTemplateParser,(p=r.templateDelimiters)&&(y=_.parse(o.data,p)).length&&(1!==y.length||y[0].type!==_.types.text)){for(E=0,A=y.length;A>E;E++)v=y[E],g=document.createTextNode(v.value),o.parentNode.insertBefore(g,o),1===v.type&&i("TextBinding",g,null,v.value);o.parentNode.removeChild(o)}}else if(1===o.nodeType)if(n.test(o.nodeName))b=o.nodeName.replace(n,"").toLowerCase(),r.bindings.push(new t.ComponentBinding(r,o,b));else{for(l="SCRIPT"===o.nodeName||"STYLE"===o.nodeName,C=o.attributes,S=0,T=C.length;T>S;S++)if(a=C[S],e.test(a.name)){if(b=a.name.replace(e,""),!(c=r.binders[b])){R=r.binders;for(d in R)w=R[d],"*"!==d&&-1!==d.indexOf("*")&&(m=new RegExp("^"+d.replace(/\*/g,".+")+"$"),m.test(b)&&(c=w))}c||(c=r.binders["*"]),c.block&&(l=!0,u=[a])}for(N=u||o.attributes,x=0,O=N.length;O>x;x++)a=N[x],e.test(a.name)&&(b=a.name.replace(e,""),i("Binding",o,b,a.value))}if(!l){for(I=function(){var t,e,i,n;for(i=o.childNodes,n=[],e=0,t=i.length;t>e;e++)f=i[e],n.push(f);return n}(),L=[],P=0,j=I.length;j>P;P++)h=I[P],L.push(s(h));return L}}}(this),u=this.els,o=0,a=u.length;a>o;o++)r=u[o],s(r);this.bindings.sort(function(t,e){var i,n;return((null!=(i=e.binder)?i.priority:void 0)||0)-((null!=(n=t.binder)?n.priority:void 0)||0)})},e.prototype.select=function(t){var e,i,n,r,s;for(r=this.bindings,s=[],i=0,n=r.length;n>i;i++)e=r[i],t(e)&&s.push(e);return s},e.prototype.bind=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.bind());return r},e.prototype.unbind=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.unbind());return r},e.prototype.sync=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.sync());return r},e.prototype.publish=function(){var t,e,i,n,r;for(n=this.select(function(t){return t.binder.publishes}),r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.publish());return r},e.prototype.update=function(t){var e,i,n,r,s,o,a;null==t&&(t={});for(i in t)n=t[i],this.models[i]=n;for(o=this.bindings,a=[],r=0,s=o.length;s>r;r++)e=o[r],a.push(e.update(t));return a},e}(),t.Binding=function(){function e(t,e,i,n,r){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.getValue=o(this.getValue,this),this.update=o(this.update,this),this.unbind=o(this.unbind,this),this.bind=o(this.bind,this),this.publish=o(this.publish,this),this.sync=o(this.sync,this),this.set=o(this.set,this),this.eventHandler=o(this.eventHandler,this),this.formattedValue=o(this.formattedValue,this),this.parseTarget=o(this.parseTarget,this),this.observe=o(this.observe,this),this.setBinder=o(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return e.prototype.setBinder=function(){var t,e,i,n;if(!(this.binder=this.view.binders[this.type])){n=this.view.binders;for(t in n)i=n[t],"*"!==t&&-1!==t.indexOf("*")&&(e=new RegExp("^"+t.replace(/\*/g,".+")+"$"),e.test(this.type)&&(this.binder=i,this.args=new RegExp("^"+t.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},e.prototype.observe=function(e,i,n){return t.sightglass(e,i,n,{root:this.view.rootInterface,adapters:this.view.adapters})},e.prototype.parseTarget=function(){var e;return e=t.TypeParser.parse(this.keypath),0===e.type?this.value=e.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},e.prototype.formattedValue=function(e){var i,n,r,s,o,u,c,l,h,p,d,f,_,m;for(m=this.formatters,s=p=0,f=m.length;f>p;s=++p){for(o=m[s],r=o.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),u=r.shift(),o=this.view.formatters[u],r=function(){var e,i,s;for(s=[],e=0,i=r.length;i>e;e++)n=r[e],s.push(t.TypeParser.parse(n));return s}(),l=[],i=d=0,_=r.length;_>d;i=++d)n=r[i],l.push(0===n.type?n.value:((h=this.formatterObservers)[s]||(h[s]={}),(c=this.formatterObservers[s][i])?void 0:(c=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[s][i]=c),c.value()));(null!=o?o.read:void 0)instanceof Function?e=o.read.apply(o,[e].concat(a.call(l))):o instanceof Function&&(e=o.apply(null,[e].concat(a.call(l))))}return e},e.prototype.eventHandler=function(t){var e,i;return i=(e=this).view.handler,function(n){return i.call(t,this,n,e)}},e.prototype.set=function(t){var e;return t=this.formattedValue(t instanceof Function&&!this.binder["function"]?t.call(this.model):t),null!=(e=this.binder.routine)?e.call(this,this.el,t):void 0},e.prototype.sync=function(){var t,e;return this.set(function(){var i,n,r,s,o,a,u;if(this.observer){if(this.model!==this.observer.target){for(o=this.dependencies,i=0,r=o.length;r>i;i++)e=o[i],e.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(a=this.options.dependencies)?a.length:void 0))for(u=this.options.dependencies,n=0,s=u.length;s>n;n++)t=u[n],e=this.observe(this.model,t,this.sync),this.dependencies.push(e)}return this.observer.value()}return this.value}.call(this))},e.prototype.publish=function(){var t,e,i,n,r,s,o,u,c;if(this.observer){for(n=this.getValue(this.el),o=this.formatters.slice(0).reverse(),r=0,s=o.length;s>r;r++)e=o[r],t=e.split(/\s+/),i=t.shift(),(null!=(u=this.view.formatters[i])?u.publish:void 0)&&(n=(c=this.view.formatters[i]).publish.apply(c,[n].concat(a.call(t))));return this.observer.setValue(n)}},e.prototype.bind=function(){var t,e,i,n,r,s,o;if(this.parseTarget(),null!=(r=this.binder.bind)&&r.call(this,this.el),null!=this.model&&(null!=(s=this.options.dependencies)?s.length:void 0))for(o=this.options.dependencies,i=0,n=o.length;n>i;i++)t=o[i],e=this.observe(this.model,t,this.sync),this.dependencies.push(e);return this.view.preloadData?this.sync():void 0},e.prototype.unbind=function(){var t,e,i,n,r,s,o,a,u,c;for(null!=(o=this.binder.unbind)&&o.call(this,this.el),null!=(a=this.observer)&&a.unobserve(),u=this.dependencies,r=0,s=u.length;s>r;r++)n=u[r],n.unobserve();this.dependencies=[],c=this.formatterObservers;for(i in c){e=c[i];for(t in e)n=e[t],n.unobserve()}return this.formatterObservers={}},e.prototype.update=function(t){var e,i;return null==t&&(t={}),this.model=null!=(e=this.observer)?e.target:void 0,this.unbind(),null!=(i=this.binder.update)&&i.call(this,t),this.bind()},e.prototype.getValue=function(e){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,e):t.Util.getInputValue(e)},e}(),t.ComponentBinding=function(e){function i(t,e,i){var n,r,s,a,u;for(this.view=t,this.el=e,this.type=i,this.unbind=o(this.unbind,this),this.bind=o(this.bind,this),this.update=o(this.update,this),this.locals=o(this.locals,this),this.component=this.view.components[this.type],this.attributes={},this.inflections={},a=this.el.attributes||[],r=0,s=a.length;s>r;r++)n=a[r],u=n.name,l.call(this.component.attributes,u)>=0?this.attributes[n.name]=n.value:this.inflections[n.name]=n.value}return c(i,e),i.prototype.sync=function(){},i.prototype.locals=function(t){var e,i,n,r,s,o,a,u,c;null==t&&(t=this.view.models),s={},u=this.inflections;for(i in u)for(e=u[i],c=e.split("."),o=0,a=c.length;a>o;o++)r=c[o],s[i]=(s[i]||t)[r];for(i in t)n=t[i],null==s[i]&&(s[i]=n);return s},i.prototype.update=function(t){var e;return null!=(e=this.componentView)?e.update(this.locals(t)):void 0},i.prototype.bind=function(){var e,i;return null!=this.componentView?null!=(i=this.componentView)?i.bind():void 0:(e=this.component.build.call(this.attributes),(this.componentView=new t.View(e,this.locals(),this.view.options)).bind(),this.el.parentNode.replaceChild(e,this.el))},i.prototype.unbind=function(){var t;return null!=(t=this.componentView)?t.unbind():void 0},i}(t.Binding),t.TextBinding=function(t){function e(t,e,i,n,r){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=r?r:{},this.sync=o(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return c(e,t),e.prototype.binder={routine:function(t,e){return t.data=null!=e?e:""}},e.prototype.sync=function(){return e.__super__.sync.apply(this,arguments)},e}(t.Binding),t["public"].binders.text=function(t,e){return null!=t.textContent?t.textContent=null!=e?e:"":t.innerText=null!=e?e:""},t["public"].binders.html=function(t,e){return t.innerHTML=null!=e?e:""},t["public"].binders.show=function(t,e){return t.style.display=e?"":"none"},t["public"].binders.hide=function(t,e){return t.style.display=e?"none":""},t["public"].binders.enabled=function(t,e){return t.disabled=!e},t["public"].binders.disabled=function(t,e){return t.disabled=!!e},t["public"].binders.checked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var i;return t.checked="radio"===t.type?(null!=(i=t.value)?i.toString():void 0)===(null!=e?e.toString():void 0):!!e}},t["public"].binders.unchecked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var i;return t.checked="radio"===t.type?(null!=(i=t.value)?i.toString():void 0)!==(null!=e?e.toString():void 0):!e}},t["public"].binders.value={publishes:!0,priority:2e3,bind:function(e){return this.event="SELECT"===e.tagName?"change":"input",t.Util.bindEvent(e,this.event,this.publish)},unbind:function(e){return t.Util.unbindEvent(e,this.event,this.publish)},routine:function(t,e){var i,n,r,s,o,a,u;if(null!=window.jQuery){if(t=jQuery(t),(null!=e?e.toString():void 0)!==(null!=(s=t.val())?s.toString():void 0))return t.val(null!=e?e:"")}else if("select-multiple"===t.type){if(null!=e){for(u=[],n=0,r=t.length;r>n;n++)i=t[n],u.push(i.selected=(o=i.value,l.call(e,o)>=0));return u}}else if((null!=e?e.toString():void 0)!==(null!=(a=t.value)?a.toString():void 0))return t.value=null!=e?e:""}},t["public"].binders["if"]={block:!0,priority:3e3,bind:function(t){var e,i;return null==this.marker?(e=[this.view.prefix,this.type].join("-").replace("--","-"),i=t.getAttribute(e),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),this.bound=!1,t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t)):void 0},unbind:function(){var t;return null!=(t=this.nested)?t.unbind():void 0},routine:function(e,i){var n,r,s,o;if(!!i==!this.bound){if(i){s={},o=this.view.models;for(n in o)r=o[n],s[n]=r;return(this.nested||(this.nested=new t.View(e,s,this.view.options()))).bind(),this.marker.parentNode.insertBefore(e,this.marker.nextSibling),this.bound=!0}return e.parentNode.removeChild(e),this.nested.unbind(),this.bound=!1}},update:function(t){var e;return null!=(e=this.nested)?e.update(t):void 0}},t["public"].binders.unless={block:!0,priority:3e3,bind:function(e){return t["public"].binders["if"].bind.call(this,e)},unbind:function(){return t["public"].binders["if"].unbind.call(this)},routine:function(e,i){return t["public"].binders["if"].routine.call(this,e,!i)},update:function(e){return t["public"].binders["if"].update.call(this,e)}},t["public"].binders["on-*"]={"function":!0,priority:1e3,unbind:function(e){return this.handler?t.Util.unbindEvent(e,this.args[0],this.handler):void 0},routine:function(e,i){return this.handler&&t.Util.unbindEvent(e,this.args[0],this.handler),t.Util.bindEvent(e,this.args[0],this.handler=this.eventHandler(i))}},t["public"].binders["each-*"]={block:!0,priority:3e3,bind:function(t){var e,i,n,r,s;if(null==this.marker)e=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t);else for(s=this.iterated,n=0,r=s.length;r>n;n++)i=s[n],i.bind()},unbind:function(){var t,e,i,n,r;if(null!=this.iterated){for(n=this.iterated,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.unbind());return r}},routine:function(e,i){var n,r,s,o,a,u,c,l,h,p,d,f,_,m,g,v,y,b,w,E,S;if(c=this.args[0],i=i||[],this.iterated.length>i.length)for(b=Array(this.iterated.length-i.length),f=0,g=b.length;g>f;f++)s=b[f],d=this.iterated.pop(),d.unbind(),this.marker.parentNode.removeChild(d.els[0]);for(o=_=0,v=i.length;v>_;o=++_)if(u=i[o],r={index:o},r[c]=u,null==this.iterated[o]){w=this.view.models;for(a in w)u=w[a],null==r[a]&&(r[a]=u);h=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,l=this.view.options(),l.preloadData=!0,p=e.cloneNode(!0),d=new t.View(p,r,l),d.bind(),this.iterated.push(d),this.marker.parentNode.insertBefore(p,h.nextSibling)
}else this.iterated[o].models[c]!==u&&this.iterated[o].update(r);if("OPTION"===e.nodeName){for(E=this.view.bindings,S=[],m=0,y=E.length;y>m;m++)n=E[m],S.push(n.el===this.marker.parentNode&&"value"===n.type?n.sync():void 0);return S}},update:function(t){var e,i,n,r,s,o,a,u;e={};for(i in t)n=t[i],i!==this.args[0]&&(e[i]=n);for(a=this.iterated,u=[],s=0,o=a.length;o>s;s++)r=a[s],u.push(r.update(e));return u}},t["public"].binders["class-*"]=function(t,e){var i;return i=" "+t.className+" ",!e==(-1!==i.indexOf(" "+this.args[0]+" "))?t.className=e?""+t.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim():void 0},t["public"].binders["*"]=function(t,e){return null!=e?t.setAttribute(this.type,e):t.removeAttribute(this.type)},t["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(t){var e;return t.hasOwnProperty(this.id)||(e=this.counter++,this.weakmap[e]={callbacks:{}},Object.defineProperty(t,this.id,{value:e})),this.weakmap[t[this.id]]},stubFunction:function(t,e){var i,n,r;return n=t[e],i=this.weakReference(t),r=this.weakmap,t[e]=function(){var e,s,o,a,u,c,l,h,p,d;a=n.apply(t,arguments),l=i.pointers;for(o in l)for(s=l[o],d=null!=(h=null!=(p=r[o])?p.callbacks[s]:void 0)?h:[],u=0,c=d.length;c>u;u++)(e=d[u])();return a}},observeMutations:function(t,e,i){var n,r,s,o,a,u;if(Array.isArray(t)){if(s=this.weakReference(t),null==s.pointers)for(s.pointers={},r=["push","pop","shift","unshift","sort","reverse","splice"],a=0,u=r.length;u>a;a++)n=r[a],this.stubFunction(t,n);if(null==(o=s.pointers)[e]&&(o[e]=[]),l.call(s.pointers[e],i)<0)return s.pointers[e].push(i)}},unobserveMutations:function(t,e,i){var n,r,s;return Array.isArray(t&&null!=t[this.id])&&(r=null!=(s=this.weakReference(t).pointers)?s[e]:void 0)&&(n=r.indexOf(i),n>=0)?r.splice(n,1):void 0},observe:function(t,e,i){var n,r;return n=this.weakReference(t).callbacks,null==n[e]&&(n[e]=[],r=t[e],Object.defineProperty(t,e,{enumerable:!0,get:function(){return r},set:function(s){return function(o){var a,u,c;if(o!==r){for(r=o,c=n[e].slice(),a=0,u=c.length;u>a;a++)i=c[a],l.call(n[e],i)>=0&&i();return s.observeMutations(o,t[s.id],e)}}}(this)})),l.call(n[e],i)<0&&n[e].push(i),this.observeMutations(t[e],t[this.id],e)},unobserve:function(t,e,i){var n,r;return n=this.weakmap[t[this.id]].callbacks[e],r=n.indexOf(i),r>=0&&n.splice(r,1),this.unobserveMutations(t[e],t[this.id],e)},get:function(t,e){return t[e]},set:function(t,e,i){return t[e]=i}},t.factory=function(e){return t.sightglass=e,t["public"]._=t,t["public"]},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=t.factory(e("sightglass")):"function"==typeof i&&i.amd?i("rivets",["sightglass"],function(e){return this.rivets=t.factory(e)}):this.rivets=t.factory(sightglass)}.call(this),i("tool/animatortool",["require","exports","module","BlankyApp","parse","rivets"],function(t){var e=t("BlankyApp"),i=new e,n=t("parse");n.initialize("U0A3f3L3EHbQpF8Oig2zhlOasUF6PhJkTOQOvjoH","aNTIn2zXGxzAEl8BLOnHzuWvaOYySN5QqHPLgA1X");var r=n.Object.extend("Page"),s=t("rivets");s.binders.input={publishes:!0,routine:s.binders.value.routine,bind:function(t){t.addEventListener("input",this.publish)},unbind:function(t){t.removeEventListener("input",this.publish)}};var o=n.Collection.extend({model:r}),a=new o;a.comparator=function(t){return t.get("page").name};var u=this;a.fetch({success:function(t){var e={};e.pages=t.toJSON(),window.pagesModel=e;var i=window.pagesListView||s.bind(document.getElementById("editor-section"),e);window.pagesListView=i,window.pagesListView.unbind(),window.pagesListView.models=e,window.pagesListView.bind(),document.getElementById("page-chooser").value=window.initialPageId,u.loadPage(window.initialPageId)},error:function(){alert("error with fetching page list")}}),this.clearPage=function(){window.rivetsView.unbind(),i.clearPage()},this.loadPage=function(t){i.loadPage(t),window.saver.currentPageID=t;var e=window.rivetsView||s.bind(document.getElementById("edit-section"),window.pageModel);window.rivetsView=e,window.rivetsView.unbind(),window.rivetsView.models=window.pageModel,window.rivetsView.bind(),window.saver.model=window.pageModel,window.saver.Page=r,window.pageModel.editPopup=[window.pageModel.camera]};var c={};c.saveToParse=function(){var t=this,e=new this.Page;this.model.objectId=this.currentPageID,e.save(this.model,{success:function(){window.saver.model.objectId=t.currentPageID,alert("saved successfully!")}})},c.addNewPopup=function(){var t={accel:!1,accelAmount:"1",height:"1",initialX:"0",initialY:"0",name:"new",rotateAngle:"100",rotateSpeed:"2000",scale:"1",scaleX:"1",scaleY:"1",timeOffset:"0",timer:{initialTime:1419434956210},translate:!1,translateX:"0",translateXSpeed:"1000",translateY:"0",translateYSpeed:"1000",url:"",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"};this.model.popups.push(t)},c.removePopup=function(){var t=this.model.editPopup[0],e=this.model.popups.indexOf(t);this.model.popups.splice(e,1),window.editChanger.changeEditing()},c.addFrame=function(){var t=this.model.editPopup[0];t.frames=t.frames||[],t.frames.push({url:""})},c.deleteFrame=function(t){var e=this.model.editPopup[0],i=t.parentElement.parentElement.children,n=[].slice.call(i),r=n.indexOf(t.parentElement)-1;e.frames.splice(r,1)},c.addSound=function(){this.model.sounds=this.model.sounds||[],this.model.sounds.push({name:"",url:""})},c.deleteSound=function(t){var e=t.parentElement.parentElement.children,i=[].slice.call(e),n=i.indexOf(t.parentElement)-1;this.model.sounds.splice(n,1)},c.dupePage=function(){var t=new this.Page;t.set("name","dup of "+this.model.name),t.set("device",this.model.device),t.set("popups",this.model.popups),t.set("camera",this.model.camera),t.set("page",this.model.page),t.set("sounds",this.model.sounds),t.save(null,{success:function(t){alert("Duplicate page created with objectId: "+t.id)},error:function(t,e){alert("Failed to create new page, with error code: "+e.message)}})},c.addNewPage=function(){var t=new this.Page,e={height:"0",initialX:"0",initialY:"0",motionType:"sine",name:"camera",rotateAngle:"100",rotateSpeed:"2000",scale:"1",timeOffset:"100",translate:!1,translateX:"0",translateXSpeed:"5000",translateY:"200",translateYSpeed:"18000",xyRatio:"1",zoomAmount:"0",zoomSpeed:"2000"},i={name:"new",x:"900",y:"1200"};t.set("name","new"),t.set("device","new"),t.set("popups",[]),t.set("camera",e),t.set("page",i),t.save(null,{success:function(t){alert("New page created with objectId: "+t.id)},error:function(t,e){alert("Failed to create new page, with error code: "+e.message)}})},window.saver=c;var l={};l.main=this,l.changePage=function(){var t=document.getElementById("page-chooser").value;this.main.clearPage(),this.main.loadPage(t)},window.pageChanger=l;var h={};h.main=this,h.realTime=Date.now,h.pause=function(){var t=document.getElementById("pause-button");t.onclick=function(){window.timeController.play()},t.textContent="Play",document.getElementById("time-chooser").hidden=!1,Date.now=function(){return 0}},h.update=function(t){Date.now=function(){return parseInt(t)}},h.play=function(){var t=document.getElementById("pause-button");t.onclick=function(){window.timeController.pause()},t.textContent="Pause",Date.now=this.realTime,document.getElementById("time-chooser").hidden=!0},window.timeController=h;var p={};p.main=this,p.changeEditing=function(){var t=document.querySelector('input[name="edit-chooser"]:checked').value;if("camera"!==t){var e=window.pageModel.popups.filter(function(e){return e.name===t?!0:!1});window.pageModel.editPopup=e}else window.pageModel.editPopup=[window.pageModel.camera]},window.editChanger=p}),e(["tool/animatortool"])}();